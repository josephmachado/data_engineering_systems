{"version": 2, "width": 190, "height": 46, "timestamp": 1744028221, "env": {"SHELL": "/usr/bin/zsh", "TERM": "xterm-256color"}}
[0.094416, "o", "\u001b[1m\u001b[7m%\u001b[27m\u001b[1m\u001b[0m                                                                                                                                                                                             \r \r"]
[0.095417, "o", "\u001b]2;josephkevinmachado@pop-os:~/code/data_engineering_systems\u0007"]
[0.095535, "o", "\u001b]1;..ering_systems\u0007"]
[0.097744, "o", "\u001b]7;file://pop-os/home/josephkevinmachado/code/data_engineering_systems\u001b\\"]
[0.098628, "o", "\r\u001b[0m\u001b[27m\u001b[24m\u001b[J\u001b[01;32m➜  \u001b[36mdata_engineering_systems\u001b[00m \u001b[K"]
[0.098754, "o", "\u001b[?1h\u001b=\u001b[?2004h"]
[0.111381, "o", "\r\r\u001b[0m\u001b[27m\u001b[24m\u001b[J\u001b[01;32m➜  \u001b[36mdata_engineering_systems\u001b[00m \u001b[01;34mgit:(\u001b[31mmain\u001b[34m) \u001b[33m✗\u001b[00m \u001b[K"]
[0.61549, "o", "n"]
[0.799278, "o", "\u001b[?1l\u001b>\u001b[?2004l"]
[0.799424, "o", "\r\r\n"]
[0.799967, "o", "\u001b]2;nvim .\u0007\u001b]1;n\u0007"]
[0.806143, "o", "\u001b[?1049h\u001b[22;0;0t\u001b[?1h\u001b=\u001b[H\u001b[2J\u001b[?2004h\u001b[?2026$p\u001b[?2027$p\u001b[?2031$p\u001b[?2048$p\u001b[?u\u001b[c\u001b[?25h"]
[0.808884, "o", "\u001b]11;?\u0007"]
[0.904449, "o", "\u001b[?25l\u001b[>4;2m\u001b(B\u001b[m\u001b[H                                                                                                                                                                                              \r\n                                                                                                                                                                                              \r\n                                                                                                                                                                                              \r\n                                                                                                                                                                                              \r\n                                                                                                                                                                                              \r\n                                          "]
[0.904497, "o", "                                                                                                                                                    \r\n                                                                                                                                                                                              \r\n                                                                                                                                                                                              \r\n                                                                                                                                                                                              \r\n                                                                                                                                                                                              \r\n                                                                                                          "]
[0.904603, "o", "                                                                                    \r\n                                                                                                                                                                                              \r\n                                                                                                                                                                                              \r\n                                                                                                                                                                                              \r\n                                                                                                                                                                                              \r\n                                                                                                                                                                          "]
[0.90466, "o", "                    \r\n                                                                                                                                                                                              \r\n                                                                                                                                                                                              \r\n                                                                                                                                                                                              \r\n                                                                                                                                                                                              \r\n                                                                                                                                                                                              \r\n                                          "]
[0.904706, "o", "                                                                                                                                                    \r\n                                                                                                                                                                                              \r\n                                                                                                                                                                                              \r\n                                                                                                                                                                                              \r\n                                                                                                                                                                                              \r\n                                                                                                          "]
[0.904752, "o", "                                                                                    \r\n                                                                                                                                                                                              \r\n                                                                                                                                                                                              \r\n                                                                                                                                                                                              \r\n                                                                                                                                                                                              \r\n                                                                                                                                                                          "]
[0.904796, "o", "                    \r\n                                                                                                                                                                                              \r\n                                                                                                                                                                                              \r\n                                                                                                                                                                                              \r\n                                                                                                                                                                                              \r\n                                                                                                                                                                                              \r\n                                          "]
[0.904838, "o", "                                                                                                                                                    \r\n                                                                                                                                                                                              \r\n                                                                                                                                                                                              \r\n                                                                                                                                                                                              \r\n                                                                                                                                                                                              \r\n                                                                                                          "]
[0.90488, "o", "                                                                                    \r\n                                                                                                                                                                                              \r\n                                                                                                                                                                                              \r\n                                                                                                                                                                                              \u001b[?1004h\u001b[?25h"]
[0.98693, "o", "\u001b[?25l\u001b[2 q\u001b[2 q\u001b[?1002h\u001b[?1006h\u001b(B\u001b[m\u001b[H                                                                                                                                                                                              \u001b(B\u001b[m\r\n                                                                                                                                                                                              \u001b(B\u001b[m\r\n                                                                                                                                                                                              \u001b(B\u001b[m\r\n                                                                                                                                                                                              \u001b(B\u001b[m\r\n                                                                                                                                                                                              \u001b"]
[0.986965, "o", "(B\u001b[m\r\n                                                                                                                                                                                              \u001b(B\u001b[m\r\n                                                                                                                                                                                              \u001b(B\u001b[m\r\n                                                                                                                                                                                              \u001b(B\u001b[m\r\n                                                                                                                                                                                              \u001b(B\u001b[m\r\n                                                                                                                                                                                              \u001b(B\u001b[m\r\n                           "]
[0.986975, "o", "                                                                                                                                                                   \u001b(B\u001b[m\r\n                                                                                                                                                                                              \u001b(B\u001b[m\r\n                                                                                                                                                                                              \u001b(B\u001b[m\r\n                                                                                                                                                                                              \u001b(B\u001b[m\r\n                                                                                                                                                                                              \u001b(B\u001b[m\r\n                                                             "]
[0.987089, "o", "                                                                                                                                 \u001b(B\u001b[m\r\n                                                                                                                                                                                              \u001b(B\u001b[m\r\n                                                                                                                                                                                              \u001b(B\u001b[m\r\n                                                                                                                                                                                              \u001b(B\u001b[m\r\n                                                                                                                                                                                              \u001b(B\u001b[m\r\n                                                                                               "]
[0.987182, "o", "                                                                                               \u001b(B\u001b[m\r\n                                                                                                                                                                                              \u001b(B\u001b[m\r\n                                                                                                                                                                                              \u001b(B\u001b[m\r\n                                                                                                                                                                                              \u001b(B\u001b[m\r\n                                                                                                                                                                                              \u001b(B\u001b[m\r\n                                                                                                                                 "]
[0.987237, "o", "                                                             \u001b(B\u001b[m\r\n                                                                                                                                                                                              \u001b(B\u001b[m\r\n                                                                                                                                                                                              \u001b(B\u001b[m\r\n                                                                                                                                                                                              \u001b(B\u001b[m\r\n                                                                                                                                                                                              \u001b(B\u001b[m\r\n                                                                                                                                                                   "]
[0.987283, "o", "                           \u001b(B\u001b[m\r\n                                                                                                                                                                                              \u001b(B\u001b[m\r\n                                                                                                                                                                                              \u001b(B\u001b[m\r\n                                                                                                                                                                                              \u001b(B\u001b[m\r\n                                                                                                                                                                                              \u001b(B\u001b[m\r\n                                                                                                                                                                                              \u001b(B\u001b[m\r"]
[0.987326, "o", "\n                                                                                                                                                                                              \u001b(B\u001b[m\r\n                                                                                                                                                                                              \u001b(B\u001b[m\r\n                                                                                                                                                                                              \u001b(B\u001b[m\r\n                                                                                                                                                                                              \u001b(B\u001b[m\r\n                                                                                                                                                                                              \u001b(B\u001b[m\r\n                                 "]
[0.987377, "o", "                                                                                                                                                             \u001b(B\u001b[m\r\n                                                                                                                                                                                              \u001b(B\u001b[m\r\n                                                                                                                                                                                              \u001b(B\u001b[m\r\n                                                                                                                                                                                              \u001b(B\u001b[m\r\n                                                                                                                                                                                              \u001b[H"]
[0.994778, "o", "\u001bP+q4D73\u001b\\"]
[1.002099, "o", "\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m\" ============================================================================\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m\" Netrw Directory Listing                                        \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38m(netrw v175)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m\"   /home/josephkevinmachado/code/data_engineering_systems\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m\"   Sorted by\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38m      name\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m\"   Sort sequence:\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38m [\\/]$\u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38"]
[1.002145, "o", "m,\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38m\\<core\\%(\\.\\d\\+\\)\\=\\>\u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38m\\.h$\u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38m\\.c$\u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38m\\.cpp$\u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38m\\~\\=\\*$\u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38m\\.o$\u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38m\\.obj$\u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38m\\.info$\u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38m\\.swp$\u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38m\\.bak$\u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;18"]
[1.002167, "o", "7;154;247m\u001b[48;2;26;27;38m\\~$\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m\"   Quick Help: \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38m<F1>\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mhelp  \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38m-\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mgo up dir  \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38mD\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mdelete  \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38mR\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mrename  \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38msort-by  \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38mx\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mspecial\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[3"]
[1.002269, "o", "m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m\" ==============================================================================\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;41;46;66m../\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;41;46;66m                                                                                                                                                                                         \r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38m./\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38m.git/\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38m.venv/\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38massets/\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b["]
[1.002321, "o", "48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38mmergeinto/\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38mnotebooks/\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38msetup/\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38mwarehouse/\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m.gitignore\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m.python-version\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mREADME.md\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mdocker-compose.yml\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mmain.py\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59"]
[1.002375, "o", ";66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mmiai\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mpyproject.toml\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38muv.lock\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m Normal \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;41;46;66m [No Name][-][RO]                                                                                                                                          \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;59;66;97m \u001b[45;166H netrw [unix] -1B \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m  8:1  \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m\r\n\u001b[J\u001b[H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m\" ============================================================================\u001b(B\u001b[m\u001b[38;2;192;"]
[1.002421, "o", "202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m\" Netrw Directory Listing                                        \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38m(netrw v175)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m\"   /home/josephkevinmachado/code/data_engineering_systems\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m\"   Sorted by\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38m      name\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m\"   Sort sequence:\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38m [\\/]$\u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38m\\<core\\%(\\.\\d\\+\\)\\=\\>\u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38m\\.h$\u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;13"]
[1.002467, "o", "7m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38m\\.c$\u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38m\\.cpp$\u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38m\\~\\=\\*$\u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38m\\.o$\u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38m\\.obj$\u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38m\\.info$\u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38m\\.swp$\u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38m\\.bak$\u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38m\\~$\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m\"   Quick Help: \u001b(B\u001b"]
[1.00251, "o", "[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38m<F1>\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mhelp  \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38m-\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mgo up dir  \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38mD\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mdelete  \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38mR\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mrename  \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38msort-by  \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38mx\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mspecial\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m\" ==============================================================================\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66"]
[1.002555, "o", ";97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;41;46;66m../\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;41;46;66m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38m./\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38m.git/\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38m.venv/\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m"]
[1.002599, "o", "\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38massets/\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38mmergeinto/\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38mnotebooks/\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38msetup/\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38mwarehouse/\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m.gitignore\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m.python-version\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mREADME.md\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202"]
[1.002643, "o", ";245m\u001b[48;2;26;27;38mdocker-compose.yml\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mmain.py\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mmiai\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mpyproject.toml\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38muv.lock\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m Normal \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;41;46;66m [No Name][-][RO]                                                                                                                                          \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;59;66;97m \u001b[45;166H netrw [unix] -1B \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m  8:1\u001b[K\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m\r\n\u001b[J\u001b[8;3H\u001b[?25h"]
[1.818262, "o", "\u001b[?25l\u001b[46;180H~@k\u001b[8;3H\u001b[?25h"]
[1.820287, "o", "\u001b[?25l\u001b[46;180H   \u001b[8;3H\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38m../\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[9;3H\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;41;46;66m./\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;41;46;66m                                                                                                                                                                                          \u001b[45;186H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m9\u001b[9;3H\u001b[?25h"]
[1.977044, "o", "\u001b[?25l\u001b[46;180H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m~@k\u001b[9;3H\u001b[?25h"]
[1.982476, "o", "\u001b[?25l\u001b[46;180H   \u001b[9;3H\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38m./\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[10;3H\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;41;46;66m.git/\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;41;46;66m                                                                                                                                                                                       \u001b[45;185H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m10\u001b[10;3H\u001b[?25h"]
[2.110018, "o", "\u001b[?25l\u001b[46;180H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m~@k\u001b[10;3H\u001b[?25h"]
[2.111682, "o", "\u001b[?25l\u001b[46;180H   \u001b[10;3H\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38m.git/\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[11;3H\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;41;46;66m.venv/\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;41;46;66m                                                                                                                                                                                      \u001b[45;186H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m1\u001b[11;3H\u001b[?25h"]
[2.251874, "o", "\u001b[?25l\u001b[46;180H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m~@k\u001b[11;3H\u001b[?25h"]
[2.258159, "o", "\u001b[?25l\u001b[46;180H   \u001b[11;3H\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38m.venv/\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[12;3H\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;41;46;66massets/\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;41;46;66m                                                                                                                                                                                     \u001b[45;186H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m2\u001b[12;3H\u001b[?25h"]
[2.406038, "o", "\u001b[?25l\u001b[46;180H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m~@k\u001b[12;3H\u001b[?25h"]
[2.410714, "o", "\u001b[?25l\u001b[46;180H   \u001b[12;3H\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38massets/\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[13;3H\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;41;46;66mmergeinto/\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;41;46;66m                                                                                                                                                                                  \u001b[45;186H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m3\u001b[13;3H\u001b[?25h"]
[2.586947, "o", "\u001b[?25l\u001b[46;180H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m~@k\u001b[13;3H\u001b[?25h"]
[2.591689, "o", "\u001b[?25l\u001b[46;180H   \u001b[13;3H\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38mmergeinto/\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[14;3H\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;41;46;66mnotebooks/\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;41;46;66m                                                                                                                                                                                  \u001b[45;186H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m4\u001b[14;3H\u001b[?25h"]
[2.852792, "o", "\u001b[?25l\u001b[46;180H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m~@k\u001b[14;3H\u001b[?25h"]
[2.854354, "o", "\u001b[?25l\u001b[46;180H   \u001b[13;3H\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;41;46;66mmergeinto/\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;41;46;66m                                                                                                                                                                                  \u001b[14;3H\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38mnotebooks/\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[45;186H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m3\u001b[13;3H\u001b[?25h"]
[3.114695, "o", "\u001b[?25l\u001b[3;61H\u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m/mergeinto\u001b[10;3H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;41;46;66mmergeinto.py                                                                                                                                                                                \r\n\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\r\n~\u001b[K\u001b[45;10H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;41;46;66m~/code/data_engineering_systems/mergeinto[-][RO]                                                                                                           \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;59;66;97m \u001b[45;167H netrw [unix] 0B \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m 10\u001b[2 q\u001b[10;3H\u001b[?25h"]
[3.294513, "o", "\u001b[?25l\u001b[46;180H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m~@k\u001b[10;3H\u001b[?25h\u001b[?25l\u001b[46;180H   \u001b[10;3H\u001b[?25h"]
[3.591686, "o", "\u001b[?25l\u001b[2 q\u001b[?25h"]
[3.710455, "o", "\u001b[?25l\r\u001b[36B\u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;26;27;38mvim.lsp.start_client() is deprecated. Run \":checkhealth vim.deprecated\" for more information\u001b[1;3H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m1   \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;41;46;66mWith\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;41;46;66m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;41;46;66mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;41;46;66m \u001b(B\u001b[m\u001b[3m\u001b[38;2;157;124;216m\u001b[48;2;41;46;66mas\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;41;46;66m \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;41;46;66m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;41;46;66m                                                                                                                                                        \u001b[2;3H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mselect\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.*\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[63X\u001b[3;3H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;3"]
[3.710581, "o", "8m  2 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[3;8H   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mfrom\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mprod\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdb\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mcustomer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[37X\u001b[4;3H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  3 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[4;8H   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mjoin\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mprod\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdb\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdim_customer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mdc\u001b[5;3H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;"]
[3.710608, "o", "26;27;38m  4 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[5;8H   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mon\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mdc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38mCustomer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mexists\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mdim_customer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;2"]
[3.710624, "o", "6;27;38m\u001b[35X\u001b[6;3H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  5 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[6;8H   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mwhere\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mdc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mensure\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mthat\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mthe\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b["]
[3.710697, "o", "48;2;26;27;38mupdate\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mupstream\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mcustomer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38mis\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mnewer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mthan\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mthe\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mlatest\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mdata\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mdim_customer\u001b[7;3H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;"]
[3.710717, "o", "26;27;38m  6 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[7;8H   \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38mand\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mdc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mis_current\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mtrue\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38monly\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mlook\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mat\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mthe\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mmost\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[3"]
[3.71073, "o", "8;2;192;202;245m\u001b[48;2;26;27;38mcurrent\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mstate\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mof\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mcustomer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mdim_customer\u001b[8;3H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  7 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b[9;3H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  8 \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mMERGE\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mINTO\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mprod\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdb\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdim_customer\u001b(B"]
[3.710797, "o", "\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mtarget\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mdim_customer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mto\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mupdate\u001b[10;3H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  9 \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mUSING\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 10 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[11;8H   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mselect\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mcustomer_id\u001b"]
[3.710818, "o", "(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[3m\u001b[38;2;157;124;216m\u001b[48;2;26;27;38mas\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mfrom\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mprod\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdb\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mcustomer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38mNew\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mcustomers\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mto\u001b(B\u001b[m\u001b[38;2;192;202;2"]
[3.710833, "o", "45m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mbe\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mINSERTED\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mexisting\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mcustomers\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mto\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mbe\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mUPDATED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 11 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[12;8H   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38munion\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mall\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2"]
[3.710846, "o", ";26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 12 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[13;8H   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mselect\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mNULL\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[3m\u001b[38;2;157;124;216m\u001b[48;2;26;27;38mas\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mfrom\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38mExisting\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mcustomers\u001b(B\u001b[m\u001b[38;2;137;221"]
[3.710936, "o", ";255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mbut\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mupdated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mvalues\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mto\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mbe\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;"]
[3.710993, "o", "255;158;100m\u001b[48;2;26;27;38mINSERTED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 13 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[14;8H   \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 14 \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mON\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;2"]
[3.711047, "o", "6;27;38m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mnatural\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mkey\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mfor\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mcustomer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 15 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[16;8H\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 16 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[17;8H   \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mWHEN\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mMATCHED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mAND\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mis"]
[3.711098, "o", "_current\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mtrue\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mAND\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mcondition\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mto\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b["]
[3.711143, "o", "m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mUPDATE\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mmost\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mrecent\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mcustomers\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mdim_customer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mthat\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mhave\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mhad\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mupdates\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 17 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[18;8H   \u001b(B\u001b["]
[3.711188, "o", "m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mTHEN\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mUPDATE\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mSET\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mis_current\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mfalse\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mvalid_to\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 18 \u001b(B\u001b[m\u001b[38;2;59;"]
[3.711236, "o", "66;97m\u001b[48;2;26;27;38m▎\u001b[19;8H·\u001b[19;9H·\u001b[19;10H·\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[19;11H\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 19 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[20;8H   \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mWHEN\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mNOT\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mMATCHED\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m·\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[20;28H\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 20 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[21;8H   \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mTHEN\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mINSERT\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245"]
[3.711282, "o", "m\u001b[48;2;26;27;38memail\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mfirst_name\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mvalid_from\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mis_current\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mis_active\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mcondition\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mto\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mINSERT\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mnew\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;"]
[3.711329, "o", "2;192;202;245m\u001b[48;2;26;27;38mcustomers\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38mand\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mcustomers\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mwith\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mupdates\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 21 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[22;8H   \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mVALUES\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38memail\u001b(B\u001b[m\u001b[38;2"]
[3.711388, "o", ";137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mfirst_name\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mtrue\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mtrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 22 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[23;8H\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59"]
[3.711435, "o", ";66;97m\u001b[48;2;26;27;38m 23 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[24;8H   \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mWHEN\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mNOT\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mMATCHED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mBY\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mSOURCE\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mcondition\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mto\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;39;161;185m\u001b[48;2;26;27;38mset\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mdeleted\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mcustomers\u001b(B\u001b[m\u001b[38;2;192;202;2"]
[3.711481, "o", "45m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mdim_customer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mto\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mbe\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38min-\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mactive\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 24 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[25;8H   \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mTHEN\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mUPDATE\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mSET\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mis_active\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;"]
[3.711527, "o", "2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mfalse\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[45;51H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;41;46;66m/mergeinto.py                                                                                          \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;59;66;97m \u001b[45;156H python utf-8[unix] 1.44KiB \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m  1\u001b[1;7H\u001b[?25h"]
[3.719644, "o", "\u001b[?25l\u001b[45;9H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;59;66;97m 󰰎\u001b[45;11H + \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;41;46;66m ~/code/data_engineering_systems/mergeinto/mergeinto.py\u001b[1;7H\u001b[?25h"]
[3.731726, "o", "\u001b[?25l\u001b[H\u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m1   \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;41;46;66mWith\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;41;46;66m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;41;46;66mc\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;41;46;66mustomers_with_updates\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;41;46;66m \u001b(B\u001b[m\u001b[3m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;157;124;216m\u001b[48;2;41;46;66ma\r\n\u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mselect\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m*\r\n\u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[3;8H   \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mf\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mrom\u001b(B\u001b[m\u001b"]
[3.731918, "o", "[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mp\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mrod\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdb\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mcustomer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\r\n\u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  3 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[4;8H   \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mj\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38moin\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mp\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mrod\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdb\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdim_customer\u001b(B\u001b[m\u001b[38;2;192;2"]
[3.731968, "o", "02;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38md\r\n\u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  4 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[5;8H   \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mo\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mn\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mdc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38mCustomer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4"]
[3.732044, "o", ":3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38me\r\n\u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  5 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[6;8H   \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mw\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mhere\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mdc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mensure\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m"]
[3.732071, "o", "\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mhat\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mhe\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mu\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mpdate\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mupstream\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mustomer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38mis\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mnewer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b"]
[3.73209, "o", "[48;2;26;27;38mhan\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mhe\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ml\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38matest\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38md\r\n\u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  6 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[7;8H   \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38mand\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mdc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mis_current\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mtrue\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;25"]
[3.732125, "o", "5m\u001b[48;2;26;27;38m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38monly\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ml\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mook\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ma\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mhe\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mm\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38most\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38murrent\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mtate\u001b(B\u001b"]
[3.73218, "o", "[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mo\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mf\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\r\n\u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  7 \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\r\n\u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  8 \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mMERGE\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mI\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mNTO\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mp\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mrod\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdb\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdim_customer\u001b(B\u001b"]
[3.73228, "o", "[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mtarget\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38md\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mim_customer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mo\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mu\r\n\n\u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 10 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[11;8H   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mselect\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;2"]
[3.732323, "o", "7;38mustomer_id\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[3m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;157;124;216m\u001b[48;2;26;27;38ma\u001b(B\u001b[m\u001b[3m\u001b[38;2;157;124;216m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mf\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mrom\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mp\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mrod\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdb\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mcustomer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[4"]
[3.732373, "o", "8;2;26;27;38mNew\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mustomers\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mo\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mb\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38me\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mI\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mNSERTED\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mexisting\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mustomers\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;3"]
[3.732425, "o", "8mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mo\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mb\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38me\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mU\r\n\u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 11 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[12;8H   \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mu\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mnion\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ma\r\n\u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 12 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[13;8H   \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38melect\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mN\u001b(B\u001b[m\u001b[38"]
[3.732447, "o", ";2;255;158;100m\u001b[48;2;26;27;38mULL\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[3m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;157;124;216m\u001b[48;2;26;27;38ma\u001b(B\u001b[m\u001b[3m\u001b[38;2;157;124;216m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mf\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mrom\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mustomers_with_updates\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38mExisting\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38"]
[3.732464, "o", ";2;192;202;245m\u001b[48;2;26;27;38mustomers\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mbut\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mu\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mpdated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mv\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38malues\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mo\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mb\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38me\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mI\r\n\u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 13 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[14;8H   \u001b(B\u001b"]
[3.732482, "o", "[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ms\r\n\u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 14 \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mON\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mnatural\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mk\u001b(B\u001b[m"]
[3.732648, "o", "\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mey\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mf\r\n\n\u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 16 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[17;8H   \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mWHEN\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mM\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mATCHED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mA\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mND\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mi\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ms_current\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mtrue\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::"]
[3.73267, "o", "219:75:75m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mA\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mND\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mcondition\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mo\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mU\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b"]
[3.732687, "o", "[48;2;26;27;38mPDATE\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mm\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38most\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mr\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mecent\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mustomers\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mdim_customer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mhat\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mh\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mave\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[5"]
[3.732704, "o", "8:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mh\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mad\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mu\r\n\u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 17 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[18;8H   \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mTHEN\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mU\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mPDATE\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mS\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mET\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mi\r\n\n\u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 19 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[20;8H   \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mWHEN\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b"]
[3.732722, "o", "[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mN\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mOT\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mM\r\n\u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 20 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[21;8H   \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mTHEN\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mI\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mNSERT\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38memail\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mfirst_name\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;2"]
[3.732778, "o", "02;245m\u001b[48;2;26;27;38mvalid_from\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mis_current\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mis_active\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mcondition\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mo\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mI\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mNSERT\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mn\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mew\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;192;202;245"]
[3.732905, "o", "m\u001b[48;2;26;27;38mustomers\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38mand\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mcustomers\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mw\r\n\u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \r\n\nE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 23 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[24;8H   \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mWHEN\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mN\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mOT\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mM\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mATCHED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mB\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mY\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75"]
[3.732926, "o", "m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mS\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mOURCE\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mcondition\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mo\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;39;161;185m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;39;161;185m\u001b[48;2;26;27;38met\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38md\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38meleted\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mustomers\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b"]
[3.732943, "o", "[48;2;26;27;38mdim_customer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mo\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mb\r\n\u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 24 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[25;8H   \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mTHEN\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mUPDATE\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mSET\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mis_active\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;137;221;255m\u001b[48;2;2"]
[3.732955, "o", "6;27;38m=\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mfalse\u001b[1;7H\u001b[?25h"]
[3.75, "o", "\u001b[?25l\r\u001b[9B\u001b(B\u001b[m\u001b[38;2;97;131;187m\u001b[48;2;26;27;38m~ \r\u001b[6B~ \r\n\n\n~ \r\n\n\n\n~ \u001b[1;7H\u001b[?25h"]
[3.865227, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m\r\u001b[45B\u001b[92X\u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;26;27;38mClient pyright quit with exit code 1 and signal 0. Check log for errors: /home/josephkevinmachado/.local/state/nvim/lsp.log\u001b[45;10H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;59;66;97m\u001b[45;11H main \u001b[45;18H ~25 -95 \u001b[45;28H E113 󰰎\u001b[45;35H + \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;41;46;66m ~/code/data_engineering_systems/mergeinto/mergeinto.py\u001b[46;124H\u001b[?25h\u001b[?25l\u001b[1;7H\u001b[?25h"]
[4.404734, "o", "\u001b[?25l\u001b[46;180H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m:\u001b[1;7H\u001b[?25h"]
[4.406758, "o", "\u001b[?25l\r\u001b[45B\u001b[180X:\r\u001b[A\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;224;175;104m Command \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;59;66;97m \u001b[45;12H main \u001b[45;19H ~25 -95 \u001b[45;29H E113 󰰎\u001b[45;36H + \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;41;46;66m ~/code/data_engineering_systems/mergeinto/mergeinto.py                                                            \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;59;66;97m \u001b[45;156H python utf-8[unix] 1.44KiB \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;224;175;104m  1:1  \u001b[2 q\u001b[46;2H\u001b[?25h"]
[4.59592, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38mc\u001b[?25h"]
[4.728022, "o", "\u001b[?25lo\u001b[?25h"]
[4.855049, "o", "\u001b[?25ld\u001b[?25h"]
[4.875402, "o", "\u001b[?25le\u001b[?25h"]
[5.093388, "o", "\u001b[?25lc\u001b[?25h"]
[5.228511, "o", "\u001b[?25lo\u001b[?25h"]
[5.368017, "o", "\u001b[?25l...\u001b[?25h"]
[5.368479, "o", "\u001b[?25l\r\u001b[CCodeCompanion...\u001b[?25h"]
[5.368791, "o", "\u001b[?25l\r\u001b[Ccodec\u001b[C\u001b[10X\r\u001b[4A\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30mCodeCo\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30mmpanion        \r\n \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30mCodeCo\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30mmpanionActions \r\n \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30mCodeCo\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30mmpanionChat    \r\n \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30mCodeCo\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30mmpanionCmd     \u001b[46;8H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m...\u001b[?25h"]
[5.36911, "o", "\u001b[?25l\r\u001b[4A\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mCodeCo\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85mmpanion        \u001b[46;2H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38mCodeCompanion\u001b[?25h"]
[6.422562, "o", "\u001b[?25l...\u001b[?25h"]
[6.422991, "o", "\u001b[?25l\r\u001b[4A\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30mCodeCo\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30mmpanion        \r\n\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mCodeCo\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85mmpanionActions \u001b[46;15H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38mActions\u001b[?25h"]
[6.75558, "o", "\u001b[?25l...\u001b[?25h"]
[6.756021, "o", "\u001b[?25l\r\u001b[3A\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30mCodeCo\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30mmpanionActions \r\n\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mCodeCo\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85mmpanionChat    \u001b[46;15H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38mChat      \u001b[6D\u001b[?25h"]
[7.025536, "o", "\u001b[?25l\r\u001b[4A\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~                     \r\n~                     \r\n~                     \r\n\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;224;175;104m Command \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;59;66;97m \u001b[45;12H main \u001b[45;19H ~25\r\n\u001b[?25h"]
[7.100145, "o", "\u001b[?25l\u001b[1;3H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m1   \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;41;46;66mWith\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;41;46;66m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;41;46;66mc\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;41;46;66mustomers_with_updates \u001b(B\u001b[m\u001b[3m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;157;124;216m\u001b[48;2;41;46;66ma\u001b(B\u001b[m\u001b[3m\u001b[38;2;157;124;216m\u001b[48;2;41;46;66ms\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;41;46;66m \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;41;46;66m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;41;46;66m                                                                  \u001b[2;3H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mselect \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[88X\u001b[3;3H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[3;8H   \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:7"]
[7.100204, "o", "5m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mf\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mrom \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mp\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mrod\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdb\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mcustomer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[71X\u001b[4;3H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  3 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[4;8H   \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mj\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38moin \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mp\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mrod\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdb\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdim_customer\u001b("]
[7.100299, "o", "B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38md\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b[66X\u001b[5;3H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  4 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[5;8H   \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mo\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mn \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m dc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38mCustomer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m"]
[7.100349, "o", "e\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mxists \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m dim_customer\u001b[26X\u001b[6;3H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  5 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[6;8H   \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mw\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mhere \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m dc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m ensure \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mhat \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:"]
[7.100395, "o", "75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mhe \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mu\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mpdate \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m upstream \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mustomer \r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[7;8H   \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38mis\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m newer \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mhan \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mhe \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ml\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38matest \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38md\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;"]
[7.100406, "o", "26;27;38mata \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m dim_customer\u001b[49X\u001b[8;3H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  6 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[8;8H   \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38mand\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m dc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mis_current\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m true \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m only \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ml\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mook \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ma\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mhe \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mm\u001b(B\u001b[m\u001b[38;2;"]
[7.100415, "o", "192;202;245m\u001b[48;2;26;27;38most \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38murrent \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mtate \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mo\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mf \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mustomer \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m dim_customer   \u001b[9;3H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  7 \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[97X\r\n\u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  8 \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mMERGE\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mI\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mNT"]
[7.100428, "o", "O\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mp\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mrod\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdb\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdim_customer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m target \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38md\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mim_customer \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mo \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mu\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mpdate\u001b[32X\r\n\u001b(B\u001b[m\u001b[38;2;97;131;187m\u001b[48;2;26;27;38m~ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  9 \u001b(B\u001b[m\u001b[38;2;187;1"]
[7.100505, "o", "54;247m\u001b[48;2;26;27;38mUSING\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[91X\u001b[12;3H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 10 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[12;8H   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mselect \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mustomer_id \u001b(B\u001b[m\u001b[3m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;157;124;216m\u001b[48;2;26;27;38ma\u001b(B\u001b[m\u001b[3m\u001b[38;2;157;124;216m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m join_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mf\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mrom \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mp\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mrod\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B"]
[7.100546, "o", "\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdb\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mcustomer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38mNew\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mustomers \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mo \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mb\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38me \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mI\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mNSERTED\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m exist\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[13;8H   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ming \u001b("]
[7.10058, "o", "B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mustomers \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mo \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mb\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38me \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mU\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mPDATED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[67X\u001b[14;3H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 11 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[14;8H   \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mu\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mnion \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ma\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mll\u001b[85X\u001b[15;3H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 12 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[15;8H   \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m"]
[7.100617, "o", "elect \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mN\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mULL\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[3m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;157;124;216m\u001b[48;2;26;27;38ma\u001b(B\u001b[m\u001b[3m\u001b[38;2;157;124;216m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m join_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::"]
[7.100682, "o", "219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mf\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mrom \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mustomers_with_updates \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38mExisting\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mustomers\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m but \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mu\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mpdated \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mv\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38malu\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[16;8H   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mes \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27"]
[7.100726, "o", ";38mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mo \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mb\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38me \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mI\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mNSERTED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[77X\u001b[17;3H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 13 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[17;8H   \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[91X\u001b[18;3H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 14 \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mON\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;2"]
[7.10076, "o", "6;27;38m s\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m natural \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mk\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mey \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mf\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mor\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m customer\u001b[41X\u001b[19;3H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 15 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[19;8H\u001b[97X\u001b[20;3H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 16 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[20;8H   \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mWHEN\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mM\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mATCHED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75"]
[7.100794, "o", "m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mA\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mND\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mi\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ms_current \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m true \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mA\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mND\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m t\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m condition \u001b(B\u001b[m\u001b[4:3m\u001b[58:"]
[7.100828, "o", "2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mo\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[21;8H   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mU\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mPDATE\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mm\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38most \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mr\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mecent \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mustomers \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m dim_customer \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mhat \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mh\u001b(B\u001b[m\u001b[38;2;192;202;245m"]
[7.100862, "o", "\u001b[48;2;26;27;38mave \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mh\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mad \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mu\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mpdates\u001b[27X\u001b[22;3H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 17 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[22;8H   \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mTHEN\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mU\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mPDATE\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mS\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mET\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mi\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ms_current \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m false\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;2"]
[7.100894, "o", "7;38m valid_to \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m s\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[29X\u001b[23;3H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 18 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[23;8H·\u001b[23;9H·\u001b[23;10H·\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[23;11H\u001b[94X\u001b[24;3H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 19 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[24;8H   \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mWHEN\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mN\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mOT\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mM\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mATCHED\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m·\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[24;28H\u001b[77X\u001b[25;3H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 20 \u001b(B\u001b[m\u001b[38;2;"]
[7.100928, "o", "59;66;97m\u001b[48;2;26;27;38m▎\u001b[25;8H   \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mTHEN\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mI\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mNSERT\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38memail\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mfirst_name\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mvalid_from\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mis_current\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mis_active\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[3"]
[7.100965, "o", "8;2;137;221;255m\u001b[48;2;26;27;38m--\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[26;8H   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m condition \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mo \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mI\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mNSERT\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mn\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mew \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mustomers \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38mand\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m customers \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mw\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mith updates\u001b[33X\r\n\u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 21 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[27;8H"]
[7.101003, "o", "   \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mVALUES\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38memail\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mfirst_name\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;3"]
[7.101038, "o", "8m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mtrue\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mtrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m   \r\n\u001b(B\u001b[m\u001b[38;2;97;131;187m\u001b[48;2;26;27;38m~ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 22 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[28;8H\u001b[97X\r\n\u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 23 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[29;8H   \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mWHEN\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mN\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mOT\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mM\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mATCHED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mB\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[4"]
[7.101073, "o", "8;2;26;27;38mY\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mS\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mOURCE\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m condition \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mo \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;39;161;185m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;39;161;185m\u001b[48;2;26;27;38met\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38md\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38meleted \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mustomers \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m dim_customer \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mo \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:"]
[7.101108, "o", "75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mb\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38me \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38min-\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38macti\r\n\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[30;8H   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mve\u001b[92X\r\n\u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 24 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[31;8H   \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mTHEN\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mUPDATE\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mSET\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m is_active \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m false\u001b(B\u001b[m\u001b[38;2;192"]
[7.101141, "o", ";202;245m\u001b[48;2;26;27;38m\u001b[61X\r\n\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~\u001b[103X\r\n~\u001b[103X\r\n~\u001b[103X\r\n~\u001b[103X\r\n~\u001b[103X\r\n~\u001b[103X\r\n~\u001b[103X\r\n~\u001b[103X\r\n~\u001b[103X\r\n~\u001b[103X\r\n~\u001b[103X\r\n~\u001b[103X\r\n~\u001b[103X\u001b[1;105H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[2;105H│\u001b[3;105H│\u001b[4;105H│\u001b[5;105H│\u001b[6;105H│\u001b[7;105H│\u001b[8;105H│\u001b[9;105H│\u001b[10;105H│\u001b[11;105H│\u001b[12;105H│\u001b[13;105H│\u001b[14;105H│\u001b[15;105H│\u001b[16;105H│\u001b[17;105H│\u001b[18;105H│\u001b[19;105H│\u001b[20;105H│\u001b[21;105H│\u001b[22;105H│\u001b[23;105H│\u001b[24;105H│\u001b[25;105H│\u001b[26;105H│\u001b[27;105H│\u001b[28;105H│\u001b[29;105H│\u001b[30;105H│\u001b[31;105H│\u001b[32;105H│\u001b[33;105H│\u001b[34;105H│\u001b[35;105H│\u001b[36;105H│\u001b[37;105H│\u001b[38;105H│\u001b[39;105H│\u001b[40;105H│\u001b[41;105H│\u001b[42;105H│\u001b[43;105H│\u001b[44;105H│\u001b[45;1H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m N \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;59;66;97m \u001b[45;6H main \u001b[45;13H ~25 -95 \u001b[45;23H E113 󰰎\u001b[45;30H + \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;41;46;66m mergeinto/mergeinto.py                                \u001b(B\u001b[m\u001b[38;2;169;17"]
[7.101177, "o", "7;214m\u001b[48;2;59;66;97m \u001b[45;90H python \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m  1:1  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;22;22;30m \u001b[44A\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m2 \u001b(B\u001b[0;1m\u001b[38;2;224;175;104m\u001b[48;2;26;27;38m## Me\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[2;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1 \u001b[3;106H3 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38mWelcome to CodeCompanion   \b\b✨\u001b[3;136H! Press ? for options\u001b[4;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~\u001b[K\u001b[5;106H~\u001b[K\u001b[6;106H~\u001b[K\u001b[7;106H~\u001b[K\u001b[8;106H~\u001b[K\u001b[9;106H~\u001b[K\u001b[10;106H~\u001b[K\u001b[11;106H~\u001b[K\u001b[12;106H~\u001b[K\u001b[13;106H~\u001b[K\u001b[14;106H~\u001b[K\u001b[15;106H~\u001b[K\u001b[16;106H~\u001b[K\u001b[17;106H~\u001b[K\u001b[18;106H~\u001b[K\u001b[19;106H~\u001b[K\u001b[20;106H~\u001b[K\u001b[21;106H~\u001b[K\u001b[22;106H~\u001b[K\u001b[23;106H~\u001b[K\u001b[24;106H~\u001b[K\u001b[25;106H~\u001b[K\u001b[26;106H~\u001b[27;106H~\u001b[28;106H~\u001b[29;106H~\u001b[30;106H~\u001b[31;106H~\u001b[32;106H~\u001b[33;106H~\u001b[34;106H~\u001b[35;106H~\u001b[36;106H~\u001b[37;106H~\u001b[38;106H~\u001b[39;106H~\u001b[40;106H~\u001b[41;106H~\u001b[42;106H~\u001b[43;106H~\u001b[44;106H~\u001b[45;106H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;1"]
[7.101211, "o", "22;162;247m N \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;41;46;66m [CodeCompanion] 1369025                                  \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;59;66;97m \u001b[45;169H codecompanion \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m  3:1  \u001b[2 q\u001b[3;108H\u001b[?25h\u001b[?25l\r\u001b[42B\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;22;22;30m~/code/data_engineering_systems/mergeinto/mergeinto.py                                                  \u001b[3;108H\u001b[?25h"]
[8.169098, "o", "\u001b[?25l\u001b[46;180H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38ma\u001b[3;108H\u001b[?25h"]
[8.180785, "o", "\u001b[?25l\u001b[46;180H \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[3;109H\u001b[48X\u001b[45;106H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m I \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;41;46;66m [CodeCompanion] 1369025                                  \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;59;66;97m \u001b[45;169H codecompanion \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m  3:1  \u001b[6 q\u001b[3;108H\u001b[?25h"]
[8.681436, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mU\u001b[45;188H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m2\u001b[3;109H\u001b[?25h"]
[8.70278, "o", "\u001b[?25l\u001b[4;107H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mu\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85muid~ \u001b(B\u001b[m\u001b[38;2;115;122;162m\u001b[48;2;52;58;85mSnippet\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b[3;109H\u001b[?25h"]
[8.753838, "o", "\u001b[?25l\u001b[4;89H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m uuid _ \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30m[all]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m     \u001b[5;89H ─\u001b[5;91H─\u001b[5;92H─\u001b[5;93H─\u001b[5;94H─\u001b[5;95H─\u001b[5;96H─\u001b[5;97H─\u001b[5;98H─\u001b[5;99H─\u001b[5;100H─\u001b[5;101H─\u001b[5;102H─\u001b[5;103H─\u001b[5;104H─\u001b[5;105H─\u001b[5;106H \u001b[6;89H A Version 4 UUID \u001b[7;89H ${UUID}          \u001b[3;109H\u001b[?25h"]
[8.754737, "o", "\u001b[?25l\u001b[4;107H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mu\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85muid~ \u001b(B\u001b[m\u001b[38;2;115;122;162m\u001b[48;2;52;58;85mSnippet\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b[3;109H\u001b[?25h"]
[8.775702, "o", "\u001b[?25l\u001b[4;89H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[16C \u001b[5;89H \u001b[16C \u001b[6;89H \u001b[16C \u001b[7;89H \u001b[16C \u001b[4;90Huuid _ \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30m[all]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m    \u001b[5;90H─\u001b[5;91H─\u001b[5;92H─\u001b[5;93H─\u001b[5;94H─\u001b[5;95H─\u001b[5;96H─\u001b[5;97H─\u001b[5;98H─\u001b[5;99H─\u001b[5;100H─\u001b[5;101H─\u001b[5;102H─\u001b[5;103H─\u001b[5;104H─\u001b[5;105H─\u001b[6;90HA Version 4 UUID\u001b[7;90H${UUID}         \u001b[3;109H\u001b[?25h"]
[9.452031, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ms\u001b[45;188H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m3\u001b[3;110H\u001b[?25h"]
[9.481449, "o", "\u001b[?25l\u001b[4;107H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m               \u001b[33D\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m                \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[4;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~\u001b[5;89H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m                \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[5;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~\u001b[6;89H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mstream \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mustomer \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[6;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~\u001b[7;89H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m                \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[7;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~\u001b[3;110H\u001b[?25h"]
[9.527902, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38me\u001b[45;188H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m4\u001b[3;111H\u001b[?25h"]
[9.699335, "o", "\u001b[?25l\u001b[45;188H5\u001b[3;112H\u001b[?25h"]
[10.175449, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m@\u001b[45;188H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m6\u001b[3;113H\u001b[?25h"]
[10.178927, "o", "\u001b[?25l\u001b[4;111H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85m@\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85mfiles          \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mStruct\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b[5;111H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30m@\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30meditor         \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30mStruct\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[6;111H \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30m@\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30mcmd_runner     \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30mStruct\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[7;111H \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30m@\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30mfull_stack_dev \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30mStruct\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[3;113H\u001b[?25h"]
[10.212318, "o", "\u001b[?25l\u001b[4;63H Update the file system with the LLM's response \u001b[3;113H\u001b[?25h"]
[10.24132, "o", "\u001b[?25l\u001b[4;111H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85m@\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85mfiles          \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mStruct\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b[5;111H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30m@\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30meditor         \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30mStruct\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[6;111H \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30m@\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30mcmd_runner     \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30mStruct\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[7;111H \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30m@\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30mfull_stack_dev \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30mStruct\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[3;113H\u001b[?25h"]
[10.260146, "o", "\u001b[?25l\u001b[4;63H \u001b[46C \u001b[47DUpdate the file system with the LLM's response\u001b[3;113H\u001b[?25h"]
[10.467215, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38me\u001b[45;188H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m7\u001b[3;114H\u001b[?25h"]
[10.541566, "o", "\u001b[?25l\u001b[4;111H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85m@e\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85mditor         \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mStruct\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b[5;111H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30m@\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30mfil\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30me\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30ms          \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30mStruct\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[6;111H \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30m@\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30mcmd_runn\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30me\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30mr     \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30mStruct\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[7;111H \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30m@\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30mfull_stack_d\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30me\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30mv \u001b(B\u001b["]
[10.54193, "o", "m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30mStruct\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[3;114H\u001b[?25h"]
[10.560418, "o", "\u001b[?25l\u001b[4;63H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m       \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[39C \u001b[40DUpdate a buffer with the LLM's response\u001b[3;114H\u001b[?25h"]
[10.689239, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38md\u001b[45;188H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m8\u001b[3;115H\u001b[?25h"]
[10.724219, "o", "\u001b[?25l\u001b[4;127H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m        \u001b[5;111H                        \u001b[6;111H                        \u001b[7;111H                        \u001b[4;111H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85m@ed\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85mitor \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mStruct\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b[3;115H\u001b[?25h"]
[10.742694, "o", "\u001b[?25l\u001b[4;70H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[39C \u001b[40DUpdate a buffer with the LLM's response\u001b[3;115H\u001b[?25h"]
[10.83672, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mi\u001b[45;188H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m9\u001b[3;116H\u001b[?25h"]
[10.868502, "o", "\u001b[?25l\u001b[4;111H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85m@edi\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85mtor \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mStruct\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b[3;116H\u001b[?25h"]
[10.88797, "o", "\u001b[?25l\u001b[4;70H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[39C \u001b[40DUpdate a buffer with the LLM's response\u001b[3;116H\u001b[?25h"]
[10.962737, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b[45;188H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m10\u001b[3;117H\u001b[?25h"]
[10.996259, "o", "\u001b[?25l\u001b[4;111H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85m@edit\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85mor \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mStruct\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b[3;117H\u001b[?25h"]
[11.016271, "o", "\u001b[?25l\u001b[4;70H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[39C \u001b[40DUpdate a buffer with the LLM's response\u001b[3;117H\u001b[?25h"]
[11.082642, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mo\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m1\u001b[3;118H\u001b[?25h"]
[11.114652, "o", "\u001b[?25l\u001b[4;111H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85m@edito\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85mr \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mStruct\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b[3;118H\u001b[?25h"]
[11.13444, "o", "\u001b[?25l\u001b[4;70H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[39C \u001b[40DUpdate a buffer with the LLM's response\u001b[3;118H\u001b[?25h"]
[11.166414, "o", "\u001b[?25l\u001b[6D\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m@editor\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m2\u001b[3;119H\u001b[?25h"]
[11.196394, "o", "\u001b[?25l\u001b[4;111H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85m@editor\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mStruct\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b[3;119H\u001b[?25h"]
[11.218244, "o", "\u001b[?25l\u001b[4;70H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[39C \u001b[40DUpdate a buffer with the LLM's response\u001b[3;119H\u001b[?25h"]
[11.313717, "o", "\u001b[?25l\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m3\u001b[3;120H\u001b[?25h"]
[11.341038, "o", "\u001b[?25l\u001b[4;111H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m                \u001b[57D\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m                                   \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[4;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~    \u001b[3;120H\u001b[?25h"]
[11.446094, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m4\u001b[3;121H\u001b[?25h"]
[11.455668, "o", "\u001b[?25l\u001b[4;119H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85mime~     \u001b(B\u001b[m\u001b[38;2;115;122;162m\u001b[48;2;52;58;85mSnippet\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m  \u001b[5;119H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30mimeHMS~  \u001b(B\u001b[m\u001b[38;2;115;122;162m\u001b[48;2;22;22;30mSnippet\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m  \u001b[6;119H /\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30merminal \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;22;22;30mFunction\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[3;121H\u001b[?25h"]
[11.524171, "o", "\u001b[?25l\u001b[4;84H time _ \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30m[all]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                      \u001b[5;84H ─\u001b[5;86H─\u001b[5;87H─\u001b[5;88H─\u001b[5;89H─\u001b[5;90H─\u001b[5;91H─\u001b[5;92H─\u001b[5;93H─\u001b[5;94H─\u001b[5;95H─\u001b[5;96H─\u001b[5;97H─\u001b[5;98H─\u001b[5;99H─\u001b[5;100H─\u001b[5;101H─\u001b[5;102H─\u001b[5;103H─\u001b[5;104H─\u001b[5;105H─\u001b[5;106H─\u001b[5;107H─\u001b[5;108H─\u001b[5;109H─\u001b[5;110H─\u001b[5;111H─\u001b[5;112H─\u001b[5;113H─\u001b[5;114H─\u001b[5;115H─\u001b[5;116H─\u001b[5;117H─\u001b[5;118H \u001b[6;84H I give you back the time (H:M)    \u001b[7;84H ${CURRENT_HOUR}:${CURRENT_MINUTE} \u001b[3;121H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mo\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m5\u001b[3;122H\u001b[?25h"]
[11.55612, "o", "\u001b[?25l\u001b[4;119H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m                    \u001b[5;119H                    \u001b[6;119H                    \u001b[4;84H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m                     \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[4;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~            \u001b[5;84H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m                     \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[5;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~            \u001b[6;84H\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m upstream \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mustomer \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[6;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~            \u001b[7;84H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m                     \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[7;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~            \u001b[3;122H\u001b[?25h"]
[11.649011, "o", "\u001b[?25l\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m6\u001b[3;123H\u001b[?25h"]
[11.789447, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m7\u001b[3;124H\u001b[?25h"]
[11.801975, "o", "\u001b[?25l\u001b[4;122H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mc\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m)~     \u001b(B\u001b[m\u001b[38;2;115;122;162m\u001b[48;2;52;58;85mSnippet\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m  \u001b[5;122H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m /\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30mc\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30mommit \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;22;22;30mFunction\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[3;124H\u001b[?25h"]
[11.867276, "o", "\u001b[?25l\u001b[4;57H copyright _ \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30m[all]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                               \u001b[5;57H ─\u001b[5;59H─\u001b[5;60H─\u001b[5;61H─\u001b[5;62H─\u001b[5;63H─\u001b[5;64H─\u001b[5;65H─\u001b[5;66H─\u001b[5;67H─\u001b[5;68H─\u001b[5;69H─\u001b[5;70H─\u001b[5;71H─\u001b[5;72H─\u001b[5;73H─\u001b[5;74H─\u001b[5;75H─\u001b[5;76H─\u001b[5;77H─\u001b[5;78H─\u001b[5;79H─\u001b[5;80H─\u001b[5;81H─\u001b[5;82H─\u001b[5;83H─\u001b[5;84H─\u001b[5;85H─\u001b[5;86H─\u001b[5;87H─\u001b[5;88H─\u001b[5;89H─\u001b[5;90H─\u001b[5;91H─\u001b[5;92H─\u001b[5;93H─\u001b[5;94H─\u001b[5;95H─\u001b[5;96H─\u001b[5;97H─\u001b[5;98H─\u001b[5;99H─\u001b[5;100H─\u001b[5;101H─\u001b[5;102H─\u001b[5;103H─\u001b[5;104H─\u001b[5;105H─\u001b[5;106H─\u001b[5;107H─\u001b[5;108H─\u001b[5;109H─\u001b[5;110H─\u001b[5;111H─\u001b[5;112H─\u001b[5;113H─\u001b[5;114H─\u001b[5;115H─\u001b[5;116H─\u001b[5;117H─\u001b[5;118H─\u001b[5;119H─\u001b[5;120H─\u001b[5;121H \u001b[6;57H Snippet to put copyright                                        \u001b[7;57H Copyright (c) ${CURRENT_YEAR} ${0:Author}. All Rights Reserved. \u001b[3;124H\u001b[?25h"]
[11.86888, "o", "\u001b[?25l\u001b[4;122H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mc\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m)~     \u001b(B\u001b[m\u001b[38;2;115;122;162m\u001b[48;2;52;58;85mSnippet\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m  \u001b[5;122H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m /\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30mc\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30mommit \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;22;22;30mFunction\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[3;124H\u001b[?25h"]
[11.889714, "o", "\u001b[?25l\u001b[4;57H \u001b[63C \u001b[5;57H \u001b[63C \u001b[6;57H \u001b[63C \u001b[7;57H \u001b[63C \u001b[4;58Hcopyright _ \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30m[all]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                              \u001b[5;58H─\u001b[5;59H─\u001b[5;60H─\u001b[5;61H─\u001b[5;62H─\u001b[5;63H─\u001b[5;64H─\u001b[5;65H─\u001b[5;66H─\u001b[5;67H─\u001b[5;68H─\u001b[5;69H─\u001b[5;70H─\u001b[5;71H─\u001b[5;72H─\u001b[5;73H─\u001b[5;74H─\u001b[5;75H─\u001b[5;76H─\u001b[5;77H─\u001b[5;78H─\u001b[5;79H─\u001b[5;80H─\u001b[5;81H─\u001b[5;82H─\u001b[5;83H─\u001b[5;84H─\u001b[5;85H─\u001b[5;86H─\u001b[5;87H─\u001b[5;88H─\u001b[5;89H─\u001b[5;90H─\u001b[5;91H─\u001b[5;92H─\u001b[5;93H─\u001b[5;94H─\u001b[5;95H─\u001b[5;96H─\u001b[5;97H─\u001b[5;98H─\u001b[5;99H─\u001b[5;100H─\u001b[5;101H─\u001b[5;102H─\u001b[5;103H─\u001b[5;104H─\u001b[5;105H─\u001b[5;106H─\u001b[5;107H─\u001b[5;108H─\u001b[5;109H─\u001b[5;110H─\u001b[5;111H─\u001b[5;112H─\u001b[5;113H─\u001b[5;114H─\u001b[5;115H─\u001b[5;116H─\u001b[5;117H─\u001b[5;118H─\u001b[5;119H─\u001b[5;120H─\u001b[6;58HSnippet to put copyright                                       \u001b[7;58HCopyright (c) ${CURRENT_YEAR} ${0:Author}. All Rights Reserved.\u001b[3;124H\u001b[?25h"]
[11.893717, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mo\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m8\u001b[3;125H\u001b[?25h"]
[11.9263, "o", "\u001b[?25l\u001b[5;122H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m                  \u001b[4;122H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m /\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mco\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85mmmit \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;52;58;85mFunction\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b[3;125H\u001b[?25h"]
[11.948015, "o", "\u001b[?25l\u001b[4;57H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m                                      \u001b[5;57H\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38me\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mxists \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m dim_customer                          \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[5;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~               \u001b[6;57H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m ensure \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mhat \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mhe \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mu\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mpdate \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m upstream \u001b(B\u001b[m\u001b[4:3m\u001b["]
[11.94807, "o", "58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mustomer \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[6;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~               \u001b[7;57H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m                                                \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[7;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~               \u001b[4;95H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[25C \u001b[26DGenerate a commit message\u001b[3;125H\u001b[?25h"]
[12.144781, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mn\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m9\u001b[3;126H\u001b[?25h"]
[12.169322, "o", "\u001b[?25l\u001b[4;122H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m                  \u001b[45D\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m          \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[4;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~               \u001b[3;126H\u001b[?25h"]
[12.268723, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mv\u001b[45;188H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m20\u001b[3;127H\u001b[?25h"]
[12.316552, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38me\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m1\u001b[3;128H\u001b[?25h"]
[12.536076, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mr\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m2\u001b[3;129H\u001b[?25h"]
[12.758988, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m3\u001b[3;130H\u001b[?25h"]
[12.776371, "o", "\u001b[?25l\u001b[45;189H4\u001b[3;131H\u001b[?25h"]
[12.921413, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m5\u001b[3;132H\u001b[?25h"]
[12.938315, "o", "\u001b[?25l\u001b[4;130H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85mime~     \u001b(B\u001b[m\u001b[38;2;115;122;162m\u001b[48;2;52;58;85mSnippet\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m  \u001b[5;130H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30mimeHMS~  \u001b(B\u001b[m\u001b[38;2;115;122;162m\u001b[48;2;22;22;30mSnippet\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m  \u001b[6;130H /\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30merminal \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;22;22;30mFunction\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[3;132H\u001b[?25h"]
[13.001999, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mh\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m6\u001b[4;95H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m time _ \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30m[all]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                      \u001b[5;95H ─\u001b[5;97H─\u001b[5;98H─\u001b[5;99H─\u001b[5;100H─\u001b[5;101H─\u001b[5;102H─\u001b[5;103H─\u001b[5;104H─\u001b[5;105H─\u001b[5;106H─\u001b[5;107H─\u001b[5;108H─\u001b[5;109H─\u001b[5;110H─\u001b[5;111H─\u001b[5;112H─\u001b[5;113H─\u001b[5;114H─\u001b[5;115H─\u001b[5;116H─\u001b[5;117H─\u001b[5;118H─\u001b[5;119H─\u001b[5;120H─\u001b[5;121H─\u001b[5;122H─\u001b[5;123H─\u001b[5;124H─\u001b[5;125H─\u001b[5;126H─\u001b[5;127H─\u001b[5;128H─\u001b[5;129H \u001b[6;95H I give you back the time (H:M)    \u001b[7;95H ${CURRENT_HOUR}:${CURRENT_MINUTE} \u001b[3;133H\u001b[?25h"]
[13.003146, "o", "\u001b[?25l\u001b[4;148H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m  \u001b[5;130H                    \u001b[6;130H                    \u001b[4;130H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85mime\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mH\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85mMS~ \u001b(B\u001b[m\u001b[38;2;115;122;162m\u001b[48;2;52;58;85mSnippet\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b[3;133H\u001b[?25h"]
[13.051595, "o", "\u001b[?25l\u001b[4;77H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[51C \u001b[5;77H \u001b[51C \u001b[6;77H \u001b[51C \u001b[7;77H \u001b[51C \u001b[4;78HtimeHMS _ \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30m[all]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                    \u001b[5;78H─\u001b[5;79H─\u001b[5;80H─\u001b[5;81H─\u001b[5;82H─\u001b[5;83H─\u001b[5;84H─\u001b[5;85H─\u001b[5;86H─\u001b[5;87H─\u001b[5;88H─\u001b[5;89H─\u001b[5;90H─\u001b[5;91H─\u001b[5;92H─\u001b[5;93H─\u001b[5;94H─\u001b[5;95H─\u001b[5;96H─\u001b[5;97H─\u001b[5;98H─\u001b[5;99H─\u001b[5;100H─\u001b[5;101H─\u001b[5;102H─\u001b[5;103H─\u001b[5;104H─\u001b[5;105H─\u001b[5;106H─\u001b[5;107H─\u001b[5;108H─\u001b[5;109H─\u001b[5;110H─\u001b[5;111H─\u001b[5;112H─\u001b[5;113H─\u001b[5;114H─\u001b[5;115H─\u001b[5;116H─\u001b[5;117H─\u001b[5;118H─\u001b[5;119H─\u001b[5;120H─\u001b[5;121H─\u001b[5;122H─\u001b[5;123H─\u001b[5;124H─\u001b[5;125H─\u001b[5;126H─\u001b[5;127H─\u001b[5;128H─\u001b[6;78HI give you back the time (H:M:S)                   \u001b[7;78H${CURRENT_HOUR}:${CURRENT_MINUTE}:${CURRENT_SECOND}\u001b[3;133H\u001b[?25h"]
[13.052367, "o", "\u001b[?25l\u001b[4;130H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85mime\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mH\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85mMS~ \u001b(B\u001b[m\u001b[38;2;115;122;162m\u001b[48;2;52;58;85mSnippet\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b[3;133H\u001b[?25h"]
[13.077986, "o", "\u001b[?25l\u001b[4;77H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[51C \u001b[5;77H \u001b[51C \u001b[6;77H \u001b[51C \u001b[7;77H \u001b[51C \u001b[4;78HtimeHMS _ \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30m[all]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                    \u001b[5;78H─\u001b[5;79H─\u001b[5;80H─\u001b[5;81H─\u001b[5;82H─\u001b[5;83H─\u001b[5;84H─\u001b[5;85H─\u001b[5;86H─\u001b[5;87H─\u001b[5;88H─\u001b[5;89H─\u001b[5;90H─\u001b[5;91H─\u001b[5;92H─\u001b[5;93H─\u001b[5;94H─\u001b[5;95H─\u001b[5;96H─\u001b[5;97H─\u001b[5;98H─\u001b[5;99H─\u001b[5;100H─\u001b[5;101H─\u001b[5;102H─\u001b[5;103H─\u001b[5;104H─\u001b[5;105H─\u001b[5;106H─\u001b[5;107H─\u001b[5;108H─\u001b[5;109H─\u001b[5;110H─\u001b[5;111H─\u001b[5;112H─\u001b[5;113H─\u001b[5;114H─\u001b[5;115H─\u001b[5;116H─\u001b[5;117H─\u001b[5;118H─\u001b[5;119H─\u001b[5;120H─\u001b[5;121H─\u001b[5;122H─\u001b[5;123H─\u001b[5;124H─\u001b[5;125H─\u001b[5;126H─\u001b[5;127H─\u001b[5;128H─\u001b[6;78HI give you back the time (H:M:S)                   \u001b[7;78H${CURRENT_HOUR}:${CURRENT_MINUTE}:${CURRENT_SECOND}\u001b[3;133H\u001b[?25h"]
[13.108385, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38me\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m7\u001b[3;134H\u001b[?25h"]
[13.139102, "o", "\u001b[?25l\u001b[4;130H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m                  \u001b[71D\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m                            \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[4;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~                       \u001b[5;77H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mer                          \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[5;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~                       \u001b[6;77H\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mu\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mpdate \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m upstream \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mustomer \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[6;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~                       \u001b[7;77H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m                            \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[7;106H\u001b(B\u001b["]
[13.139229, "o", "m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~                       \u001b[3;134H\u001b[?25h"]
[13.200651, "o", "\u001b[?25l\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m8\u001b[3;135H\u001b[?25h"]
[13.360672, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ms\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m9\u001b[3;136H\u001b[?25h"]
[13.367286, "o", "\u001b[?25l\u001b[4;134H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m /\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85ms\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85mymbols \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;52;58;85mFunction\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b[3;136H\u001b[?25h"]
[13.403626, "o", "\u001b[?25l\u001b[4;98H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m Insert symbols for a selected file \u001b[3;136H\u001b[?25h"]
[13.423227, "o", "\u001b[?25l\u001b[4;134H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m /\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85ms\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85mymbols \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;52;58;85mFunction\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b[3;136H\u001b[?25h"]
[13.428976, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mp\u001b[45;188H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m30\u001b[3;137H\u001b[?25h"]
[13.442722, "o", "\u001b[?25l\u001b[4;98H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[34C \u001b[35DInsert symbols for a selected file\u001b[3;137H\u001b[?25h"]
[13.457624, "o", "\u001b[?25l\u001b[4;134H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m                   \u001b[55D\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m       \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[4;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~                           \u001b[3;137H\u001b[?25h"]
[13.542654, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ma\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m1\u001b[3;138H\u001b[?25h"]
[13.590866, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mr\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m2\u001b[3;139H\u001b[?25h"]
[13.679326, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mk\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m3\u001b[3;140H\u001b[?25h"]
[13.770617, "o", "\u001b[?25l\u001b[45;189H4\u001b[3;141H\u001b[?25h"]
[14.467417, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ms\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m5\u001b[3;142H\u001b[?25h"]
[14.469422, "o", "\u001b[?25l\u001b[4;140H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m /\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85ms\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85mymbols \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;52;58;85mFunction\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b[3;142H\u001b[?25h"]
[14.516449, "o", "\u001b[?25l\u001b[4;104H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m Insert symbols for a selected file \u001b[3;142H\u001b[?25h"]
[14.530908, "o", "\u001b[?25l\u001b[4;140H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m /\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85ms\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85mymbols \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;52;58;85mFunction\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b[3;142H\u001b[?25h"]
[14.550893, "o", "\u001b[?25l\u001b[4;104H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[34C \u001b[35DInsert symbols for a selected file\u001b[3;142H\u001b[?25h"]
[14.562037, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mq\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m6\u001b[3;143H\u001b[?25h"]
[14.573012, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ml\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m7\u001b[3;144H\u001b[?25h"]
[14.590816, "o", "\u001b[?25l\u001b[4;140H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m                   \u001b[55D\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[4;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~                                 \u001b[3;144H\u001b[?25h"]
[14.708705, "o", "\u001b[?25l\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m8\u001b[3;145H\u001b[?25h"]
[14.828491, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m9\u001b[3;146H\u001b[?25h"]
[14.83564, "o", "\u001b[?25l\u001b[4;144H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mc\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m)~     \u001b(B\u001b[m\u001b[38;2;115;122;162m\u001b[48;2;52;58;85mSnippet\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m  \u001b[5;144H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m /\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30mc\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30mommit \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;22;22;30mFunction\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[3;146H\u001b[?25h"]
[14.910213, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mo\u001b[45;188H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m40\u001b[4;79H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m copyright _ \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30m[all]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                               \u001b[5;79H ─\u001b[5;81H─\u001b[5;82H─\u001b[5;83H─\u001b[5;84H─\u001b[5;85H─\u001b[5;86H─\u001b[5;87H─\u001b[5;88H─\u001b[5;89H─\u001b[5;90H─\u001b[5;91H─\u001b[5;92H─\u001b[5;93H─\u001b[5;94H─\u001b[5;95H─\u001b[5;96H─\u001b[5;97H─\u001b[5;98H─\u001b[5;99H─\u001b[5;100H─\u001b[5;101H─\u001b[5;102H─\u001b[5;103H─\u001b[5;104H─\u001b[5;105H─\u001b[5;106H─\u001b[5;107H─\u001b[5;108H─\u001b[5;109H─\u001b[5;110H─\u001b[5;111H─\u001b[5;112H─\u001b[5;113H─\u001b[5;114H─\u001b[5;115H─\u001b[5;116H─\u001b[5;117H─\u001b[5;118H─\u001b[5;119H─\u001b[5;120H─\u001b[5;121H─\u001b[5;122H─\u001b[5;123H─\u001b[5;124H─\u001b[5;125H─\u001b[5;126H─\u001b[5;127H─\u001b[5;128H─\u001b[5;129H─\u001b[5;130H─\u001b[5;131H─\u001b[5;132H─\u001b[5;133H─\u001b[5;134H─\u001b[5;135H─\u001b[5;136H─\u001b[5;137H─\u001b[5;138H─\u001b[5;139H─\u001b[5;140H─\u001b[5;141H─\u001b[5;142H─\u001b[5;143H \u001b[6;79H Snippet to put copyright            "]
[14.910323, "o", "                            \u001b[7;79H Copyright (c) ${CURRENT_YEAR} ${0:Author}. All Rights Reserved. \u001b[3;147H\u001b[?25h"]
[14.911633, "o", "\u001b[?25l\u001b[5;144H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m                  \u001b[4;144H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m /\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mco\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85mmmit \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;52;58;85mFunction\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b[3;147H\u001b[?25h"]
[14.931772, "o", "\u001b[?25l\u001b[4;79H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m                          \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[4;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~          \u001b[5;79H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m                          \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[5;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~                                     \u001b[6;79H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mdate \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m upstream \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mustomer \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[6;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~                                     \u001b[7;79H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m                          \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[7;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~                                     \u001b[4;117H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m"]
[14.931913, "o", " \u001b[25C \u001b[26DGenerate a commit message\u001b[3;147H\u001b[?25h"]
[14.940144, "o", "\u001b[?25l\u001b[4;144H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m /\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mco\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85mmmit \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;52;58;85mFunction\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b[3;147H\u001b[?25h"]
[14.96021, "o", "\u001b[?25l\u001b[4;117H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[25C \u001b[26DGenerate a commit message\u001b[3;147H\u001b[?25h"]
[15.028628, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38md\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m1\u001b[3;148H\u001b[?25h"]
[15.057841, "o", "\u001b[?25l\u001b[4;144H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m                  \u001b[45D                           \u001b[3;148H\u001b[?25h"]
[15.070376, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38me\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m2\u001b[3;149H\u001b[?25h"]
[15.192878, "o", "\u001b[?25l\u001b[45;189H3\u001b[3;150H\u001b[?25h"]
[15.260782, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mi\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m4\u001b[3;151H\u001b[?25h"]
[15.462364, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mn\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m5\u001b[3;152H\u001b[?25h"]
[15.573138, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m6\u001b[3;153H\u001b[?25h"]
[15.687006, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mo\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m7\u001b[3;154H\u001b[?25h"]
[15.871132, "o", "\u001b[?25l\u001b[45;189H8\u001b[3;155H\u001b[?25h"]
[16.030601, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mp\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m9\u001b[3;156H\u001b[?25h"]
[16.296992, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mY\u001b[45;188H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m50\u001b[3;157H\u001b[?25h"]
[16.943449, "o", "\u001b[?25l\b\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b[45;188H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m49\u001b[3;156H\u001b[?25h"]
[17.113665, "o", "\u001b[?25l\b\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m8\u001b[3;155H\u001b[?25h"]
[18.283529, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mp\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m9\u001b[3;156H\u001b[?25h"]
[18.595315, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38my\u001b[45;188H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m50\u001b[3;157H\u001b[?25h"]
[18.789068, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ms\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m1\u001b[3;158H\u001b[?25h"]
[19.19513, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mp\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m2\u001b[3;159H\u001b[?25h"]
[19.369265, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ma\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m3\u001b[3;160H\u001b[?25h"]
[19.527946, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mr\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m4\u001b[3;161H\u001b[?25h"]
[19.711147, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mk\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m5\u001b[3;162H\u001b[?25h"]
[19.874584, "o", "\u001b[?25l\u001b[45;189H6\u001b[3;163H\u001b[?25h"]
[20.394964, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38md\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m7\u001b[3;164H\u001b[?25h"]
[20.412029, "o", "\u001b[?25l\u001b[4;162H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85md\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85miso~     \u001b(B\u001b[m\u001b[38;2;115;122;162m\u001b[48;2;52;58;85mSnippet\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b[5;162H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30md\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30mate~     \u001b(B\u001b[m\u001b[38;2;115;122;162m\u001b[48;2;22;22;30mSnippet\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[6;162H \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30md\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30mateDMY~  \u001b(B\u001b[m\u001b[38;2;115;122;162m\u001b[48;2;22;22;30mSnippet\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[7;162H \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30md\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30mateMDY~  \u001b(B\u001b[m\u001b[38;2;115;122;162m\u001b[48;2;22;22;30mSnippet\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[8;162H \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30md\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30matetime~ \u001b(B\u001b[m\u001b[38;2;115;122;162m\u001b[48;2;22;22;30mSnippet\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[4"]
[20.412286, "o", "8;2;22;22;30m \u001b[3;164H\u001b[?25h"]
[20.466161, "o", "\u001b[?25l\u001b[4;161H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;59;66;97m \u001b[5;161H \u001b[6;161H \u001b[4;161H \u001b[5;161H \u001b[6;161H \u001b[7;161H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;31;41m \u001b[4;74H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m diso _ \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30m[all]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                                                          \u001b[5;74H ─\u001b[5;76H─\u001b[5;77H─\u001b[5;78H─\u001b[5;79H─\u001b[5;80H─\u001b[5;81H─\u001b[5;82H─\u001b[5;83H─\u001b[5;84H─\u001b[5;85H─\u001b[5;86H─\u001b[5;87H─\u001b[5;88H─\u001b[5;89H─\u001b[5;90H─\u001b[5;91H─\u001b[5;92H─\u001b[5;93H─\u001b[5;94H─\u001b[5;95H─\u001b[5;96H─\u001b[5;97H─\u001b[5;98H─\u001b[5;99H─\u001b[5;100H─\u001b[5;101H─\u001b[5;102H─\u001b[5;103H─\u001b[5;104H─\u001b[5;105H─\u001b[5;106H─\u001b[5;107H─\u001b[5;108H─\u001b[5;109H─\u001b[5;110H─\u001b[5;111H─\u001b[5;112H─\u001b[5;113H─\u001b[5;114H─\u001b[5;115H─\u001b[5;116H─\u001b[5;117H─\u001b[5;118H─\u001b[5;119H─\u001b[5;120H─\u001b[5;121H─\u001b[5;122H─\u001b[5;123H─\u001b[5;124H─\u001b[5;125H─\u001b[5;126H─\u001b[5;127H─\u001b[5;128H─\u001b[5;129H─\u001b[5;130H─\u001b[5;131H─\u001b[5;132H─\u001b[5;133H─\u001b[5;134H─\u001b[5;135H─\u001b[5;136H"]
[20.466281, "o", "─\u001b[5;137H─\u001b[5;138H─\u001b[5;139H─\u001b[5;140H─\u001b[5;141H─\u001b[5;142H─\u001b[5;143H─\u001b[5;144H─\u001b[5;145H─\u001b[5;146H─\u001b[5;147H─\u001b[5;148H─\u001b[5;149H─\u001b[5;150H─\u001b[5;151H─\u001b[5;152H─\u001b[5;153H─\u001b[5;154H─\u001b[5;155H─\u001b[5;156H─\u001b[5;157H─\u001b[5;158H─\u001b[5;159H─\u001b[5;160H \u001b[6;74H ISO date time stamp                                                                   \u001b[7;74H ${CURRENT_YEAR}-${CURRENT_MONTH}-${CURRENT_DATE}T${CURRENT_HOUR}:${CURRENT_MINUTE}\u001b(B\u001b[m\u001b[38;2;84;92;126m\u001b[48;2;22;22;30m@@@\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[3;164H\u001b[?25h"]
[20.467508, "o", "\u001b[?25l\u001b[4;162H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85md\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85miso~     \u001b(B\u001b[m\u001b[38;2;115;122;162m\u001b[48;2;52;58;85mSnippet\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b[5;162H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30md\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30mate~     \u001b(B\u001b[m\u001b[38;2;115;122;162m\u001b[48;2;22;22;30mSnippet\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[6;162H \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30md\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30mateDMY~  \u001b(B\u001b[m\u001b[38;2;115;122;162m\u001b[48;2;22;22;30mSnippet\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[7;162H \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30md\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30mateMDY~  \u001b(B\u001b[m\u001b[38;2;115;122;162m\u001b[48;2;22;22;30mSnippet\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[8;162H \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30md\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30matetime~ \u001b(B\u001b[m\u001b[38;2;115;122;162m\u001b[48;2;22;22;30mSnippet\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[4"]
[20.467592, "o", "8;2;22;22;30m \u001b[3;164H\u001b[?25h"]
[20.481405, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ma\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m8\u001b[3;165H\u001b[?25h"]
[20.493464, "o", "\u001b[?25l\u001b[4;74H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[85C \u001b[5;74H \u001b[85C \u001b[6;74H \u001b[85C \u001b[7;74H \u001b[85C \u001b[4;75Hdiso _ \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30m[all]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                                                         \u001b[5;75H─\u001b[5;76H─\u001b[5;77H─\u001b[5;78H─\u001b[5;79H─\u001b[5;80H─\u001b[5;81H─\u001b[5;82H─\u001b[5;83H─\u001b[5;84H─\u001b[5;85H─\u001b[5;86H─\u001b[5;87H─\u001b[5;88H─\u001b[5;89H─\u001b[5;90H─\u001b[5;91H─\u001b[5;92H─\u001b[5;93H─\u001b[5;94H─\u001b[5;95H─\u001b[5;96H─\u001b[5;97H─\u001b[5;98H─\u001b[5;99H─\u001b[5;100H─\u001b[5;101H─\u001b[5;102H─\u001b[5;103H─\u001b[5;104H─\u001b[5;105H─\u001b[5;106H─\u001b[5;107H─\u001b[5;108H─\u001b[5;109H─\u001b[5;110H─\u001b[5;111H─\u001b[5;112H─\u001b[5;113H─\u001b[5;114H─\u001b[5;115H─\u001b[5;116H─\u001b[5;117H─\u001b[5;118H─\u001b[5;119H─\u001b[5;120H─\u001b[5;121H─\u001b[5;122H─\u001b[5;123H─\u001b[5;124H─\u001b[5;125H─\u001b[5;126H─\u001b[5;127H─\u001b[5;128H─\u001b[5;129H─\u001b[5;130H─\u001b[5;131H─\u001b[5;132H─\u001b[5;133H─\u001b[5;134H─\u001b[5;135H─\u001b[5;136H─\u001b[5;137H─\u001b[5;138H─\u001b[5;139H─\u001b[5;140H─\u001b[5;141H─\u001b[5;142H─\u001b[5;143H─\u001b[5;144H─\u001b[5"]
[20.49383, "o", ";145H─\u001b[5;146H─\u001b[5;147H─\u001b[5;148H─\u001b[5;149H─\u001b[5;150H─\u001b[5;151H─\u001b[5;152H─\u001b[5;153H─\u001b[5;154H─\u001b[5;155H─\u001b[5;156H─\u001b[5;157H─\u001b[5;158H─\u001b[5;159H─\u001b[6;75HISO date time stamp                                                                  \u001b[7;75H${CURRENT_YEAR}-${CURRENT_MONTH}-${CURRENT_DATE}T${CURRENT_HOUR}:${CURRENT_MINUTE}:  \b\b\b\u001b(B\u001b[m\u001b[38;2;84;92;126m\u001b[48;2;22;22;30m@@@\u001b[3;165H\u001b[?25h"]
[20.517624, "o", "\u001b[?25l\u001b[8;162H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m                   \u001b[4;162H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mda\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85mte~     \u001b(B\u001b[m\u001b[38;2;115;122;162m\u001b[48;2;52;58;85mSnippet\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b[5;162H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30mda\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30mteDMY~  \u001b(B\u001b[m\u001b[38;2;115;122;162m\u001b[48;2;22;22;30mSnippet\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[6;162H \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30mda\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30mteMDY~  \u001b(B\u001b[m\u001b[38;2;115;122;162m\u001b[48;2;22;22;30mSnippet\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[7;162H \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30mda\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30mtetime~ \u001b(B\u001b[m\u001b[38;2;115;122;162m\u001b[48;2;22;22;30mSnippet\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[3;165H\u001b[?25h"]
[20.580229, "o", "\u001b[?25l\u001b[4;161H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;59;66;97m \u001b[5;161H \u001b[6;161H \u001b[7;161H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m \u001b[4;161H \u001b[5;161H \u001b[6;161H \u001b[4;74H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m                               \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[4;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~     \u001b[5;74H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mtomer                          \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[5;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~     \u001b[6;74H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mhe \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mu\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mpdate \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m upstream \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mustomer \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[6;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~     \u001b[7;74H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m         "]
[20.580363, "o", "                      \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[7;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~     \u001b[3A\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[48C \u001b[5;112H \u001b[48C \u001b[6;112H \u001b[48C \u001b[7;112H \u001b[48C \u001b[4;113Hdate _ \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30m[all]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                    \u001b[5;113H─\u001b[5;114H─\u001b[5;115H─\u001b[5;116H─\u001b[5;117H─\u001b[5;118H─\u001b[5;119H─\u001b[5;120H─\u001b[5;121H─\u001b[5;122H─\u001b[5;123H─\u001b[5;124H─\u001b[5;125H─\u001b[5;126H─\u001b[5;127H─\u001b[5;128H─\u001b[5;129H─\u001b[5;130H─\u001b[5;131H─\u001b[5;132H─\u001b[5;133H─\u001b[5;134H─\u001b[5;135H─\u001b[5;136H─\u001b[5;137H─\u001b[5;138H─\u001b[5;139H─\u001b[5;140H─\u001b[5;141H─\u001b[5;142H─\u001b[5;143H─\u001b[5;144H─\u001b[5;145H─\u001b[5;146H─\u001b[5;147H─\u001b[5;148H─\u001b[5;149H─\u001b[5;150H─\u001b[5;151H─\u001b[5;152H─\u001b[5;153H─\u001b[5;154H─\u001b[5;155H─\u001b[5;156H─\u001b[5;157H─\u001b[5;158H─\u001b[5;159H─\u001b[5;160H─\u001b[6;113HPut the date in (Y-m-D) format                  \u001b[7;113H${CURRENT_YEAR}-${CURRENT_MONTH}-${CURRENT_DATE}\u001b[3;165H\u001b[?25h"]
[20.586877, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m9\u001b[3;166H\u001b[?25h"]
[20.61818, "o", "\u001b[?25l\u001b[4;162H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mdat\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85me~     \u001b(B\u001b[m\u001b[38;2;115;122;162m\u001b[48;2;52;58;85mSnippet\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b[5;162H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30mdat\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30meDMY~  \u001b(B\u001b[m\u001b[38;2;115;122;162m\u001b[48;2;22;22;30mSnippet\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[6;162H \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30mdat\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30meMDY~  \u001b(B\u001b[m\u001b[38;2;115;122;162m\u001b[48;2;22;22;30mSnippet\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[7;162H \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30mdat\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30metime~ \u001b(B\u001b[m\u001b[38;2;115;122;162m\u001b[48;2;22;22;30mSnippet\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[3;166H\u001b[?25h"]
[20.638449, "o", "\u001b[?25l\u001b[4;112H \u001b[48C \u001b[5;112H \u001b[48C \u001b[6;112H \u001b[48C \u001b[7;112H \u001b[48C \u001b[4;113Hdate _ \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30m[all]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                    \u001b[5;113H─\u001b[5;114H─\u001b[5;115H─\u001b[5;116H─\u001b[5;117H─\u001b[5;118H─\u001b[5;119H─\u001b[5;120H─\u001b[5;121H─\u001b[5;122H─\u001b[5;123H─\u001b[5;124H─\u001b[5;125H─\u001b[5;126H─\u001b[5;127H─\u001b[5;128H─\u001b[5;129H─\u001b[5;130H─\u001b[5;131H─\u001b[5;132H─\u001b[5;133H─\u001b[5;134H─\u001b[5;135H─\u001b[5;136H─\u001b[5;137H─\u001b[5;138H─\u001b[5;139H─\u001b[5;140H─\u001b[5;141H─\u001b[5;142H─\u001b[5;143H─\u001b[5;144H─\u001b[5;145H─\u001b[5;146H─\u001b[5;147H─\u001b[5;148H─\u001b[5;149H─\u001b[5;150H─\u001b[5;151H─\u001b[5;152H─\u001b[5;153H─\u001b[5;154H─\u001b[5;155H─\u001b[5;156H─\u001b[5;157H─\u001b[5;158H─\u001b[5;159H─\u001b[5;160H─\u001b[6;113HPut the date in (Y-m-D) format                  \u001b[7;113H${CURRENT_YEAR}-${CURRENT_MONTH}-${CURRENT_DATE}\u001b[3;166H\u001b[?25h"]
[20.67398, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ma\u001b[45;188H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m60\u001b[3;167H\u001b[?25h"]
[20.703247, "o", "\u001b[?25l\u001b[4;162H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m                   \u001b[5;162H                   \u001b[6;162H                   \u001b[7;162H                   \u001b[4;112H                                                  \u001b[5;112H                                                  \u001b[6;112H                                                  \u001b[7;112H                                                  \u001b[3;167H\u001b[?25h"]
[20.872617, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mf\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m1\u001b[3;168H\u001b[?25h"]
[21.102965, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mr\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m2\u001b[3;169H\u001b[?25h"]
[21.239632, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ma\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m3\u001b[3;170H\u001b[?25h"]
[21.396783, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mm\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m4\u001b[3;171H\u001b[?25h"]
[21.47878, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38me\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m5\u001b[3;172H\u001b[?25h"]
[21.600081, "o", "\u001b[?25l\u001b[45;189H6\u001b[3;173H\u001b[?25h"]
[21.895485, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ma\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m7\u001b[3;174H\u001b[?25h"]
[22.006451, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mp\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m8\u001b[3;175H\u001b[?25h"]
[22.060311, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mi\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m9\u001b[3;176H\u001b[?25h"]
[23.131151, "o", "\u001b[?25l\u001b[1;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m5\u001b[2;106H4\u001b[3;106H3 \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m> \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mSharing:\u001b[K\u001b[4;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m2 \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m> \u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m- \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mtool\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38meditor\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m</\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mtool\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[5;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[6;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m6\u001b[45;133H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;41;46;66m[-]                               \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;59;66;97m \u001b[45;169H codecompanion \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m  6\u001b[6;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;"]
[23.131193, "o", "2;26;27;38m6 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mUse \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m@editor\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m to convert the spark sql code into pyspark dataframe api\u001b[K\u001b[7;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~\u001b[K\u001b[8;106H~\u001b[K\u001b[9;106H~\u001b[K\u001b[10;106H~\u001b[K\u001b[11;106H~\u001b[K\u001b[12;106H~\u001b[K\u001b[13;106H~\u001b[K\u001b[14;106H~\u001b[K\u001b[15;106H~\u001b[K\u001b[16;106H~\u001b[K\u001b[17;106H~\u001b[K\u001b[18;106H~\u001b[K\u001b[19;106H~\u001b[K\u001b[20;106H~\u001b[K\u001b[21;106H~\u001b[K\u001b[22;106H~\u001b[K\u001b[23;106H~\u001b[K\u001b[24;106H~\u001b[K\u001b[25;106H~\u001b[K\u001b[26;106H~\u001b[K\u001b[27;106H~\u001b[K\u001b[28;106H~\u001b[K\u001b[29;106H~\u001b[K\u001b[30;106H~\u001b[K\u001b[31;106H~\u001b[K\u001b[32;106H~\u001b[K\u001b[33;106H~\u001b[K\u001b[34;106H~\u001b[K\u001b[35;106H~\u001b[K\u001b[36;106H~\u001b[K\u001b[37;106H~\u001b[K\u001b[38;106H~\u001b[K\u001b[39;106H~\u001b[K\u001b[40;106H~\u001b[K\u001b[41;106H~\u001b[K\u001b[42;106H~\u001b[K\u001b[43;106H~\u001b[K\u001b[44;106H~\u001b[K\u001b[6;176H\u001b[?25h"]
[23.724609, "o", "\u001b[?25l\u001b[1;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 9 \u001b(B\u001b[0;1m\u001b[38;2;224;175;104m\u001b[48;2;26;27;38m## Me\u001b[2;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 8 \u001b[3;106H 7 \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m> \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mSharing:\u001b[4;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 6 \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m> \u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m- \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mtool\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38meditor\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m</\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mtool\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b[5;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 5 \u001b[6;106H 4 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mUse \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m@editor\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m to convert the spark sql code into pyspark dataframe api\u001b[7;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 3 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48"]
[23.725029, "o", ";2;26;27;38m\u001b[K\u001b[8;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 2 \u001b(B\u001b[0;1m\u001b[38;2;224;175;104m\u001b[48;2;26;27;38m## CodeCompanion (Gemini)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[9;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[10;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m10 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mOkay\u001b[K\u001b[45;185H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m10:5 \u001b[10;113H\u001b[?25h"]
[23.738393, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m, I can help with that. To convert Spark SQL code to PySpark DataFrame API\u001b[11;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mcode\u001b[K\u001b[45;188H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m87\u001b[11;113H\u001b[?25h"]
[23.847941, "o", "\u001b[?25l\u001b[1;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m10\u001b[2;107H9\u001b[3;107H8\u001b[4;107H7\u001b[5;107H6\u001b[6;107H5\u001b[7;107H4\u001b[8;107H3\u001b[9;107H2\u001b[10;106H 1\u001b[11;113H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m, I need the code and the buffer number. Could you please provide those?\u001b[12;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m11 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[45;186H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m1:1 \u001b[12;109H\u001b[?25h"]
[23.901544, "o", "\u001b[?25l\u001b[1;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m7\u001b[2;106H16\u001b[3;106H15\u001b[4;106H14\u001b[5;106H13\u001b[6;106H12\u001b[7;106H11\u001b[8;106H10\u001b[9;107H9\u001b[10;107H8\u001b[12;106H 7\u001b[13;106H 6 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[14;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 5 \u001b(B\u001b[0;1m\u001b[38;2;224;175;104m\u001b[48;2;26;27;38m## Me\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m (1123 tokens)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[15;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 4 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[16;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 3 \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m> \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mSharing:\u001b[K\u001b[17;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 2 \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m> \u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m- \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mtool\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38meditor\u001b(B\u001b[m\u001b[38;2;42;195;2"]
[23.901612, "o", "22m\u001b[48;2;26;27;38m</\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mtool\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[18;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[19;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m18 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[45;133H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;41;46;66m                                  \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;59;66;97m \u001b[45;169H codecompanion \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m 18\u001b[19;109H\u001b[?25h"]
[25.236828, "o", "\u001b[?25l\u001b[45;106H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m N \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;41;46;66m [CodeCompanion] 1369025                                  \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;59;66;97m \u001b[45;169H codecompanion \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m 18:1  \u001b[2 q\u001b[19;109H\u001b[?25h"]
[26.141106, "o", "\u001b[?25l\u001b[46;180H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38ma\u001b[19;109H\u001b[?25h"]
[26.175575, "o", "\u001b[?25l\u001b[46;180H \u001b[45;106H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m I \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;41;46;66m [CodeCompanion] 1369025                                  \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;59;66;97m \u001b[45;169H codecompanion \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m 18:1  \u001b[6 q\u001b[19;109H\u001b[?25h"]
[26.780302, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mU\u001b[45;188H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m2\u001b[19;110H\u001b[?25h"]
[26.783294, "o", "\u001b[?25l\u001b[20;108H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mu\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85muid~ \u001b(B\u001b[m\u001b[38;2;115;122;162m\u001b[48;2;52;58;85mSnippet\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b[19;110H\u001b[?25h"]
[26.857326, "o", "\u001b[?25l\u001b[20;90H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m uuid _ \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30m[all]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m     \u001b[21;90H ─\u001b[21;92H─\u001b[21;93H─\u001b[21;94H─\u001b[21;95H─\u001b[21;96H─\u001b[21;97H─\u001b[21;98H─\u001b[21;99H─\u001b[21;100H─\u001b[21;101H─\u001b[21;102H─\u001b[21;103H─\u001b[21;104H─\u001b[21;105H─\u001b[21;106H─\u001b[21;107H \u001b[22;90H A Version 4 UUID \u001b[23;90H ${UUID}          \u001b[19;110H\u001b[?25h"]
[26.858522, "o", "\u001b[?25l\u001b[20;108H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mu\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85muid~ \u001b(B\u001b[m\u001b[38;2;115;122;162m\u001b[48;2;52;58;85mSnippet\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b[19;110H\u001b[?25h"]
[26.87851, "o", "\u001b[?25l\u001b[20;90H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[16C \u001b[21;90H \u001b[16C \u001b[22;90H \u001b[16C \u001b[23;90H \u001b[16C \u001b[20;91Huuid _ \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30m[all]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m    \u001b[21;91H─\u001b[21;92H─\u001b[21;93H─\u001b[21;94H─\u001b[21;95H─\u001b[21;96H─\u001b[21;97H─\u001b[21;98H─\u001b[21;99H─\u001b[21;100H─\u001b[21;101H─\u001b[21;102H─\u001b[21;103H─\u001b[21;104H─\u001b[21;105H─\u001b[21;106H─\u001b[22;91HA Version 4 UUID\u001b[23;91H${UUID}         \u001b[19;110H\u001b[?25h"]
[26.893206, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38ms\u001b[45;188H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m3\u001b[19;111H\u001b[?25h"]
[26.923739, "o", "\u001b[?25l\u001b[20;108H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m               \u001b[33D\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m condition \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mo\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[20;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~ \u001b[21;90H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m               \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[21;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~ \u001b[22;90H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m               \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[22;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~ \u001b[23;90H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m               \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[23;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~ \u001b[19;111H\u001b[?25h"]
[26.994712, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38me\u001b[45;188H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m4\u001b[19;112H\u001b[?25h"]
[27.002835, "o", "\u001b[?25l\u001b[45;188H5\u001b[19;113H\u001b[?25h"]
[27.185088, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b[45;188H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m6\u001b[19;114H\u001b[?25h"]
[27.197608, "o", "\u001b[?25l\u001b[20;112H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85mimeHMS~  \u001b(B\u001b[m\u001b[38;2;115;122;162m\u001b[48;2;52;58;85mSnippet\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m  \u001b[21;112H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30mime~     \u001b(B\u001b[m\u001b[38;2;115;122;162m\u001b[48;2;22;22;30mSnippet\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m  \u001b[22;112H /\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30merminal \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;22;22;30mFunction\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[19;114H\u001b[?25h"]
[27.26874, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mh\u001b[45;188H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m7\u001b[20;59H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m timeHMS _ \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30m[all]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                     \u001b[21;59H ─\u001b[21;61H─\u001b[21;62H─\u001b[21;63H─\u001b[21;64H─\u001b[21;65H─\u001b[21;66H─\u001b[21;67H─\u001b[21;68H─\u001b[21;69H─\u001b[21;70H─\u001b[21;71H─\u001b[21;72H─\u001b[21;73H─\u001b[21;74H─\u001b[21;75H─\u001b[21;76H─\u001b[21;77H─\u001b[21;78H─\u001b[21;79H─\u001b[21;80H─\u001b[21;81H─\u001b[21;82H─\u001b[21;83H─\u001b[21;84H─\u001b[21;85H─\u001b[21;86H─\u001b[21;87H─\u001b[21;88H─\u001b[21;89H─\u001b[21;90H─\u001b[21;91H─\u001b[21;92H─\u001b[21;93H─\u001b[21;94H─\u001b[21;95H─\u001b[21;96H─\u001b[21;97H─\u001b[21;98H─\u001b[21;99H─\u001b[21;100H─\u001b[21;101H─\u001b[21;102H─\u001b[21;103H─\u001b[21;104H─\u001b[21;105H─\u001b[21;106H─\u001b[21;107H─\u001b[21;108H─\u001b[21;109H─\u001b[21;110H─\u001b[21;111H \u001b[22;59H I give you back the time (H:M:S)                    \u001b[23;59H ${CURRENT_HOUR}:${CURRENT_MINUTE}:${CURRENT_SECOND} \u001b[19;115H\u001b[?25h"]
[27.26985, "o", "\u001b[?25l\u001b[20;130H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m  \u001b[21;112H                    \u001b[22;112H                    \u001b[20;112H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85mime\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mH\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85mMS~ \u001b(B\u001b[m\u001b[38;2;115;122;162m\u001b[48;2;52;58;85mSnippet\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b[19;115H\u001b[?25h"]
[27.290999, "o", "\u001b[?25l\u001b[20;59H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[51C \u001b[21;59H \u001b[51C \u001b[22;59H \u001b[51C \u001b[23;59H \u001b[51C \u001b[20;60HtimeHMS _ \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30m[all]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                    \u001b[21;60H─\u001b[21;61H─\u001b[21;62H─\u001b[21;63H─\u001b[21;64H─\u001b[21;65H─\u001b[21;66H─\u001b[21;67H─\u001b[21;68H─\u001b[21;69H─\u001b[21;70H─\u001b[21;71H─\u001b[21;72H─\u001b[21;73H─\u001b[21;74H─\u001b[21;75H─\u001b[21;76H─\u001b[21;77H─\u001b[21;78H─\u001b[21;79H─\u001b[21;80H─\u001b[21;81H─\u001b[21;82H─\u001b[21;83H─\u001b[21;84H─\u001b[21;85H─\u001b[21;86H─\u001b[21;87H─\u001b[21;88H─\u001b[21;89H─\u001b[21;90H─\u001b[21;91H─\u001b[21;92H─\u001b[21;93H─\u001b[21;94H─\u001b[21;95H─\u001b[21;96H─\u001b[21;97H─\u001b[21;98H─\u001b[21;99H─\u001b[21;100H─\u001b[21;101H─\u001b[21;102H─\u001b[21;103H─\u001b[21;104H─\u001b[21;105H─\u001b[21;106H─\u001b[21;107H─\u001b[21;108H─\u001b[21;109H─\u001b[21;110H─\u001b[22;60HI give you back the time (H:M:S)                   \u001b[23;60H${CURRENT_HOUR}:${CURRENT_MINUTE}:${CURRENT_SECOND}\u001b[19;115H\u001b[?25h"]
[27.29952, "o", "\u001b[?25l\u001b[20;112H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85mime\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mH\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85mMS~ \u001b(B\u001b[m\u001b[38;2;115;122;162m\u001b[48;2;52;58;85mSnippet\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b[19;115H\u001b[?25h"]
[27.323835, "o", "\u001b[?25l\u001b[20;59H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[51C \u001b[21;59H \u001b[51C \u001b[22;59H \u001b[51C \u001b[23;59H \u001b[51C \u001b[20;60HtimeHMS _ \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30m[all]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                    \u001b[21;60H─\u001b[21;61H─\u001b[21;62H─\u001b[21;63H─\u001b[21;64H─\u001b[21;65H─\u001b[21;66H─\u001b[21;67H─\u001b[21;68H─\u001b[21;69H─\u001b[21;70H─\u001b[21;71H─\u001b[21;72H─\u001b[21;73H─\u001b[21;74H─\u001b[21;75H─\u001b[21;76H─\u001b[21;77H─\u001b[21;78H─\u001b[21;79H─\u001b[21;80H─\u001b[21;81H─\u001b[21;82H─\u001b[21;83H─\u001b[21;84H─\u001b[21;85H─\u001b[21;86H─\u001b[21;87H─\u001b[21;88H─\u001b[21;89H─\u001b[21;90H─\u001b[21;91H─\u001b[21;92H─\u001b[21;93H─\u001b[21;94H─\u001b[21;95H─\u001b[21;96H─\u001b[21;97H─\u001b[21;98H─\u001b[21;99H─\u001b[21;100H─\u001b[21;101H─\u001b[21;102H─\u001b[21;103H─\u001b[21;104H─\u001b[21;105H─\u001b[21;106H─\u001b[21;107H─\u001b[21;108H─\u001b[21;109H─\u001b[21;110H─\u001b[22;60HI give you back the time (H:M:S)                   \u001b[23;60H${CURRENT_HOUR}:${CURRENT_MINUTE}:${CURRENT_SECOND}\u001b[19;115H\u001b[?25h"]
[27.358022, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38me\u001b[45;188H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m8\u001b[19;116H\u001b[?25h"]
[27.38774, "o", "\u001b[?25l\u001b[20;112H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m                  \u001b[71D\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38me_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m t\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m condition \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mo\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[20;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~     \u001b[21;59H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mat \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mh\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mave \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mh\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mad \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;2"]
[27.387871, "o", "6;27;38mu\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mpdates                           \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[21;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~     \u001b[22;59H\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m                             \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[22;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~     \u001b[23;59H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m                                              \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[23;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~     \u001b[19;116H\u001b[?25h"]
[27.479517, "o", "\u001b[?25l\u001b[45;188H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m9\u001b[19;117H\u001b[?25h"]
[27.597479, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mc\u001b[45;188H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m10\u001b[19;118H\u001b[?25h"]
[27.605864, "o", "\u001b[?25l\u001b[20;116H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mc\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m)~     \u001b(B\u001b[m\u001b[38;2;115;122;162m\u001b[48;2;52;58;85mSnippet\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m  \u001b[21;116H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m /\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30mc\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30mommit \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;22;22;30mFunction\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[19;118H\u001b[?25h"]
[27.690466, "o", "\u001b[?25l\u001b[20;51H copyright _ \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30m[all]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                               \u001b[21;51H ─\u001b[21;53H─\u001b[21;54H─\u001b[21;55H─\u001b[21;56H─\u001b[21;57H─\u001b[21;58H─\u001b[21;59H─\u001b[21;60H─\u001b[21;61H─\u001b[21;62H─\u001b[21;63H─\u001b[21;64H─\u001b[21;65H─\u001b[21;66H─\u001b[21;67H─\u001b[21;68H─\u001b[21;69H─\u001b[21;70H─\u001b[21;71H─\u001b[21;72H─\u001b[21;73H─\u001b[21;74H─\u001b[21;75H─\u001b[21;76H─\u001b[21;77H─\u001b[21;78H─\u001b[21;79H─\u001b[21;80H─\u001b[21;81H─\u001b[21;82H─\u001b[21;83H─\u001b[21;84H─\u001b[21;85H─\u001b[21;86H─\u001b[21;87H─\u001b[21;88H─\u001b[21;89H─\u001b[21;90H─\u001b[21;91H─\u001b[21;92H─\u001b[21;93H─\u001b[21;94H─\u001b[21;95H─\u001b[21;96H─\u001b[21;97H─\u001b[21;98H─\u001b[21;99H─\u001b[21;100H─\u001b[21;101H─\u001b[21;102H─\u001b[21;103H─\u001b[21;104H─\u001b[21;105H─\u001b[21;106H─\u001b[21;107H─\u001b[21;108H─\u001b[21;109H─\u001b[21;110H─\u001b[21;111H─\u001b[21;112H─\u001b[21;113H─\u001b[21;114H─\u001b[21;115H \u001b[22;51H Snippet to put copyright                                        \u001b[23;51H Copyright (c) ${CURRENT_YEAR} ${0:Author}. All Rights Reserved."]
[27.690619, "o", " \u001b[19;118H\u001b[?25h"]
[27.69384, "o", "\u001b[?25l\u001b[20;116H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mc\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m)~     \u001b(B\u001b[m\u001b[38;2;115;122;162m\u001b[48;2;52;58;85mSnippet\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m  \u001b[21;116H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m /\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30mc\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30mommit \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;22;22;30mFunction\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[19;118H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mo\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m1\u001b[19;119H\u001b[?25h"]
[27.712296, "o", "\u001b[?25l\u001b[20;51H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[63C \u001b[21;51H \u001b[63C \u001b[22;51H \u001b[63C \u001b[23;51H \u001b[63C \u001b[20;52Hcopyright _ \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30m[all]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                              \u001b[21;52H─\u001b[21;53H─\u001b[21;54H─\u001b[21;55H─\u001b[21;56H─\u001b[21;57H─\u001b[21;58H─\u001b[21;59H─\u001b[21;60H─\u001b[21;61H─\u001b[21;62H─\u001b[21;63H─\u001b[21;64H─\u001b[21;65H─\u001b[21;66H─\u001b[21;67H─\u001b[21;68H─\u001b[21;69H─\u001b[21;70H─\u001b[21;71H─\u001b[21;72H─\u001b[21;73H─\u001b[21;74H─\u001b[21;75H─\u001b[21;76H─\u001b[21;77H─\u001b[21;78H─\u001b[21;79H─\u001b[21;80H─\u001b[21;81H─\u001b[21;82H─\u001b[21;83H─\u001b[21;84H─\u001b[21;85H─\u001b[21;86H─\u001b[21;87H─\u001b[21;88H─\u001b[21;89H─\u001b[21;90H─\u001b[21;91H─\u001b[21;92H─\u001b[21;93H─\u001b[21;94H─\u001b[21;95H─\u001b[21;96H─\u001b[21;97H─\u001b[21;98H─\u001b[21;99H─\u001b[21;100H─\u001b[21;101H─\u001b[21;102H─\u001b[21;103H─\u001b[21;104H─\u001b[21;105H─\u001b[21;106H─\u001b[21;107H─\u001b[21;108H─\u001b[21;109H─\u001b[21;110H─\u001b[21;111H─\u001b[21;112H─\u001b[21;113H─\u001b[21;114H─\u001b[22;52HSnippet to put copyright                         "]
[27.71234, "o", "              \u001b[23;52HCopyright (c) ${CURRENT_YEAR} ${0:Author}. All Rights Reserved.\u001b[19;119H\u001b[?25h"]
[27.727284, "o", "\u001b[?25l\u001b[21;116H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m                  \u001b[20;116H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m /\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mco\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85mmmit \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;52;58;85mFunction\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b[19;119H\u001b[?25h"]
[27.752736, "o", "\u001b[?25l\u001b[20;51H\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m t\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdatetime_updated\u001b[21;51H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mtomer \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mhat \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mh\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mave \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mh\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mad \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mu\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mpdates                           \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[21;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~         \u001b[22;51H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38md_to \u001b(B"]
[27.753041, "o", "\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m s\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m                             \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[22;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~         \u001b[23;51H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m                                                      \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[23;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~         \u001b[20;89H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[25C \u001b[26DGenerate a commit message\u001b[19;119H\u001b[?25h"]
[27.804146, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38md\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m2\u001b[19;120H\u001b[?25h"]
[27.831939, "o", "\u001b[?25l\u001b[20;116H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m                  \u001b[45D\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m condition \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mo\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[20;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~         \u001b[19;120H\u001b[?25h"]
[27.860511, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38me\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m3\u001b[19;121H\u001b[?25h"]
[27.875867, "o", "\u001b[?25l\u001b[45;189H4\u001b[19;122H\u001b[?25h"]
[28.002513, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mi\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m5\u001b[19;123H\u001b[?25h"]
[28.20643, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mn\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m6\u001b[19;124H\u001b[?25h"]
[28.332296, "o", "\u001b[?25l\u001b[45;189H7\u001b[19;125H\u001b[?25h"]
[28.417514, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m8\u001b[19;126H\u001b[?25h"]
[28.426439, "o", "\u001b[?25l\u001b[20;124H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85mimeHMS~  \u001b(B\u001b[m\u001b[38;2;115;122;162m\u001b[48;2;52;58;85mSnippet\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m  \u001b[21;124H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30mime~     \u001b(B\u001b[m\u001b[38;2;115;122;162m\u001b[48;2;22;22;30mSnippet\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m  \u001b[22;124H /\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30merminal \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;22;22;30mFunction\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[19;126H\u001b[?25h"]
[28.494353, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mh\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m9\u001b[20;71H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m timeHMS _ \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30m[all]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                     \u001b[21;71H ─\u001b[21;73H─\u001b[21;74H─\u001b[21;75H─\u001b[21;76H─\u001b[21;77H─\u001b[21;78H─\u001b[21;79H─\u001b[21;80H─\u001b[21;81H─\u001b[21;82H─\u001b[21;83H─\u001b[21;84H─\u001b[21;85H─\u001b[21;86H─\u001b[21;87H─\u001b[21;88H─\u001b[21;89H─\u001b[21;90H─\u001b[21;91H─\u001b[21;92H─\u001b[21;93H─\u001b[21;94H─\u001b[21;95H─\u001b[21;96H─\u001b[21;97H─\u001b[21;98H─\u001b[21;99H─\u001b[21;100H─\u001b[21;101H─\u001b[21;102H─\u001b[21;103H─\u001b[21;104H─\u001b[21;105H─\u001b[21;106H─\u001b[21;107H─\u001b[21;108H─\u001b[21;109H─\u001b[21;110H─\u001b[21;111H─\u001b[21;112H─\u001b[21;113H─\u001b[21;114H─\u001b[21;115H─\u001b[21;116H─\u001b[21;117H─\u001b[21;118H─\u001b[21;119H─\u001b[21;120H─\u001b[21;121H─\u001b[21;122H─\u001b[21;123H \u001b[22;71H I give you back the time (H:M:S)                    \u001b[23;71H ${CURRENT_HOUR}:${CURRENT_MINUTE}:${CURRENT_SECOND} \u001b[19;127H\u001b[?25h"]
[28.495462, "o", "\u001b[?25l\u001b[20;142H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m  \u001b[21;124H                    \u001b[22;124H                    \u001b[20;124H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85mime\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mH\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85mMS~ \u001b(B\u001b[m\u001b[38;2;115;122;162m\u001b[48;2;52;58;85mSnippet\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b[19;127H\u001b[?25h"]
[28.514133, "o", "\u001b[?25l\u001b[20;71H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[51C \u001b[21;71H \u001b[51C \u001b[22;71H \u001b[51C \u001b[23;71H \u001b[51C \u001b[20;72HtimeHMS _ \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30m[all]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                    \u001b[21;72H─\u001b[21;73H─\u001b[21;74H─\u001b[21;75H─\u001b[21;76H─\u001b[21;77H─\u001b[21;78H─\u001b[21;79H─\u001b[21;80H─\u001b[21;81H─\u001b[21;82H─\u001b[21;83H─\u001b[21;84H─\u001b[21;85H─\u001b[21;86H─\u001b[21;87H─\u001b[21;88H─\u001b[21;89H─\u001b[21;90H─\u001b[21;91H─\u001b[21;92H─\u001b[21;93H─\u001b[21;94H─\u001b[21;95H─\u001b[21;96H─\u001b[21;97H─\u001b[21;98H─\u001b[21;99H─\u001b[21;100H─\u001b[21;101H─\u001b[21;102H─\u001b[21;103H─\u001b[21;104H─\u001b[21;105H─\u001b[21;106H─\u001b[21;107H─\u001b[21;108H─\u001b[21;109H─\u001b[21;110H─\u001b[21;111H─\u001b[21;112H─\u001b[21;113H─\u001b[21;114H─\u001b[21;115H─\u001b[21;116H─\u001b[21;117H─\u001b[21;118H─\u001b[21;119H─\u001b[21;120H─\u001b[21;121H─\u001b[21;122H─\u001b[22;72HI give you back the time (H:M:S)                   \u001b[23;72H${CURRENT_HOUR}:${CURRENT_MINUTE}:${CURRENT_SECOND}\u001b[19;127H\u001b[?25h"]
[28.525352, "o", "\u001b[?25l\u001b[20;124H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85mime\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85mH\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85mMS~ \u001b(B\u001b[m\u001b[38;2;115;122;162m\u001b[48;2;52;58;85mSnippet\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b[19;127H\u001b[?25h"]
[28.546332, "o", "\u001b[?25l\u001b[20;71H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[51C \u001b[21;71H \u001b[51C \u001b[22;71H \u001b[51C \u001b[23;71H \u001b[51C \u001b[20;72HtimeHMS _ \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30m[all]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                    \u001b[21;72H─\u001b[21;73H─\u001b[21;74H─\u001b[21;75H─\u001b[21;76H─\u001b[21;77H─\u001b[21;78H─\u001b[21;79H─\u001b[21;80H─\u001b[21;81H─\u001b[21;82H─\u001b[21;83H─\u001b[21;84H─\u001b[21;85H─\u001b[21;86H─\u001b[21;87H─\u001b[21;88H─\u001b[21;89H─\u001b[21;90H─\u001b[21;91H─\u001b[21;92H─\u001b[21;93H─\u001b[21;94H─\u001b[21;95H─\u001b[21;96H─\u001b[21;97H─\u001b[21;98H─\u001b[21;99H─\u001b[21;100H─\u001b[21;101H─\u001b[21;102H─\u001b[21;103H─\u001b[21;104H─\u001b[21;105H─\u001b[21;106H─\u001b[21;107H─\u001b[21;108H─\u001b[21;109H─\u001b[21;110H─\u001b[21;111H─\u001b[21;112H─\u001b[21;113H─\u001b[21;114H─\u001b[21;115H─\u001b[21;116H─\u001b[21;117H─\u001b[21;118H─\u001b[21;119H─\u001b[21;120H─\u001b[21;121H─\u001b[21;122H─\u001b[22;72HI give you back the time (H:M:S)                   \u001b[23;72H${CURRENT_HOUR}:${CURRENT_MINUTE}:${CURRENT_SECOND}\u001b[19;127H\u001b[?25h"]
[28.583934, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38me\u001b[45;188H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m20\u001b[19;128H\u001b[?25h"]
[28.613651, "o", "\u001b[?25l\u001b[20;124H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m                  \u001b[71D\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m condition \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mo\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[20;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~                 \u001b[21;71H\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mu\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mpdates                           \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[21;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~                 \u001b[22;71H\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m                             \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[22;106H\u001b(B\u001b[m\u001b[38;2;26;27;"]
[28.614006, "o", "38m\u001b[48;2;26;27;38m~                 \u001b[23;71H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m                                  \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[23;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~                 \u001b[19;128H\u001b[?25h"]
[28.635662, "o", "\u001b[?25l\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m1\u001b[19;129H\u001b[?25h"]
[29.477451, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m#\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m2\u001b[19;130H\u001b[?25h"]
[29.485525, "o", "\u001b[?25l\u001b[20;128H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85m#\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85mlsp      Variable \u001b[21;128H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30m#\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30mbuffer   Variable \u001b[22;128H \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30m#\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30mviewport Variable \u001b[19;130H\u001b[?25h"]
[29.530693, "o", "\u001b[?25l\u001b[20;73H Share LSP information and code for the current buffer \u001b[19;130H\u001b[?25h"]
[29.539699, "o", "\u001b[?25l\u001b[20;128H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85m#\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85mlsp      Variable \u001b[21;128H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30m#\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30mbuffer   Variable \u001b[22;128H \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;22;22;30m#\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30mviewport Variable \u001b[19;130H\u001b[?25h"]
[29.55998, "o", "\u001b[?25l\u001b[20;73H \u001b[53C \u001b[54DShare LSP information and code for the current buffer\u001b[19;130H\u001b[?25h"]
[29.920052, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mb\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m3\u001b[19;131H\u001b[?25h"]
[29.986517, "o", "\u001b[?25l\u001b[20;146H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m  \u001b[21;128H                    \u001b[22;128H                    \u001b[20;128H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85m#b\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85muffer Variable \u001b[19;131H\u001b[?25h"]
[30.010723, "o", "\u001b[?25l\u001b[20;73H\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mdatetime_updated\u001b[19;131H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mu\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m4\u001b[20;89H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[37C \u001b[38DShare the current buffer with the LLM\u001b[19;132H\u001b[?25h"]
[30.041257, "o", "\u001b[?25l\u001b[20;128H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85m#bu\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85mffer Variable \u001b[19;132H\u001b[?25h"]
[30.059797, "o", "\u001b[?25l\u001b[20;89H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[37C \u001b[38DShare the current buffer with the LLM\u001b[19;132H\u001b[?25h"]
[30.232789, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mf\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m5\u001b[19;133H\u001b[?25h"]
[30.266197, "o", "\u001b[?25l\u001b[20;128H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85m#buf\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85mfer Variable \u001b[19;133H\u001b[?25h"]
[30.282028, "o", "\u001b[?25l\u001b[20;89H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[37C \u001b[38DShare the current buffer with the LLM\u001b[19;133H\u001b[?25h"]
[30.401604, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mf\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m6\u001b[19;134H\u001b[?25h"]
[30.434745, "o", "\u001b[?25l\u001b[20;128H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85m#buff\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85mer Variable \u001b[19;134H\u001b[?25h"]
[30.454083, "o", "\u001b[?25l\u001b[20;89H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[37C \u001b[38DShare the current buffer with the LLM\u001b[19;134H\u001b[?25h"]
[30.486225, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38me\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m7\u001b[19;135H\u001b[?25h"]
[30.51564, "o", "\u001b[?25l\u001b[20;128H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85m#buffe\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85mr Variable \u001b[19;135H\u001b[?25h"]
[30.534757, "o", "\u001b[?25l\u001b[20;89H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[37C \u001b[38DShare the current buffer with the LLM\u001b[19;135H\u001b[?25h"]
[30.640326, "o", "\u001b[?25l\u001b[6D\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38m#buffer\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m8\u001b[19;136H\u001b[?25h"]
[30.67133, "o", "\u001b[?25l\u001b[20;128H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;52;58;85m#buffer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;52;58;85m Variable \u001b[19;136H\u001b[?25h"]
[30.690334, "o", "\u001b[?25l\u001b[20;89H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b[37C \u001b[38DShare the current buffer with the LLM\u001b[19;136H\u001b[?25h"]
[30.778463, "o", "\u001b[?25l\u001b[45;189H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m9\u001b[19;137H\u001b[?25h"]
[30.806585, "o", "\u001b[?25l\u001b[20;128H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m                  \u001b[57D\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m condition \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mo\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[20;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~                     \u001b[19;137H\u001b[?25h"]
[31.891198, "o", "\u001b[?25l\u001b[1;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m8\u001b[2;107H7\u001b[3;107H6\u001b[4;107H5\u001b[5;107H4\u001b[6;107H3\u001b[7;107H2\u001b[8;107H1\u001b[9;106H10\u001b[10;107H9\u001b[12;107H8\u001b[13;107H7\u001b[14;107H6\u001b[15;107H5\u001b[16;107H4\u001b[17;107H3\u001b[18;106H 2 \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m> \u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m- \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mbuf\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mmergeinto/mergeinto.py\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m</\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mbuf\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[20;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m9\u001b[45;133H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;41;46;66m[-]                               \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;59;66;97m \u001b[45;169H codecompanion \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m 19\u001b[19;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[20;106H\u001b(B\u001b[m\u001b[38;2;59;"]
[31.89141, "o", "66;97m\u001b[48;2;26;27;38m19 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mUse the code in the \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38m#buffer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[21;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~\u001b[K\u001b[22;106H~\u001b[K\u001b[23;106H~\u001b[K\u001b[24;106H~\u001b[K\u001b[25;106H~\u001b[K\u001b[26;106H~\u001b[K\u001b[27;106H~\u001b[K\u001b[28;106H~\u001b[K\u001b[29;106H~\u001b[K\u001b[30;106H~\u001b[K\u001b[31;106H~\u001b[K\u001b[32;106H~\u001b[K\u001b[33;106H~\u001b[K\u001b[34;106H~\u001b[K\u001b[35;106H~\u001b[K\u001b[36;106H~\u001b[K\u001b[37;106H~\u001b[K\u001b[38;106H~\u001b[K\u001b[39;106H~\u001b[K\u001b[40;106H~\u001b[K\u001b[41;106H~\u001b[K\u001b[42;106H~\u001b[K\u001b[43;106H~\u001b[K\u001b[44;106H~\u001b[K\u001b[20;137H\u001b[?25h"]
[32.432289, "o", "\u001b[?25l\u001b[1;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m23\u001b[2;106H22\u001b[3;106H21\u001b[4;106H20\u001b[5;107H9\u001b[6;107H8\u001b[7;107H7\u001b[8;107H6\u001b[9;107H5\u001b[10;106H14\u001b[12;106H13\u001b[13;106H12\u001b[14;106H11\u001b[15;106H10\u001b[16;107H9\u001b[17;107H8\u001b[18;107H7\u001b[19;107H6\u001b[20;106H 5\u001b[21;106H 4 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[22;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 3 \u001b(B\u001b[0;1m\u001b[38;2;224;175;104m\u001b[48;2;26;27;38m## CodeCompanion (Gemini)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[23;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 2 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[24;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 1 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m```\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38mxml\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[25;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m24 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[45;185H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m24:2 \u001b[25;110H\u001b[?25h"]
[32.44138, "o", "\u001b[?25l\b\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b[?25h"]
[32.476831, "o", "\u001b[?25l\u001b[1;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m5\u001b[2;107H4\u001b[3;107H3\u001b[4;107H2\u001b[5;106H21\u001b[6;106H20\u001b[7;107H9\u001b[8;107H8\u001b[9;107H7\u001b[10;107H6\u001b[12;107H5\u001b[13;107H4\u001b[14;107H3\u001b[15;107H2\u001b[16;106H11\u001b[17;106H10\u001b[18;107H9\u001b[19;107H8\u001b[20;107H7\u001b[21;107H6\u001b[22;107H5\u001b[23;107H4\u001b[24;107H3\u001b[25;106H 2 \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mtools\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b[26;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 1 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mtool\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mname\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38meditor\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[27;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m26 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;"]
[32.476965, "o", "38m<\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38maction type\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\"\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[45;186H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m6:19\u001b[27;127H\u001b[?25h"]
[32.547921, "o", "\u001b[?25l\u001b[1;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m7\u001b[2;107H6\u001b[3;107H5\u001b[4;107H4\u001b[5;107H3\u001b[6;107H2\u001b[7;106H21\u001b[8;106H20\u001b[9;107H9\u001b[10;107H8\u001b[12;107H7\u001b[13;107H6\u001b[14;107H5\u001b[15;107H4\u001b[16;107H3\u001b[17;107H2\u001b[18;106H11\u001b[19;106H10\u001b[20;107H9\u001b[21;107H8\u001b[22;107H7\u001b[23;107H6\u001b[24;107H5\u001b[25;107H4\u001b[26;107H3\u001b[27;106H 2 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38maction\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mtype\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38madd\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b[28;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 1 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mbuffer\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m12\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m</\u001b(B\u001b[m\u001b[38;2;187;154;2"]
[32.548141, "o", "47m\u001b[48;2;26;27;38mbuffer\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[29;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m28 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mreplace\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[45;186H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m8:15\u001b[29;123H\u001b[?25h"]
[32.735143, "o", "\u001b[?25l\u001b[1;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m31\u001b[2;106H30\u001b[3;107H9\u001b[4;107H8\u001b[5;107H7\u001b[6;107H6\u001b[7;107H5\u001b[8;107H4\u001b[9;106H23\u001b[10;106H22\u001b[12;106H21\u001b[13;106H20\u001b[14;107H9\u001b[15;107H8\u001b[16;107H7\u001b[17;107H6\u001b[18;107H5\u001b[19;107H4\u001b[20;106H13\u001b[21;106H12\u001b[22;106H11\u001b[23;106H10\u001b[24;107H9\u001b[25;107H8\u001b[26;107H7\u001b[27;107H6\u001b[28;107H5\u001b[29;106H 4 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mreplace\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mtrue\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m</\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mreplace\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b[30;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 3 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mcode\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m<![CDATA\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m[\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48"]
[32.735638, "o", ";2;26;27;38mfrom pyspark.sql import SparkSession\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[31;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 2 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfrom pyspark.sql.functions import lit\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[32;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[33;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m32 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[45;185H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m32:1 \u001b[33;109H\u001b[?25h"]
[32.94224, "o", "\u001b[?25l\u001b[1;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m4\u001b[2;107H3\u001b[3;106H32\u001b[4;106H31\u001b[5;106H30\u001b[6;107H9\u001b[7;107H8\u001b[8;107H7\u001b[9;107H6\u001b[10;107H5\u001b[12;107H4\u001b[13;107H3\u001b[14;106H22\u001b[15;106H21\u001b[16;106H20\u001b[17;107H9\u001b[18;107H8\u001b[19;107H7\u001b[20;107H6\u001b[21;107H5\u001b[22;107H4\u001b[23;107H3\u001b[24;106H12\u001b[25;106H11\u001b[26;106H10\u001b[27;107H9\u001b[28;107H8\u001b[29;107H7\u001b[30;107H6\u001b[31;107H5\u001b[32;107H4\u001b[33;106H 3 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Initialize SparkSession\u001b[34;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 2 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mspark = SparkSession.builder.appName(\"MergeInto\").getOrCreate()\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[35;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[36;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m35 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Define the source and target tables (replace with your actual\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[45;186H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m5:64\u001b[36;172H\u001b[?25h"]
[32.951777, "o", "\u001b[?25l\u001b[34;115H\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m SparkSession.builder.appName\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mMergeInto\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.getOrCreate\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m()\u001b[36;147H(\u001b[24C\u001b[?25h"]
[33.242925, "o", "\u001b[?25l\u001b[1;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m7\u001b[2;107H6\u001b[3;107H5\u001b[4;107H4\u001b[5;107H3\u001b[6;106H32\u001b[7;106H31\u001b[8;106H30\u001b[9;107H9\u001b[10;107H8\u001b[12;107H7\u001b[13;107H6\u001b[14;107H5\u001b[15;107H4\u001b[16;107H3\u001b[17;106H22\u001b[18;106H21\u001b[19;106H20\u001b[20;107H9\u001b[21;107H8\u001b[22;107H7\u001b[23;107H6\u001b[24;107H5\u001b[25;107H4\u001b[26;107H3\u001b[27;106H12\u001b[28;106H11\u001b[29;106H10\u001b[30;107H9\u001b[31;107H8\u001b[32;107H7\u001b[33;107H6\u001b[34;107H5\u001b[35;107H4\u001b[36;106H 3 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Define the source and target tables \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mreplace with your actual table names and   \u001b[37;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdata loading\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[38;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 2 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Assuming you have DataFrames named \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_df\u001b(B\u001b[m\u001b[38;2"]
[33.243075, "o", ";137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38msource\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m and \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b[39;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mtarget\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[40;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 1 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Example data loading \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mreplace with your actual data loading logic\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K"]
[33.243101, "o", "\u001b[41;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m38 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# customer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[45;186H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m8:11\u001b[41;119H\u001b[?25h"]
[33.450527, "o", "\u001b[?25l\u001b[1;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m40\u001b[2;107H9\u001b[3;107H8\u001b[4;107H7\u001b[5;107H6\u001b[6;107H5\u001b[7;107H4\u001b[8;107H3\u001b[9;106H32\u001b[10;106H31\u001b[12;106H30\u001b[13;107H9\u001b[14;107H8\u001b[15;107H7\u001b[16;107H6\u001b[17;107H5\u001b[18;107H4\u001b[19;107H3\u001b[20;106H22\u001b[21;106H21\u001b[22;106H20\u001b[23;107H9\u001b[24;107H8\u001b[25;107H7\u001b[26;107H6\u001b[27;107H5\u001b[28;107H4\u001b[29;107H3\u001b[30;106H12\u001b[31;106H11\u001b[32;106H10\u001b[33;107H9\u001b[34;107H8\u001b[35;107H7\u001b[36;107H6\u001b[38;107H5\u001b[40;107H4\u001b[41;106H 3 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# customer_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m spark.read.table\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mprod.db.customer\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b[42;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 2 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# dim_customer_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m spark.read.table\u001b(B\u001b[m\u001b["]
[33.450578, "o", "38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mprod.db.dim_customer\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[43;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[44;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m41 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# ---  customers_with_updates CTE equivalent\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[45;185H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m41:45\u001b[44;153H\u001b[?25h"]
[33.76264, "o", "\u001b[?25l\u001b[1;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m9\u001b[2;107H8\u001b[3;107H7\u001b[4;107H6\u001b[5;107H5\u001b[7;107H4\u001b[8;106H33\u001b[9;106H32\u001b[10;106H31\u001b[11;106H30\u001b[12;107H9\u001b[13;107H8\u001b[14;107H7\u001b[15;107H6\u001b[16;107H5\u001b[17;107H4\u001b[18;106H23\u001b[19;106H22\u001b[20;106H21\u001b[21;106H20\u001b[22;107H9\u001b[23;107H8\u001b[24;107H7\u001b[25;107H6\u001b[26;107H5\u001b[27;107H4\u001b[28;106H13\u001b[29;106H12\u001b[30;106H11\u001b[31;106H10\u001b[33;107H9\u001b[35;107H8\u001b[36;107H7\u001b[37;107H6\u001b[38;107H5\u001b[39;106H 4 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# ---  customers_with_updates CTE equivalent ---\u001b[40;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 3 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates = customer_df.alias(\"c\").join(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[41;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 2 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    dim_customer_df.alias(\"dc\"),\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[42;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 1 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col(\"c.customer_id\") == col(\"dc.customer_id\"),  # ON c.customer_id = dc.   "]
[33.763026, "o", "   \u001b[43;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[44;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m45 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[45;186H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;158;206;106m5:1 \u001b[1;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m39 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mUse \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m@editor\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m to convert the spark sql code into pyspark dataframe api\u001b[K\u001b[2;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m38 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[3;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m37 \u001b(B\u001b[0;1m\u001b[38;2;224;175;104m\u001b[48;2;26;27;38m## CodeCompanion (Gemini)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[4;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m36 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[5;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m35 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38"]
[33.763134, "o", "mOkay, I can help with that. To convert Spark SQL code to PySpark DataFrame API\u001b[K\u001b[6;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mcode, I need the code and the buffer number. Could you please provide those?\u001b[K\u001b[7;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m34 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[8;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m33 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[9;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m32 \u001b(B\u001b[0;1m\u001b[38;2;224;175;104m\u001b[48;2;26;27;38m## Me\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m (1123 tokens)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[10;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m31 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[11;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m30 \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m> \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mSharing:\u001b[K\u001b[12;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m29 \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m> \u001b(B\u001b[0;1m\u001b[38;"]
[33.763602, "o", "2;255;158;100m\u001b[48;2;26;27;38m- \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mtool\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38meditor\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m</\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mtool\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[13;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m28 \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m> \u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m- \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mbuf\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mmergeinto/mergeinto.py\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m</\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mbuf\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[14;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m27 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[15;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m26 \u001b(B"]
[33.763692, "o", "\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mUse the code in the \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38m#buffer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[16;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m25 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[17;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m24 \u001b(B\u001b[0;1m\u001b[38;2;224;175;104m\u001b[48;2;26;27;38m## CodeCompanion (Gemini)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[18;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m23 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[19;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m22 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m```\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38mxml\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[20;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m21 \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mtools\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[21;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m20 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b["]
[33.764011, "o", "48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mtool\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mname\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38meditor\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[22;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m19 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38maction\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mtype\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38madd\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[23;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m18 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;"]
[33.764109, "o", "38mbuffer\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m12\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m</\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mbuffer\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[24;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m17 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mreplace\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mtrue\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m</\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mreplace\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[25;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m16 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mcode\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m<![CDATA\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27"]
[33.764475, "o", ";38m[\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfrom pyspark.sql import SparkSession\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[26;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m15 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfrom pyspark.sql.functions import lit\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[27;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m14 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[28;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m13 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Initialize SparkSession\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[29;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m12 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mspark \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m SparkSession.builder.appName\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mMergeInto\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\""]
[33.764541, "o", "\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.getOrCreate\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m()\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[30;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m11 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[31;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m10 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Define the source and target tables \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mreplace with your actual table names and\u001b[K\u001b[32;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdata loading\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[33;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 9 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Assuming you have DataFrames named \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38"]
[33.764821, "o", "m \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38msource\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m and \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m\u001b[K\u001b[34;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mtarget\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[35;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 8 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Example data loading \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mreplace with your actual data loading logic\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[36;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 7 \u001b(B\u001b[m\u001b[38;2;158;2"]
[33.764884, "o", "06;106m\u001b[48;2;26;27;38m# customer_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m spark.read.table\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mprod.db.customer\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[37;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 6 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# dim_customer_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m spark.read.table\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mprod.db.dim_customer\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[38;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 5 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[39;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;2"]
[33.76492, "o", "7;38m 4 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# ---  customers_with_updates CTE equivalent ---\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[44;109H\u001b[?25h"]
[33.771237, "o", "\u001b[?25l\u001b[40;132H\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customer_df.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.join\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b[41;134H(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b[42;116H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mc.customer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[4"]
[33.771369, "o", "8;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdc.customer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m  # ON c.customer_id \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b[44;109H\u001b[?25h"]
[34.023004, "o", "\u001b[?25l\u001b[45;106H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m N \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;41;46;66m [CodeCompanion] 1369025[-]                               \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;59;66;97m \u001b[45;169H codecompanion \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m 45:1  \u001b[2 q\u001b[44;109H\u001b[?25h"]
[34.271195, "o", "\u001b[?25l\u001b[1;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m8\u001b[3;107H7\u001b[4;107H6\u001b[5;107H5\u001b[6;107H4\u001b[7;107H3\u001b[8;106H32\u001b[9;106H31\u001b[10;106H30\u001b[11;107H9\u001b[12;107H8\u001b[13;107H7\u001b[14;107H6\u001b[15;107H5\u001b[16;107H4\u001b[17;107H3\u001b[18;106H22\u001b[19;106H21\u001b[20;106H20\u001b[21;107H9\u001b[22;107H8\u001b[23;107H7\u001b[24;107H6\u001b[25;107H5\u001b[26;107H4\u001b[27;107H3\u001b[29;106H12\u001b[31;106H11\u001b[32;106H10\u001b[33;107H9\u001b[34;107H8\u001b[35;107H7\u001b[36;107H6\u001b[37;107H5\u001b[38;107H4\u001b[40;106H 3 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \"inner\"\u001b[41;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 2 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m).where(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[42;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 1 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    (col(\"c.datetime_updated\") > col(\"dc.datetime_updated\")) &  # WHERE c.        \u001b[43;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdatetime_updated > dc.datetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[44;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m"]
[34.271623, "o", "\u001b[48;2;26;27;38m48 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    (col(\"dc.is_current\") == True)  # AND dc.is_\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[45;186H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m8:48\u001b[1;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m38 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mOkay, I can help with that. To convert Spark SQL code to PySpark DataFrame API\u001b[K\u001b[2;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mcode, I need the code and the buffer number. Could you please provide those?\u001b[K\u001b[3;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m37 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[4;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m36 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[5;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m35 \u001b(B\u001b[0;1m\u001b[38;2;224;175;104m\u001b[48;2;26;27;38m## Me\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m (1123 tokens)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[6;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m34"]
[34.271932, "o", " \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[7;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m33 \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m> \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mSharing:\u001b[K\u001b[8;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m32 \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m> \u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m- \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mtool\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38meditor\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m</\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mtool\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[9;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m31 \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m> \u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m- \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mbuf\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mmergeinto/mergeinto.py\u001b(B\u001b[m\u001b[38;2;42;195;222m"]
[34.272274, "o", "\u001b[48;2;26;27;38m</\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mbuf\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[10;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m30 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[11;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m29 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mUse the code in the \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38m#buffer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[12;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m28 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[13;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m27 \u001b(B\u001b[0;1m\u001b[38;2;224;175;104m\u001b[48;2;26;27;38m## CodeCompanion (Gemini)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[14;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m26 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[15;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m25 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m```\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38mxml\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[16;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m"]
[34.272622, "o", "24 \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mtools\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[17;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m23 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mtool\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mname\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38meditor\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[18;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m22 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38maction\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mtype\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38madd\u001b(B\u001b[m\u001b[3"]
[34.272947, "o", "8;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[19;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m21 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mbuffer\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m12\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m</\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mbuffer\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[20;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m20 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mreplace\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mtrue\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m</\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mreplace\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[21;106H\u001b(B\u001b[m\u001b"]
[34.273267, "o", "[38;2;59;66;97m\u001b[48;2;26;27;38m19 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mcode\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m<![CDATA\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m[\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfrom pyspark.sql import SparkSession\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[22;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m18 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfrom pyspark.sql.functions import lit\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[23;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m17 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[24;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m16 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Initialize SparkSession\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[25;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m15 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m"]
[34.273621, "o", "spark \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m SparkSession.builder.appName\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mMergeInto\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.getOrCreate\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m()\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[26;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m14 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[27;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m13 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Define the source and target tables \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mreplace with your actual table names and\u001b[K\u001b[28;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdata loading\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[29;106H\u001b"]
[34.273869, "o", "(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m12 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Assuming you have DataFrames named \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38msource\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m and \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m\u001b[K\u001b[30;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mtarget\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[31;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m11 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Example data loading \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[4"]
[34.274104, "o", "8;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mreplace with your actual data loading logic\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[32;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m10 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# customer_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m spark.read.table\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;3"]
[34.274325, "o", "8m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mprod.db.customer\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[33;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 9 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# dim_customer_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m spark.read.table\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mprod.db.dim_customer\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[34;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 8 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[35;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 7 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# ---  customers_with_updates CTE equivalent ---\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[36;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 6 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b["]
[34.274596, "o", "48;2;26;27;38mcustomers_with_updates \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customer_df.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.join\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[37;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 5 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    dim_customer_df.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[38;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 4 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;2"]
[34.274809, "o", "6;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mc.customer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdc.customer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m  # ON c.customer_id \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m dc.\u001b[K\u001b[39;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[40;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 3 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \"i"]
[34.275025, "o", "nner\"\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[44;156H\u001b[?25h"]
[34.282021, "o", "\u001b[?25l\u001b[40;113H\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38minner\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b[41;109H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.where\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b[42;113H(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mc.datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdc.datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m))\u001b[43;130H\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b[44;113H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m("]
[34.282139, "o", "\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdc.is_current\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m True\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b[13C\u001b[?25h"]
[34.476158, "o", "\u001b[?25l\u001b[1;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m9\u001b[2;107H8\u001b[3;107H7\u001b[4;106H36\u001b[5;106H35\u001b[6;106H34\u001b[7;106H33\u001b[8;106H32\u001b[9;106H31\u001b[10;106H30\u001b[11;107H9\u001b[12;107H8\u001b[13;107H7\u001b[14;106H26\u001b[15;106H25\u001b[16;106H24\u001b[17;106H23\u001b[18;106H22\u001b[19;106H21\u001b[20;106H20\u001b[22;107H9\u001b[24;107H8\u001b[25;107H7\u001b[26;106H16\u001b[27;106H15\u001b[28;106H14\u001b[29;106H13\u001b[30;106H12\u001b[31;106H11\u001b[33;106H10\u001b[34;107H9\u001b[35;107H8\u001b[37;106H 7 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdc.is_current\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m True\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m  # AND dc.is_current = true\u001b[38;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;"]
[34.476624, "o", "27;38m 6 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m).select(\"c.*\")\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[39;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 5 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[40;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 4 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# --- Union the dataframes for insertion/update ---\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[41;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 3 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Add a 'join_key' column to customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[42;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 2 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_df = customer_df.withColumn(\"join_key\", col(\"customer_id\"))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[43;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[44;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m55 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Create a DataFrame from\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[4"]
[34.476975, "o", "5;185H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m55:25\u001b[1;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m39 \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m> \u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m- \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mtool\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38meditor\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m</\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mtool\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[2;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m38 \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m> \u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m- \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mbuf\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mmergeinto/mergeinto.py\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m</\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mbuf\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2"]
[34.477314, "o", ";26;27;38m\u001b[K\u001b[3;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m37 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[4;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m36 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mUse the code in the \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38m#buffer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[5;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m35 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[6;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m34 \u001b(B\u001b[0;1m\u001b[38;2;224;175;104m\u001b[48;2;26;27;38m## CodeCompanion (Gemini)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[7;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m33 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[8;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m32 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m```\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38mxml\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[9;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m31 \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mtools\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38"]
[34.477656, "o", ";2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[10;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m30 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mtool\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mname\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38meditor\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[11;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m29 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38maction\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mtype\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38madd\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[12;106H\u001b(B\u001b[m\u001b[38;2;5"]
[34.477998, "o", "9;66;97m\u001b[48;2;26;27;38m28 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mbuffer\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m12\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m</\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mbuffer\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[13;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m27 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mreplace\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mtrue\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m</\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mreplace\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[14;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m26 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;15"]
[34.47828, "o", "4;247m\u001b[48;2;26;27;38mcode\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m<![CDATA\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m[\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfrom pyspark.sql import SparkSession\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[15;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m25 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfrom pyspark.sql.functions import lit\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[16;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m24 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[17;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m23 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Initialize SparkSession\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[18;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m22 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mspark \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m SparkSession.builder.appName\u001b(B\u001b[m\u001b[38;2;169;177;21"]
[34.478597, "o", "4m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mMergeInto\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.getOrCreate\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m()\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[19;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m21 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[20;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m20 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Define the source and target tables \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mreplace with your actual table names and\u001b[K\u001b[21;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdata loading\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[22;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m19 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Assuming you have DataFrames named \u001b(B\u001b[m\u001b[38;2;137;221;25"]
[34.478836, "o", "5m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38msource\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m and \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m\u001b[K\u001b[23;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mtarget\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[24;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m18 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Example data loading \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mreplace with your actual data loading logic\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b"]
[34.479105, "o", "(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[25;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m17 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# customer_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m spark.read.table\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mprod.db.customer\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;3"]
[34.479454, "o", "8m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[26;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m16 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# dim_customer_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m spark.read.table\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mprod.db.dim_customer\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[27;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m15 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[28;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m14 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# ---  customers_with_updates CTE equivalent ---\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[29;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m13 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customer_df.alias\u001b(B"]
[34.479755, "o", "\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.join\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[30;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m12 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    dim_customer_df.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[31;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m11 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mc.customer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;2"]
[34.480046, "o", "7;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdc.customer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m  # ON c.customer_id \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m dc.\u001b[K\u001b[32;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[33;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m10 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38minner\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;"]
[34.480326, "o", "192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[34;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 9 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.where\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[35;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 8 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mc.datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdc.datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m))\u001b(B"]
[34.480669, "o", "\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m &  # WHERE c.\u001b[K\u001b[36;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdatetime_updated \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m dc.datetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[37;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 7 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdc.is_current\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m True\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m  # AND dc.is_current = true\u001b(B\u001b[m\u001b[38;2;192;202;245m"]
[34.480971, "o", "\u001b[48;2;26;27;38m\u001b[K\u001b[44;133H\u001b[?25h"]
[34.486914, "o", "\u001b[?25l\u001b[37;165H\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b[38;109H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.select\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mc.\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b[41;117H\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b[42;121H=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customer_df.withColumn\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\",\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b"]
[34.486979, "o", "(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m))\u001b[44;133H\u001b[?25h"]
[34.985619, "o", "\u001b[?25l\u001b[1;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m8\u001b[2;107H7\u001b[3;107H6\u001b[4;107H5\u001b[5;106H34\u001b[6;106H33\u001b[7;106H32\u001b[8;106H31\u001b[9;106H30\u001b[10;107H9\u001b[11;107H8\u001b[12;107H7\u001b[13;107H6\u001b[14;107H5\u001b[16;106H24\u001b[18;106H23\u001b[19;106H22\u001b[20;106H21\u001b[21;106H20\u001b[22;107H9\u001b[23;107H8\u001b[24;107H7\u001b[25;107H6\u001b[27;107H5\u001b[28;106H14\u001b[29;106H13\u001b[31;106H12\u001b[32;106H11\u001b[33;106H10\u001b[34;107H9\u001b[35;107H8\u001b[36;107H7\u001b[37;107H6\u001b[38;106H 5 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Create a DataFrame from customers_with_updates and add a NULL join_key\u001b[39;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 4 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfrom pyspark.sql import Row\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[40;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 3 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfrom pyspark.sql.types import StructType, StructField, StringType, BooleanType,   \u001b[41;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mTimestampType, IntegerType\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[42;106H\u001b(B\u001b[m\u001b[38;2;5"]
[34.985673, "o", "9;66;97m\u001b[48;2;26;27;38m 2 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[43;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 1 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Dynamically create schema for null values, handling all customer_df columns\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[44;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m60 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[45;185H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m60:9 \u001b[1;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m38 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[2;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m37 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m```\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38mxml\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[3;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m36 \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mtools\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[4;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;3"]
[34.985795, "o", "8m35 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mtool\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mname\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38meditor\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[5;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m34 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38maction\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mtype\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38madd\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[6;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m33 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b"]
[34.985822, "o", "[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mbuffer\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m12\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m</\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mbuffer\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[7;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m32 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mreplace\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mtrue\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m</\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mreplace\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[8;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m31 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mcode\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158"]
[34.985945, "o", ";206;106m\u001b[48;2;26;27;38m<![CDATA\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m[\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfrom pyspark.sql import SparkSession\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[9;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m30 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfrom pyspark.sql.functions import lit\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[10;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m29 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[11;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m28 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Initialize SparkSession\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[12;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m27 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mspark \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m SparkSession.builder.appName\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;10"]
[34.985986, "o", "6m\u001b[48;2;26;27;38mMergeInto\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.getOrCreate\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m()\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[13;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m26 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[14;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m25 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Define the source and target tables \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mreplace with your actual table names and\u001b[K\u001b[15;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdata loading\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[16;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m24 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Assuming you have DataFrames named \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_df\u001b(B\u001b[m\u001b[38;2;"]
[34.986082, "o", "137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38msource\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m and \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m\u001b[K\u001b[17;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mtarget\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[18;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m23 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Example data loading \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mreplace with your actual data loading logic\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b["]
[34.98611, "o", "K\u001b[19;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m22 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# customer_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m spark.read.table\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mprod.db.customer\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[20;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m21 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# dim_customer_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m spark.read.table\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mprod.db.dim_customer\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[21;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m20 \u001b(B\u001b[m\u001b[38;2;192;"]
[34.986137, "o", "202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[22;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m19 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# ---  customers_with_updates CTE equivalent ---\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[23;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m18 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customer_df.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.join\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[24;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m17 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    dim_customer_df.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdc\u001b(B\u001b[m\u001b[38;2;1"]
[34.986252, "o", "37;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[25;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m16 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mc.customer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdc.customer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m  # ON c.customer_id \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m dc.\u001b[K\u001b"]
[34.986284, "o", "[26;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[27;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m15 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38minner\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[28;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m14 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.where\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[29;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m13 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mc.datetime_updated\u001b(B\u001b[m\u001b[38;2;137"]
[34.98631, "o", ";221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdc.datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m))\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m &  # WHERE c.\u001b[K\u001b[30;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdatetime_updated \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m dc.datetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[31;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m12 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;22"]
[34.986433, "o", "1;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdc.is_current\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m True\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m  # AND dc.is_current \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m true\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[32;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m11 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.select\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mc.\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[33;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m10 \u001b(B\u001b[m\u001b[3"]
[34.986485, "o", "8;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[34;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 9 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# --- Union the dataframes for insertion/update ---\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[35;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 8 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Add a \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m column to customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[36;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 7 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customer_df.withColumn\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\",\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26"]
[34.986539, "o", ";27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[37;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 6 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[38;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 5 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Create a DataFrame from customers_with_updates and add a NULL join_key\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[44;117H\u001b[?25h"]
[34.987701, "o", "\u001b[?25l\u001b[40;149H\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m StructField\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m StringType\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m BooleanType\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b[41;122H,\u001b[43;152H,\u001b[44;117H\u001b[?25h"]
[35.292215, "o", "\u001b[?25l\u001b[1;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m7\u001b[2;107H6\u001b[3;107H5\u001b[4;106H34\u001b[5;106H33\u001b[6;106H32\u001b[7;106H31\u001b[8;106H30\u001b[10;107H9\u001b[12;107H8\u001b[13;107H7\u001b[14;107H6\u001b[15;107H5\u001b[16;106H24\u001b[17;106H23\u001b[18;106H22\u001b[19;106H21\u001b[21;106H20\u001b[22;107H9\u001b[23;107H8\u001b[25;107H7\u001b[26;107H6\u001b[27;107H5\u001b[28;106H14\u001b[29;106H13\u001b[30;106H12\u001b[31;106H11\u001b[32;106H10\u001b[33;107H9\u001b[34;107H8\u001b[36;107H7\u001b[37;107H6\u001b[38;106H 5 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_schema = customer_df.schema\u001b[39;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 4 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates_schema = StructType([\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[40;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 3 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    StructField(\"join_key\", StringType(), True)] + customer_schema.fields\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[41;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 2 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[42;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;"]
[35.292467, "o", "27;38m 1 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Create empty rows of data based on this schema, one row for each element in the \u001b[43;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mDF\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[44;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m65 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_row\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[45;186H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m5\u001b[1;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m37 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mreplace\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mtrue\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m</\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mreplace\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[2;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m36 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;42"]
[35.292579, "o", ";195;222m\u001b[48;2;26;27;38m<\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mcode\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m<![CDATA\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m[\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfrom pyspark.sql import SparkSession\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[3;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m35 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfrom pyspark.sql.functions import lit\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[4;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m34 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[5;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m33 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Initialize SparkSession\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[6;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m32 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mspark \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m SparkSessi"]
[35.292853, "o", "on.builder.appName\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mMergeInto\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.getOrCreate\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m()\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[7;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m31 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[8;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m30 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Define the source and target tables \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mreplace with your actual table names and\u001b[K\u001b[9;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdata loading\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[10;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m29 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Assuming you have Da"]
[35.292935, "o", "taFrames named \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38msource\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m and \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m\u001b[K\u001b[11;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mtarget\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[12;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m28 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Example data loading \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mreplace with your actual data loading logic\u001b(B\u001b["]
[35.293167, "o", "m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[13;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m27 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# customer_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m spark.read.table\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mprod.db.customer\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[14;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m26 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# dim_customer_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m spark.read.table\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mprod.db.dim_customer\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2"]
[35.293241, "o", ";26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[15;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m25 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[16;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m24 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# ---  customers_with_updates CTE equivalent ---\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[17;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m23 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customer_df.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.join\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[18;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m22 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    dim_customer_df.alias\u001b(B\u001b[m\u001b[38;2;169;17"]
[35.293554, "o", "7;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[19;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m21 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mc.customer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdc.customer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2"]
[35.293627, "o", ";26;27;38m  # ON c.customer_id \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m dc.\u001b[K\u001b[20;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[21;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m20 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38minner\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[22;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m19 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.where\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[23;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m18 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27"]
[35.293895, "o", ";38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mc.datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdc.datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b["]
[35.294063, "o", "38;2;169;177;214m\u001b[48;2;26;27;38m))\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m &  # WHERE c.\u001b[K\u001b[24;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdatetime_updated \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m dc.datetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[25;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m17 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdc.is_current\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m True\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m  # AND dc.is_c"]
[35.294296, "o", "urrent \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m true\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[26;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m16 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.select\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mc.\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[27;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m15 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[28;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m14 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# --- Union the dataframes for insertion/update ---\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[29;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m13 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Add a \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[4"]
[35.294564, "o", "8;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m column to customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[30;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m12 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customer_df.withColumn\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\",\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[31;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m11 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[32;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m10 \u001b(B\u001b[m\u001b[38;2;15"]
[35.294734, "o", "8;206;106m\u001b[48;2;26;27;38m# Create a DataFrame from customers_with_updates and add a NULL join_key\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[33;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 9 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfrom pyspark.sql import Row\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[34;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 8 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfrom pyspark.sql.types import StructType\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m StructField\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m StringType\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m BooleanType\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m\u001b[K\u001b[35;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mTimestampType\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m IntegerType\u001b(B\u001b[m\u001b[38;2;192;202"]
[35.294917, "o", ";245m\u001b[48;2;26;27;38m\u001b[K\u001b[36;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 7 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[37;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 6 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Dynamically create schema for null values\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m handling all customer_df columns\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[38;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 5 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_schema = customer_df.schema\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[44;117H\u001b[?25h"]
[35.298943, "o", "\u001b[?25l\u001b[38;125H\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b[39;139H=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m StructType\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m([\u001b[40;124H(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\",\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m StringType\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m()\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m True\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)]\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m+\u001b[41;109H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b[42;157H\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b[44;117H\u001b[?25h"]
[35.59956, "o", "\u001b[?25l\u001b[1;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m6\u001b[2;107H5\u001b[3;107H4\u001b[4;107H3\u001b[6;106H32\u001b[8;106H31\u001b[9;106H30\u001b[10;107H9\u001b[11;107H8\u001b[12;107H7\u001b[13;107H6\u001b[14;107H5\u001b[15;107H4\u001b[17;107H3\u001b[18;106H22\u001b[19;106H21\u001b[21;106H20\u001b[22;107H9\u001b[23;107H8\u001b[24;107H7\u001b[25;107H6\u001b[26;107H5\u001b[27;107H4\u001b[28;107H3\u001b[29;106H12\u001b[30;106H11\u001b[32;106H10\u001b[33;107H9\u001b[34;107H8\u001b[35;107H7\u001b[36;107H6\u001b[37;107H5\u001b[38;107H4\u001b[40;106H 3 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_row = Row(*([None] * len(customers_with_updates_schema)))\u001b[41;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 2 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_rows = spark.createDataFrame([empty_row] * customers_with_updates.count(),  \u001b[42;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates_schema)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[43;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 1 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Drop join_key and then reorder\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[44;106H\u001b(B\u001b[m\u001b[38;2;59;66"]
[35.599611, "o", ";97m\u001b[48;2;26;27;38m68 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_rows = empty\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[45;186H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m8:18\u001b[1;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m36 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Initialize SparkSession\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[2;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m35 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mspark \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m SparkSession.builder.appName\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mMergeInto\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.getOrCreate\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m()\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[3;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m34 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[4;106H\u001b(B\u001b[m\u001b[38;2;59"]
[35.599625, "o", ";66;97m\u001b[48;2;26;27;38m33 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Define the source and target tables \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mreplace with your actual table names and\u001b[K\u001b[5;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdata loading\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[6;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m32 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Assuming you have DataFrames named \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38msource\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m and \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m"]
[35.599757, "o", "\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m\u001b[K\u001b[7;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mtarget\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[8;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m31 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Example data loading \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mreplace with your actual data loading logic\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[9;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m30 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# customer_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m spark.read.table\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mprod.db.customer\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b["]
[35.599788, "o", "48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[10;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m29 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# dim_customer_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m spark.read.table\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mprod.db.dim_customer\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[11;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m28 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[12;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m27 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# ---  customers_with_updates CTE equivalent ---\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[13;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m26 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b["]
[35.599803, "o", "38;2;158;206;106m\u001b[48;2;26;27;38m customer_df.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.join\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[14;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m25 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    dim_customer_df.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[15;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m24 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;2"]
[35.599913, "o", "7;38mc.customer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdc.customer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m  # ON c.customer_id \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m dc.\u001b[K\u001b[16;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[17;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m23 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38minner\u001b"]
[35.599941, "o", "(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[18;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m22 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.where\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[19;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m21 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mc.datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdc.datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26"]
[35.599957, "o", ";27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m))\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m &  # WHERE c.\u001b[K\u001b[20;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdatetime_updated \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m dc.datetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[21;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m20 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdc.is_current\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m True\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38"]
[35.599972, "o", "m  # AND dc.is_current \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m true\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[22;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m19 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.select\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mc.\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[23;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m18 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[24;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m17 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# --- Union the dataframes for insertion/update ---\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[25;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m16 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Add a \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2"]
[35.600085, "o", ";158;206;106m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m column to customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[26;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m15 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customer_df.withColumn\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\",\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[27;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m14 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[28;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m13"]
[35.600113, "o", " \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Create a DataFrame from customers_with_updates and add a NULL join_key\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[29;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m12 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfrom pyspark.sql import Row\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[30;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m11 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfrom pyspark.sql.types import StructType\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m StructField\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m StringType\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m BooleanType\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m\u001b[K\u001b[31;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mTimestampType\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m IntegerType\u001b(B\u001b"]
[35.600211, "o", "[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[32;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m10 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[33;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 9 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Dynamically create schema for null values\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m handling all customer_df columns\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[34;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 8 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_schema \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customer_df.schema\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[35;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 7 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates_schema \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m StructType\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m([\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[36;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;"]
[35.600272, "o", "27;38m 6 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    StructField\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\",\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m StringType\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m()\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m True\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)]\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m+\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customer_schema.fields\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[37;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 5 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[38;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 4 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Create empty rows of data based on this schema\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m one row"]
[35.600315, "o", " for each element in the\u001b[K\u001b[39;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mDF\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[40;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 3 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_row = Row(*([None] * len(customers_with_updates_schema)))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[44;126H\u001b[?25h"]
[35.602548, "o", "\u001b[?25l\u001b[40;119H\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m Row\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m([\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mNone\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m]\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m len\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates_schema\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)))\u001b[41;120H\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m spark.createDataFrame\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m([\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_row\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m]\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customers_with_updates.count\u001b(B\u001b[m\u001b[38;2;169;177;21"]
[35.602659, "o", "4m\u001b[48;2;26;27;38m()\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b[42;138H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b[44;120H\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b[5C\u001b[?25h"]
[36.012265, "o", "\u001b[?25l\u001b[1;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m7\u001b[2;107H6\u001b[3;106H35\u001b[4;106H34\u001b[5;106H33\u001b[6;106H32\u001b[7;106H31\u001b[8;106H30\u001b[10;107H9\u001b[11;107H8\u001b[12;107H7\u001b[14;107H6\u001b[15;106H25\u001b[16;106H24\u001b[17;106H23\u001b[18;106H22\u001b[19;106H21\u001b[20;106H20\u001b[21;107H9\u001b[22;107H8\u001b[23;107H7\u001b[25;107H6\u001b[26;106H15\u001b[27;106H14\u001b[28;106H13\u001b[29;106H12\u001b[30;106H11\u001b[31;106H10\u001b[33;107H9\u001b[34;107H8\u001b[36;107H7\u001b[37;106H 6 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_rows \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m empty_rows.drop(\"join_key\")\u001b[38;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 5 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_rows = empty_rows.select(customer_df.columns)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[39;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 4 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Union all the dataframes together\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[40;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 3 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates = customers_wit"]
[36.012701, "o", "h_updates.union(empty_rows)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[41;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 2 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[42;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 1 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Create a null join_key column\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[43;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m74 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfrom\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[44;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~\u001b[K\u001b[45;185H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m74:4 \u001b[1;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m37 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Example data loading \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mreplace with your actual data loading logic\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[2;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m36 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48"]
[36.013042, "o", ";2;26;27;38m# customer_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m spark.read.table\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mprod.db.customer\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[3;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m35 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# dim_customer_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m spark.read.table\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mprod.db.dim_customer\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[4;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m34 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[5;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m33 \u001b(B\u001b[m"]
[36.013368, "o", "\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# ---  customers_with_updates CTE equivalent ---\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[6;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m32 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customer_df.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.join\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[7;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m31 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    dim_customer_df.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;13"]
[36.013665, "o", "7;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[8;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m30 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mc.customer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdc.customer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m  # ON c.customer_id \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m dc.\u001b[K\u001b[9;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;"]
[36.013995, "o", "38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[10;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m29 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38minner\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[11;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m28 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.where\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[12;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m27 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mc.datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;20"]
[36.014288, "o", "6;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdc.datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m))\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m &  # WHERE c.\u001b[K\u001b[13;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdatetime_updated \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m dc.datetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[14;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m26 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdc.is_current\u001b(B\u001b[m\u001b[38"]
[36.014596, "o", ";2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m True\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m  # AND dc.is_current \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m true\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[15;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m25 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.select\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mc.\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[16;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m24 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[17;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m23 \u001b("]
[36.014687, "o", "B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# --- Union the dataframes for insertion/update ---\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[18;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m22 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Add a \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m column to customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[19;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m21 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customer_df.withColumn\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\",\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27"]
[36.014984, "o", ";38mcustomer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[20;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m20 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[21;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m19 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Create a DataFrame from customers_with_updates and add a NULL join_key\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[22;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m18 \u001b(B\u001b[m\u001b[38;2;158;"]
[36.015265, "o", "206;106m\u001b[48;2;26;27;38mfrom pyspark.sql import Row\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[23;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m17 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfrom pyspark.sql.types import StructType\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m StructField\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m StringType\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m BooleanType\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m\u001b[K\u001b[24;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mTimestampType\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m IntegerType\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[25;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m16 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[26;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m15 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m"]
[36.015598, "o", "# Dynamically create schema for null values\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m handling all customer_df columns\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[27;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m14 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_schema \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customer_df.schema\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[28;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m13 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates_schema \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m StructType\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m([\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[29;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m12 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    StructField\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b["]
[36.01569, "o", "48;2;26;27;38m\",\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m StringType\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m()\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m True\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)]\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m+\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customer_schema.fields\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[30;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m11 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[31;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m10 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Create empty rows of data based on this schema\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m one row for each element in the\u001b[K\u001b[32;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mDF\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[33;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 9 \u001b(B\u001b[m\u001b[38;"]
[36.015988, "o", "2;158;206;106m\u001b[48;2;26;27;38mempty_row \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m Row\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m([\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mNone\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m]\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m len\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates_schema\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[34;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 8 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_rows \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m spark.createDataFrame\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m([\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_row\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m]\u001b(B\u001b[m\u001b[38;2;1"]
[36.01626, "o", "58;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customers_with_updates.count\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m()\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m\u001b[K\u001b[35;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates_schema\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[36;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 7 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Drop join_key and then reorder\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[37;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 6 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_rows \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m empty_rows.drop(\"join_key\")\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[43;112H\u001b[?25h"]
[36.034419, "o", "\u001b[?25l\u001b[37;137H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b[38;120H\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m empty_rows.select\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_df.columns\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b[40;132H\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customers_with_updates.union\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_rows\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b[43;112H\u001b[?25h"]
[36.425978, "o", "\u001b[?25l\u001b[1;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m6\u001b[2;107H5\u001b[3;107H4\u001b[5;106H33\u001b[6;106H32\u001b[7;106H31\u001b[9;106H30\u001b[10;107H9\u001b[11;107H8\u001b[12;107H7\u001b[13;107H6\u001b[14;107H5\u001b[15;107H4\u001b[16;106H23\u001b[17;106H22\u001b[18;106H21\u001b[20;106H20\u001b[21;107H9\u001b[22;107H8\u001b[23;107H7\u001b[24;107H6\u001b[25;107H5\u001b[26;107H4\u001b[28;106H13\u001b[29;106H12\u001b[31;106H11\u001b[32;106H10\u001b[33;107H9\u001b[34;107H8\u001b[35;107H7\u001b[36;107H6\u001b[37;107H5\u001b[38;106H 4 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfrom pyspark.sql.functions import lit\u001b[39;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 3 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates = customers_with_updates.withColumn(\"join_key\", lit(None). \u001b[40;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcast(\"string\"))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[41;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 2 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[42;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 1 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Union the two dataframes\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2"]
[36.42612, "o", ";26;27;38m\u001b[K\u001b[43;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m78 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38msource_df = customer_df.unionByName\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates,                       \u001b[44;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mallowMissingColumns=True\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[45;166H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;59;66;97m \u001b[45;168H codecompanion \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m 78:107\u001b[1;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m36 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customer_df.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;"]
[36.426621, "o", "38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.join\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[2;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m35 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    dim_customer_df.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[3;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m34 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mc.customer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b["]
[36.42698, "o", "48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdc.customer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m  # ON c.customer_id \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m dc.\u001b[K\u001b[4;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[5;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m33 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38minner\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[6;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m32 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.where\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;"]
[36.42732, "o", "38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[7;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m31 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mc.datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdc.datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m))\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m &  # WHERE c.\u001b[K\u001b[8;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdatetime_updated \u001b("]
[36.427692, "o", "B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m dc.datetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[9;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m30 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdc.is_current\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m True\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m  # AND dc.is_current \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m true\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[10;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m29 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;2"]
[36.428053, "o", "06;106m\u001b[48;2;26;27;38m.select\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mc.\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[11;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m28 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[12;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m27 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# --- Union the dataframes for insertion/update ---\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[13;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m26 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Add a \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m column to customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[14;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m25 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48"]
[36.428447, "o", ";2;26;27;38mcustomer_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customer_df.withColumn\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\",\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[15;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m24 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[16;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m23 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Create a DataFrame from customers_with_updates and add a NULL join_key\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[17;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m22 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfrom pyspark.sql"]
[36.42871, "o", " import Row\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[18;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m21 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfrom pyspark.sql.types import StructType\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m StructField\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m StringType\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m BooleanType\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m\u001b[K\u001b[19;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mTimestampType\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m IntegerType\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[20;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m20 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[21;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m19 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Dynamically create schema for null val"]
[36.428963, "o", "ues\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m handling all customer_df columns\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[22;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m18 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_schema \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customer_df.schema\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[23;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m17 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates_schema \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m StructType\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m([\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[24;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m16 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    StructField\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\",\u001b(B\u001b[m\u001b[38;2;158;206;106"]
[36.429205, "o", "m\u001b[48;2;26;27;38m StringType\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m()\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m True\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)]\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m+\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customer_schema.fields\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[25;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m15 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[26;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m14 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Create empty rows of data based on this schema\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m one row for each element in the\u001b[K\u001b[27;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mDF\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[28;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m13 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_row "]
[36.429486, "o", "\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m Row\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m([\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mNone\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m]\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m len\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates_schema\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[29;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m12 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_rows \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m spark.createDataFrame\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m([\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_row\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m]\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2"]
[36.429591, "o", ";42;195;222m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customers_with_updates.count\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m()\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m\u001b[K\u001b[30;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates_schema\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[31;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m11 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Drop join_key and then reorder\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[32;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m10 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_rows \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m empty_rows.drop\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b["]
[36.429936, "o", "m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[33;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 9 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_rows \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m empty_rows.select\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_df.columns\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[34;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 8 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Union all the dataframes together\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[35;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 7 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customers_with_updates.union\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_rows\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[36;106H\u001b(B\u001b[m\u001b[38"]
[36.430171, "o", ";2;59;66;97m\u001b[48;2;26;27;38m 6 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[37;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 5 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Create a null join_key column\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[38;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 4 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfrom pyspark.sql.functions import lit\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[39;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 3 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates = customers_with_updates.withColumn(\"join_key\", lit(None).\u001b[K\u001b[44;133H\u001b[?25h"]
[36.443406, "o", "\u001b[?25l\u001b[39;132H\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customers_with_updates.withColumn\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\",\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m lit\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mNone\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b[40;113H(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mstring\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m))\u001b[43;119H\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customer_df.unionByName\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b[44;128H=\u001b[4C\u001b[?25h"]
[36.732638, "o", "\u001b[?25l\u001b[1;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m6\u001b[2;106H35\u001b[3;106H34\u001b[4;106H33\u001b[5;106H32\u001b[6;106H31\u001b[7;106H30\u001b[8;107H9\u001b[9;107H8\u001b[10;107H7\u001b[12;107H6\u001b[13;106H25\u001b[14;106H24\u001b[15;106H23\u001b[16;106H22\u001b[17;106H21\u001b[18;106H20\u001b[20;107H9\u001b[21;107H8\u001b[23;107H7\u001b[24;107H6\u001b[25;106H15\u001b[26;106H14\u001b[27;106H13\u001b[28;106H12\u001b[29;106H11\u001b[30;106H10\u001b[31;107H9\u001b[33;107H8\u001b[34;107H7\u001b[35;106H 6 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38msource_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customer_df.unionByName\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b[36;133H)\u001b[37;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 5 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[38;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 4 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m# --- Perform the merge logic ---\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[39;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 3 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m# 1. Update existing records\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[40;106H\u001b(B\u001b[m\u001b[38;2;59"]
[36.733068, "o", ";66;97m\u001b[48;2;26;27;38m 2 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m# Condition: MATCHED AND is_current = true AND s.datetime_updated > t.            \u001b[41;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[42;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 1 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m# Action: UPDATE SET is_current = false, valid_to = s.datetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[43;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m84 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38mupdated_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[44;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~\u001b[K\u001b[45;166H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;41;46;66m \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;59;66;97m \u001b[45;169H codecompanion \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m 84:10\u001b[1;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m36 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;"]
[36.733374, "o", "206;106m\u001b[48;2;26;27;38mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdc.is_current\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m True\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m  # AND dc.is_current \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m true\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[2;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m35 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.select\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mc.\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192"]
[36.7337, "o", ";202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[3;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m34 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[4;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m33 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# --- Union the dataframes for insertion/update ---\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[5;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m32 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Add a \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m column to customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[6;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m31 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customer_df.withColumn\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;3"]
[36.733983, "o", "8m\",\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[7;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m30 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[8;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m29 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Create a DataFrame from customers_with_updates and add a NULL join_key\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[9;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m28 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfrom pyspark.sql import Row\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[10;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m27 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfrom pyspark.sql.types import StructType\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m StructField\u001b(B\u001b[m\u001b[38;2;137;221;255"]
[36.734284, "o", "m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m StringType\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m BooleanType\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m\u001b[K\u001b[11;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mTimestampType\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m IntegerType\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[12;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m26 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[13;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m25 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Dynamically create schema for null values\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m handling all customer_df columns\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[14;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m24 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_schema \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;"]
[36.73456, "o", "27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customer_df.schema\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[15;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m23 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates_schema \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m StructType\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m([\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[16;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m22 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    StructField\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\",\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m StringType\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m()\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m True\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)]\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m+\u001b(B\u001b[m\u001b[38;2;158;206"]
[36.734831, "o", ";106m\u001b[48;2;26;27;38m customer_schema.fields\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[17;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m21 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[18;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m20 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Create empty rows of data based on this schema\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m one row for each element in the\u001b[K\u001b[19;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mDF\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[20;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m19 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_row \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m Row\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m([\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mNone\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m]\u001b(B\u001b["]
[36.735064, "o", "m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m len\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates_schema\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[21;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m18 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_rows \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m spark.createDataFrame\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m([\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_row\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m]\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customers_with_updates.count\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m()\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m\u001b[K\u001b[22;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b["]
[36.735282, "o", "48;2;26;27;38mcustomers_with_updates_schema\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[23;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m17 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Drop join_key and then reorder\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[24;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m16 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_rows \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m empty_rows.drop\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[25;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m15 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_rows \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m empty_rows.select\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;"]
[36.735412, "o", "106m\u001b[48;2;26;27;38mcustomer_df.columns\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[26;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m14 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Union all the dataframes together\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[27;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m13 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customers_with_updates.union\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_rows\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[28;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m12 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[29;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m11 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Create a null join_key column\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[30;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m10 \u001b(B\u001b[m\u001b[38;2;1"]
[36.735675, "o", "58;206;106m\u001b[48;2;26;27;38mfrom pyspark.sql.functions import lit\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[31;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 9 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customers_with_updates.withColumn\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\",\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m lit\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mNone\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.\u001b[K\u001b[32;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcast\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mstring\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;2"]
[36.73588, "o", "14m\u001b[48;2;26;27;38m))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[33;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 8 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[34;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 7 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Union the two dataframes\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[35;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 6 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38msource_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customer_df.unionByName\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m\u001b[K\u001b[36;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mallowMissingColumns\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[43;118H\u001b[?25h"]
[36.749885, "o", "\u001b[?25l\u001b[38;109H\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# --- Perform the merge logic ---\u001b[39;109H# 1. Update existing records\u001b[40;109H# Condition: MATCHED AND is_current \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m true AND s.datetime_updated \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m t.            \u001b[41;109Hdatetime_updated\u001b[42;109H# Action: UPDATE SET is_current \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m false\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m valid_to \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m s.datetime_updated\u001b[43;109Hupdated_df\b\u001b[?25h"]
[37.033942, "o", "\u001b[?25l\u001b[1;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m7\u001b[2;107H6\u001b[3;107H5\u001b[4;106H34\u001b[5;106H33\u001b[6;106H32\u001b[8;106H31\u001b[9;106H30\u001b[10;107H9\u001b[11;107H8\u001b[12;107H7\u001b[13;107H6\u001b[14;107H5\u001b[16;106H24\u001b[17;106H23\u001b[19;106H22\u001b[20;106H21\u001b[21;106H20\u001b[22;107H9\u001b[23;107H8\u001b[24;107H7\u001b[25;107H6\u001b[26;107H5\u001b[27;106H14\u001b[29;106H13\u001b[30;106H12\u001b[31;106H11\u001b[33;106H10\u001b[34;107H9\u001b[35;107H8\u001b[36;107H7\u001b[38;107H6\u001b[39;106H 5 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mupdated_df = dim_customer_df.alias(\"t\").join(\u001b[40;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 4 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    source_df.alias(\"s\"),\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[41;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 3 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col(\"t.customer_id\") == col(\"s.join_key\"),\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[42;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 2 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \"inner\"\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[43;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 1 \u001b(B\u001b[m\u001b[38;2;158;2"]
[37.034091, "o", "06;106m\u001b[48;2;26;27;38m).where(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[44;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m89 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    (col(\"t.is_current\") == True) & (\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[45;186H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m9:37\u001b[1;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m37 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Add a \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m column to customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[2;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m36 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customer_df.withColumn\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m"]
[37.034559, "o", "\",\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[3;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m35 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[4;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m34 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Create a DataFrame from customers_with_updates and add a NULL join_key\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[5;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m33 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfrom pyspark.sql import Row\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[6;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m32 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfrom pyspark.sql.types import StructType\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m StructField\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b["]
[37.034673, "o", "48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m StringType\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m BooleanType\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m\u001b[K\u001b[7;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mTimestampType\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m IntegerType\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[8;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m31 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[9;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m30 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Dynamically create schema for null values\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m handling all customer_df columns\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[10;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m29 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_schema \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m"]
[37.035065, "o", "=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customer_df.schema\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[11;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m28 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates_schema \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m StructType\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m([\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[12;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m27 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    StructField\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\",\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m StringType\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m()\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m True\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)]\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m+\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b"]
[37.035168, "o", "[48;2;26;27;38m customer_schema.fields\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[13;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m26 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[14;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m25 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Create empty rows of data based on this schema\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m one row for each element in the\u001b[K\u001b[15;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mDF\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[16;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m24 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_row \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m Row\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m([\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mNone\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m]\u001b(B\u001b[m\u001b[38;"]
[37.035563, "o", "2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m len\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates_schema\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[17;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m23 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_rows \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m spark.createDataFrame\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m([\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_row\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m]\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customers_with_updates.count\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m()\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m\u001b[K\u001b[18;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;2"]
[37.035662, "o", "6;27;38mcustomers_with_updates_schema\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[19;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m22 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Drop join_key and then reorder\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[20;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m21 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_rows \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m empty_rows.drop\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[21;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m20 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_rows \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m empty_rows.select\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b["]
[37.035973, "o", "48;2;26;27;38mcustomer_df.columns\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[22;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m19 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Union all the dataframes together\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[23;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m18 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customers_with_updates.union\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_rows\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[24;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m17 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[25;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m16 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Create a null join_key column\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[26;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m15 \u001b(B\u001b[m\u001b[38;2;158;206"]
[37.036277, "o", ";106m\u001b[48;2;26;27;38mfrom pyspark.sql.functions import lit\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[27;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m14 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customers_with_updates.withColumn\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\",\u001b(B"]
[37.0366, "o", "\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m lit\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mNone\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.\u001b[K\u001b[28;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcast\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mstring\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[29;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m13 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[30;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m12 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Union the two dataframes\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[31;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m11 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38msource_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customer_df.u"]
[37.036719, "o", "nionByName\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m\u001b[K\u001b[32;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mallowMissingColumns\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[33;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m10 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[34;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 9 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# --- Perform the merge logic ---\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[35;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 8 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# 1. Update existing records\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[36;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 7 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Condition: MATCHED AND"]
[37.037037, "o", " is_current \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m true AND s.datetime_updated \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m t.\u001b[K\u001b[37;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[38;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 6 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Action: UPDATE SET is_current \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m false\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m valid_to \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m s.datetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[39;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 5 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mupdated_df = dim_customer_df.alias(\"t\").join(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[40;106H\u001b(B\u001b[m\u001b[38;2;59;66;97"]
[37.037321, "o", "m\u001b[48;2;26;27;38m 4 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    source_df.alias(\"s\"),\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[44;145H\u001b[?25h"]
[37.052784, "o", "\u001b[?25l\u001b[39;120H\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m dim_customer_df.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.join\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b[40;128H(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b[41;116H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt.customer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m"]
[37.05298, "o", "\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.join_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b[42;113H\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38minner\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b[43;109H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.where\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b[44;113H(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt.is_current\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m True\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m & \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\b\u001b[?25h"]
[37.443956, "o", "\u001b[?25l\u001b[1;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m7\u001b[2;107H6\u001b[3;106H35\u001b[4;106H34\u001b[5;106H33\u001b[6;106H32\u001b[7;106H31\u001b[9;106H30\u001b[10;107H9\u001b[12;107H8\u001b[13;107H7\u001b[14;107H6\u001b[15;106H25\u001b[16;106H24\u001b[17;106H23\u001b[18;106H22\u001b[19;106H21\u001b[20;106H20\u001b[22;107H9\u001b[23;107H8\u001b[24;107H7\u001b[26;107H6\u001b[27;106H15\u001b[28;106H14\u001b[29;106H13\u001b[31;106H12\u001b[32;106H11\u001b[33;106H10\u001b[34;107H9\u001b[35;107H8\u001b[36;107H7\u001b[37;106H 6 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt.is_current\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m True\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m & \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(col(\"s.datetime_updated\") > col(\"t.  "]
[37.444012, "o", "        \u001b[38;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38mdatetime_updated\"))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[39;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 5 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m).select(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[40;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 4 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m    col(\"t.*\"),\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[41;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 3 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m    col(\"s.datetime_updated\").alias(\"s_datetime_updated\")\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[42;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 2 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[43;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[44;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m95 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m# Update t"]
[37.44413, "o", "he is_current and valid_to columns in dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[45;185H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m95:63\u001b[1;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m37 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[2;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m36 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Dynamically create schema for null values\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m handling all customer_df columns\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[3;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m35 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_schema \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customer_df.schema\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[4;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m34 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates_schema \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m StructType\u001b(B\u001b[m\u001b[38;2;169;"]
[37.444152, "o", "177;214m\u001b[48;2;26;27;38m([\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[5;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m33 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    StructField\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\",\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m StringType\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m()\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m True\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)]\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m+\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customer_schema.fields\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[6;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m32 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[7;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m31 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Create empty rows of data bas"]
[37.444165, "o", "ed on this schema\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m one row for each element in the\u001b[K\u001b[8;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mDF\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[9;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m30 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_row \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m Row\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m([\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mNone\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m]\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m len\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates_schema\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[10;106H\u001b(B\u001b[m\u001b[38;2;59;"]
[37.444211, "o", "66;97m\u001b[48;2;26;27;38m29 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_rows \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m spark.createDataFrame\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m([\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_row\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m]\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customers_with_updates.count\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m()\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m\u001b[K\u001b[11;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates_schema\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[12;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m28 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Drop join_key and then reorder\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[13;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m27 \u001b("]
[37.444297, "o", "B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_rows \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m empty_rows.drop\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[14;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m26 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_rows \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m empty_rows.select\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_df.columns\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[15;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m25 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Union all the dataframes together\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[16;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m24 \u001b(B"]
[37.444365, "o", "\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customers_with_updates.union\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_rows\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[17;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m23 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[18;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m22 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Create a null join_key column\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[19;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m21 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfrom pyspark.sql.functions import lit\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[20;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m20 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customers_with_updates.withColumn\u001b(B\u001b[m\u001b[3"]
[37.444397, "o", "8;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\",\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m lit\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mNone\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.\u001b[K\u001b[21;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcast\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mstring\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[22;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m19 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[23;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m18 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Union the two dataframes\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[24;106H\u001b(B\u001b[m\u001b[38;2;59;66;"]
[37.444525, "o", "97m\u001b[48;2;26;27;38m17 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38msource_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customer_df.unionByName\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m\u001b[K\u001b[25;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mallowMissingColumns\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2"]
[37.444583, "o", ";26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[26;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m16 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[27;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m15 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# --- Perform the merge logic ---\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[28;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m14 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# 1. Update existing records\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[29;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m13 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Condition: MATCHED AND is_current \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m true AND s.datetime_updated \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m t.\u001b[K\u001b[30;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;24"]
[37.44464, "o", "5m\u001b[48;2;26;27;38m\u001b[K\u001b[31;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m12 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Action: UPDATE SET is_current \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m false\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m valid_to \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m s.datetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[32;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m11 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mupdated_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m dim_customer_df.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.join\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[3"]
[37.444696, "o", "3;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m10 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    source_df.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[34;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 9 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt.customer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.join_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;2"]
[37.44475, "o", "7;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[35;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 8 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38minner\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[36;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 7 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.where\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[37;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 6 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt.is_current\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;2"]
[37.444807, "o", "7;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m True\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m & \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(col(\"s.datetime_updated\") > col(\"t.\u001b[K\u001b[44;171H\u001b[?25h"]
[37.449547, "o", "\u001b[?25l\u001b[37;146H\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt.          \u001b[38;113Hdatetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b[39;110H\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.select\u001b[40;109H    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt.\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b[41;109H\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;"]
[37.449568, "o", "2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms_datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b[44;109H\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Update the is_current and valid_to columns in dim_customer_df\b\u001b[?25h"]
[37.866683, "o", "\u001b[?25l\u001b[1;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m6 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b[2;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m5 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Create empty rows of data based on this schema\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m one row for each element in the \u001b[3;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mDF\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[34X\u001b[4;109H\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_row \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m Row\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m([\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mNone\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m]\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m len\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b["]
[37.866812, "o", "38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates_schema\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)))\u001b[5;109H\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_rows \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m spark.createDataFrame\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m([\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_row\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m]\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customers_with_updates.count\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m()\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m  \u001b[6;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates_schema\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b[7;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m2 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Drop join_key and then reorder\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[8;106H\u001b(B"]
[37.867204, "o", "\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m31 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_rows \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m empty_rows.drop\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b[9;118H\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m empty_rows.select\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_df.columns\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[12X\u001b[10;109H\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Union all the dataframes together\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[11;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m28 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;2"]
[37.867287, "o", "6;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customers_with_updates.union\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_rows\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b[12;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m7 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[32X\u001b[13;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m6 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Create a null join_key column\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[9X\u001b[14;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m5 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfrom pyspark.sql.functions import lit\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[14X\u001b[15;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m4 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customers_with_updates.withColumn\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;"]
[37.86764, "o", "137;221;255m\u001b[48;2;26;27;38m\",\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m lit\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mNone\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m. \u001b[16;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcast\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mstring\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[50X\u001b[18;111H\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mUnion the two dataframes\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[5X\u001b[19;109H\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38msource_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customer_df.unionByName\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48"]
[37.867715, "o", ";2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m                       \u001b[20;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mallowMissingColumns\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[21;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m20 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[15X\n\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# --- Perform the merge logic ---\u001b[23;111H1. Update existing records\u001b[24;109H# Condition: MATCHED AND is_current \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m true AND s.datetime_updated \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m t.\u001b[25;109Hdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[9X\u001b[26;109H\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Action: UPDATE SET is_current \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;1"]
[37.868012, "o", "06m\u001b[48;2;26;27;38m false\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m valid_to \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m s.datetime_updated\u001b[27;109Hupdated_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m dim_customer_df.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.join\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b[28;109H\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    source_df.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m   \u001b[29;109H\u001b(B\u001b[m\u001b"]
[37.868082, "o", "[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt.customer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.join_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[30;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m12 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38minner\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[5X\u001b[31;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1 \u001b(B\u001b[m\u001b"]
[37.868388, "o", "[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.where\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[62X\u001b[32;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m0 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt.is_current\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m True\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m & \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.datetime_updated\u001b(B\u001b[m\u001b"]
[37.868463, "o", "[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt.          \u001b[33;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m  \u001b[34;109H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.select\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[37X\u001b[35;113H\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt.\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;2"]
[37.868761, "o", "7;38m*\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b[36;109H\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms_datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b[37;109H)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[38;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m5 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[23X\u001b[39;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m4 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Update the is_current and valid_to columns in dim_customer_df\u001b[40;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b"]
[37.868828, "o", "[48;2;26;27;38m3 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdef update_dim_customer(row):\u001b[41;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m2 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    if row.customer_id in updated_df.select(\"customer_id\").rdd.flatMap(lambda x:  \u001b[42;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mx).collect():\u001b[43;109H        row.is_current = False\u001b[44;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m9 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m        row.valid_to = row.s_datetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[18X\u001b[45;186H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m9:45\u001b[44;153H\u001b[?25h"]
[37.883584, "o", "\u001b[?25l\u001b[40;132H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mrow\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b[41;152H(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.rdd.flatMap\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b[42;114H)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.collect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m()\u001b[43;132H\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b[44;130H=\u001b[22C\u001b[?25h"]
[38.062291, "o", "\u001b[?25l\u001b[1;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 38 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_rows \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m empty_rows.drop\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b[2;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 37 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_rows \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m empty_rows.select\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_df.columns\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[3;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m36 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Union all the dataframes together\u001b[4;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 35 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26"]
[38.06265, "o", ";27;38mcustomers_with_updates \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customers_with_updates.union\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mempty_rows\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b[5;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 34 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[6;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m33 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Create a null join_key column\u001b[7;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 32 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfrom pyspark.sql.functions import lit\u001b[8;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 31 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customers_with_updates.withColumn\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38"]
[38.062734, "o", "m\",\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m lit\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mNone\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.\u001b[9;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcast\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mstring\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[35X\u001b[10;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 30 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[34X\u001b[11;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 29 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Union the two dataframes\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[38X\u001b[12;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 28 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38msource_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m c"]
[38.06303, "o", "ustomer_df.unionByName\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m                      \u001b[13;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mallowMissingColumns\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[5X\u001b[14;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 27 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[36X\u001b[15;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 26 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# --- Perform the merge logic ---\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[16;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m25 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# 1. Update existing records\u001b[17;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 24 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Condition: MATCHED AND is_cu"]
[38.063098, "o", "rrent \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m true AND s.datetime_updated \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m t.           \u001b[18;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[9X\u001b[19;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 23 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Action: UPDATE SET is_current \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m false\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m valid_to \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m s.datetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[20;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m22 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mupdated_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m dim_customer_df.ali"]
[38.063372, "o", "as\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.join\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b[21;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 21 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    source_df.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b[22;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 20 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt.customer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38"]
[38.063545, "o", "m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.join_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b[23;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 19 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38minner\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[16X\u001b[24;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 18 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.where\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[25;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m17 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;"]
[38.063622, "o", "38mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt.is_current\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m True\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m & \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt.         \u001b[2"]
[38.063859, "o", "6;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[46X\u001b[27;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 16 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.select\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[35X\u001b[28;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 15 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt.\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[9X\u001b[29;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 14 \u001b(B\u001b[m\u001b[38;2;158;206;106m"]
[38.063926, "o", "\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms_datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b[30;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 13 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[9X\u001b[31;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 12 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[7X\u001b[32;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 11 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Update the is_current and valid_to columns in dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[33;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m10 \u001b(B\u001b[m\u001b[38;2;158;"]
[38.064134, "o", "206;106m\u001b[48;2;26;27;38mdef update_dim_customer\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mrow\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m:\u001b[34;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 9 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    if row.customer_id in updated_df.select\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.rdd.flatMap\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mlambda x: \u001b[35;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mx\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.collect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m()\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;2"]
[38.064272, "o", "7;38m:\u001b[36;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 8 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m        row.is_current \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m False\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[26X\u001b[37;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 7 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m        row.valid_to \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m row.s_datetime_updated\u001b[38;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;2"]
[38.064483, "o", "6;27;38m 6 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    return row\u001b[39;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 5 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[62X\u001b[40;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 4 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Convert the DataFrame to an RDD and update the rows\u001b[41;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 3 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mupdated_rdd = dim_customer_df.rdd.map(update_dim_customer)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[42;108H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m2 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[16X\u001b[43;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 1 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Convert the RDD back to a DataFrame\u001b[44;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m106 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mupdated_dim_customer_df = spark.createDataFrame(updated_\n\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;59;66;97m \u001b[45;168H codecompanion \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m 106:56\u001b[44;165H\u001b[?25h"]
[38.082365, "o", "\u001b[?25l\u001b[41;122H\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m dim_customer_df.rdd.map\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mupdate_dim_customer\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b[44;134H\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m spark.createDataFrame\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b[7C\u001b[?25h"]
[38.370659, "o", "\u001b[?25l\u001b[1;108H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m6\u001b[3;108H5\u001b[4;107H34\u001b[5;107H33\u001b[7;107H32\u001b[8;107H31\u001b[9;107H30\u001b[10;108H9\u001b[12;108H8\u001b[13;108H7\u001b[14;108H6\u001b[15;108H5\u001b[16;107H24\u001b[17;107H23\u001b[18;107H22\u001b[20;107H21\u001b[21;107H20\u001b[22;108H9\u001b[23;108H8\u001b[24;108H7\u001b[25;108H6\u001b[26;108H5\u001b[27;107H14\u001b[29;107H13\u001b[30;107H12\u001b[31;107H11\u001b[32;107H10\u001b[33;108H9\u001b[34;108H8\u001b[35;108H7\u001b[36;108H6\u001b[37;106H  5 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mupdated_dim_customer_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m spark.createDataFrame\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mupdated_rdd, dim_customer_df.    \u001b[38;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mschema)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[39;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  4 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[40;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  3 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# 2. Insert new records\u001b(B\u001b[m\u001b[38"]
[38.37106, "o", ";2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[41;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Condition: NOT MATCHED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[42;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Action: INSERT (customer_id,email,first_name,datetime_updated,valid_from,      \u001b[43;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mis_current,is_active)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[44;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m111 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mnew_customers_df = source_\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[45;185H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m11:2\u001b[1;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 36 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customers_with_updates.withColumn\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b["]
[38.371377, "o", "38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mjoin_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\",\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m lit\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mNone\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.\u001b[2;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcast\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mstring\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[3;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 35 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[4;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 34 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Union the two dataframes\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[5;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 33 \u001b(B\u001b[m\u001b[38;2;158;206;1"]
[38.371668, "o", "06m\u001b[48;2;26;27;38msource_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m customer_df.unionByName\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m\u001b[K\u001b[6;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mallowMissingColumns\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[7;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 32 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[8;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 31 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# --- Perform the merge logic ---\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[9;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 30 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# 1. Update existing records\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;2"]
[38.371934, "o", "6;27;38m\u001b[K\u001b[10;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 29 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Condition: MATCHED AND is_current \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m true AND s.datetime_updated \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m t.\u001b[K\u001b[11;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[12;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 28 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Action: UPDATE SET is_current \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m false\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m valid_to \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m s.datetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[13;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 27 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;"]
[38.372213, "o", "2;26;27;38mupdated_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m dim_customer_df.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.join\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[14;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 26 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    source_df.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[15;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 25 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b"]
[38.372518, "o", "[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt.customer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.join_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[16;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 24 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38minner\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[17;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 23 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.where\u001b(B\u001b[m"]
[38.372785, "o", "\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[18;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 22 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt.is_current\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m True\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m & \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;"]
[38.373036, "o", "2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt.\u001b[K\u001b[19;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[20;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 21 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.select\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[21;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 20 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt.\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m*\u001b"]
[38.373286, "o", "(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[22;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 19 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms_datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[23;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 18 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[24;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 17 \u001b(B\u001b[m\u001b[38;2;192;202;24"]
[38.373567, "o", "5m\u001b[48;2;26;27;38m\u001b[K\u001b[25;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 16 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Update the is_current and valid_to columns in dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[26;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 15 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdef update_dim_customer\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mrow\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[27;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 14 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    if row.customer_id in updated_df.select\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.rdd.flatMap\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m"]
[38.373814, "o", "\u001b[48;2;26;27;38mlambda x:\u001b[K\u001b[28;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mx\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.collect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m()\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[29;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 13 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m        row.is_current \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m False\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[30;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 12 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m        row.valid_to \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m row.s_datetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[31;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 11 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    return row\u001b(B\u001b[m\u001b[38;2;192;202;"]
[38.374062, "o", "245m\u001b[48;2;26;27;38m\u001b[K\u001b[32;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 10 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[33;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  9 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Convert the DataFrame to an RDD and update the rows\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[34;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  8 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mupdated_rdd \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m dim_customer_df.rdd.map\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mupdate_dim_customer\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[35;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  7 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[36;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  6 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Convert the RDD back to a DataFrame\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[37;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  5"]
[38.374308, "o", " \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mupdated_dim_customer_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m spark.createDataFrame\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mupdated_rdd, dim_customer_df.\u001b[K\u001b[44;135H\u001b[?25h"]
[38.38579, "o", "\u001b[?25l\u001b[37;169H\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b[38;116H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b[42;127H(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38memail\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfirst_name\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mvalid_from\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,      \u001b[43;120H,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mis_active\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b[44;127H\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b[7C\u001b[?25h"]
[38.673517, "o", "\u001b[?25l\u001b[1;108H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m7\u001b[2;108H6\u001b[3;108H5\u001b[4;107H34\u001b[6;107H33\u001b[7;107H32\u001b[8;107H31\u001b[9;107H30\u001b[10;108H9\u001b[11;108H8\u001b[12;108H7\u001b[14;108H6\u001b[15;108H5\u001b[16;107H24\u001b[17;107H23\u001b[18;107H22\u001b[19;107H21\u001b[20;107H20\u001b[21;108H9\u001b[23;108H8\u001b[24;108H7\u001b[25;108H6\u001b[26;108H5\u001b[27;107H14\u001b[28;107H13\u001b[29;107H12\u001b[30;107H11\u001b[31;107H10\u001b[33;108H9\u001b[34;108H8\u001b[35;108H7\u001b[36;108H6\u001b[38;106H  5 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mnew_customers_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m source_df.alias(\"s\").join(\u001b[39;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  4 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    dim_customer_df.alias(\"t\"),\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[40;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  3 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col(\"s.join_key\") == col(\"t.customer_id\"),\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[41;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \"left_anti\"  # equivalent t"]
[38.673903, "o", "o NOT MATCHED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[42;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m).select(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[43;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m116 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col(\"s.customer_id\"),\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[44;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~\u001b[K\u001b[45;186H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m6:25\u001b[1;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 37 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[2;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 36 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# --- Perform the merge logic ---\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[3;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 35 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# 1. Update existing records\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[4;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 34 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Condition: MATCHED AND is_current \u001b"]
[38.674188, "o", "(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m true AND s.datetime_updated \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m t.\u001b[K\u001b[5;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[6;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 33 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Action: UPDATE SET is_current \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m false\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m valid_to \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m s.datetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[7;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 32 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mupdated_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m dim_customer_df.alias\u001b(B\u001b[m\u001b[38;2;169"]
[38.674513, "o", ";177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.join\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[8;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 31 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    source_df.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[9;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 30 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt.customer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;1"]
[38.674785, "o", "69;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.join_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[10;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 29 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38minner\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[11;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 28 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.where\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[12;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 27 \u001b(B\u001b[m\u001b[38;2;1"]
[38.675061, "o", "58;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt.is_current\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m True\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m & \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[4"]
[38.675371, "o", "8;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt.\u001b[K\u001b[13;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[14;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 26 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.select\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[15;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 25 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt.\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202"]
[38.675508, "o", ";245m\u001b[48;2;26;27;38m\u001b[K\u001b[16;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 24 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms_datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[17;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 23 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[18;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 22 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[19;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 21 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Update the is_current and vali"]
[38.675851, "o", "d_to columns in dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[20;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 20 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdef update_dim_customer\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mrow\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[21;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 19 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    if row.customer_id in updated_df.select\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.rdd.flatMap\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mlambda x:\u001b[K\u001b[22;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;"]
[38.676105, "o", "106m\u001b[48;2;26;27;38mx\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.collect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m()\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[23;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 18 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m        row.is_current \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m False\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[24;106H\u001b(B\u001b[m\u001b[38;2;5"]
[38.676379, "o", "9;66;97m\u001b[48;2;26;27;38m 17 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m        row.valid_to \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m row.s_datetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[25;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 16 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    return row\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[26;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 15 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[27;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 14 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Convert the DataFrame to an RDD and update the rows\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[28;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 13 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mupdated_rdd \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m dim_customer_df.rdd.map\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mupdate_dim_customer\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27"]
[38.676666, "o", ";38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[29;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 12 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[30;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 11 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Convert the RDD back to a DataFrame\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[31;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 10 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mupdated_dim_customer_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m spark.createDataFrame\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mupdated_rdd\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m dim_customer_df.\u001b[K\u001b[32;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mschema\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[33;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  9 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[34;106H\u001b"]
[38.676913, "o", "(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  8 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# 2. Insert new records\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[35;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  7 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Condition: NOT MATCHED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[36;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  6 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Action: INSERT \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38memail\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfirst_name\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mvalid_from\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b[K\u001b[37;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mis"]
[38.677158, "o", "_current\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mis_active\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[38;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  5 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mnew_customers_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m source_df.alias(\"s\").join(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[43;134H\u001b[?25h"]
[38.690167, "o", "\u001b[?25l\u001b[38;144H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.join\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b[39;135H(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b[40;117H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.join_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt.custom"]
[38.690195, "o", "er_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b[41;114H\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mleft_anti\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b[42;110H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.select\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b[43;117H(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.customer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\b\u001b[?25h"]
[38.959321, "o", "\u001b[?25l\u001b[1;108H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m9\u001b[2;108H8\u001b[3;108H7\u001b[4;108H6\u001b[5;107H35\u001b[6;107H34\u001b[7;107H33\u001b[9;107H32\u001b[10;107H31\u001b[11;107H30\u001b[12;108H9\u001b[13;108H8\u001b[14;108H7\u001b[15;108H6\u001b[16;107H25\u001b[18;107H24\u001b[19;107H23\u001b[20;107H22\u001b[21;107H21\u001b[22;107H20\u001b[23;108H9\u001b[24;108H8\u001b[25;108H7\u001b[26;108H6\u001b[28;107H15\u001b[29;107H14\u001b[30;107H13\u001b[31;107H12\u001b[33;107H11\u001b[34;107H10\u001b[35;108H9\u001b[36;108H8\u001b[37;108H7\u001b[38;106H  \u001b[39;106H  5 \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m    col(\"s.email\"),\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[40;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  4 \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m    col(\"s.first_name\"),\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[41;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  3 \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m    col(\"s.datetime_updated\"),\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[42;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m    col(\"s.datetime_updated\").alias(\"valid_from\"),\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K"]
[38.959468, "o", "\u001b[43;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m    lit(True).alias(\"is_current\"),\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[44;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m122 \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m    lit(True).alias(\"is\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[45;185H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m22:23\u001b[1;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 39 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Action: UPDATE SET is_current \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m false\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m valid_to \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m s.datetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[2;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 38 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mupdated_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m "]
[38.959557, "o", "dim_customer_df.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.join\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[3;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 37 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    source_df.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[4;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 36 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt.customer_id\u001b(B\u001b[m\u001b[38;2;137;22"]
[38.959637, "o", "1;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.join_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[5;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 35 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38minner\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[6;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 34 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.where\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[7;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m"]
[38.959708, "o", "\u001b[48;2;26;27;38m 33 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt.is_current\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m True\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m & \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;3"]
[38.959786, "o", "8m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt.\u001b[K\u001b[8;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[9;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 32 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.select\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[10;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 31 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt.\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;"]
[38.959877, "o", "2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[11;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 30 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms_datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[12;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 29 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[13;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 28 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[14;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 27 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m"]
[38.959957, "o", "# Update the is_current and valid_to columns in dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[15;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 26 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdef update_dim_customer\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mrow\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[16;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 25 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    if row.customer_id in updated_df.select\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.rdd.flatMap\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mlambda x:\u001b[K\u001b[17;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26"]
[38.960029, "o", ";27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mx\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.collect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m()\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[18;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 24 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m        row.is_current \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m False\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[19;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 23 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m        row.valid_to \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m row.s_datetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[20;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 22 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    return row\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[21;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 21 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;3"]
[38.960101, "o", "8m\u001b[K\u001b[22;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 20 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Convert the DataFrame to an RDD and update the rows\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[23;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 19 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mupdated_rdd \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m dim_customer_df.rdd.map\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mupdate_dim_customer\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[24;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 18 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[25;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 17 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Convert the RDD back to a DataFrame\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[26;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 16 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mupdated_dim_customer_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b["]
[38.960173, "o", "m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m spark.createDataFrame\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mupdated_rdd\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m dim_customer_df.\u001b[K\u001b[27;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mschema\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[28;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 15 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[29;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 14 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# 2. Insert new records\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[30;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 13 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Condition: NOT MATCHED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[31;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 12 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Action: INSERT \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206"]
[38.960246, "o", ";106m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38memail\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfirst_name\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mvalid_from\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b[K\u001b[32;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;"]
[38.960321, "o", "2;158;206;106m\u001b[48;2;26;27;38mis_current\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mis_active\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[33;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 11 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mnew_customers_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m source_df.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.join\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[34;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 10 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    dim_customer_df.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;"]
[38.960404, "o", "137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[35;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  9 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.join_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt.customer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[36;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  8 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;13"]
[38.960482, "o", "7;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mleft_anti\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m  # equivalent to NOT MATCHED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[37;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  7 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.select\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[38;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  6 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.customer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[39;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  5 \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m    col(\"s.email\"),\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b["]
[38.960554, "o", "44;132H\u001b[?25h"]
[38.963688, "o", "\u001b[?25l\u001b[39;110H\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.email\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b[40;110H\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.first_name\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b[41;110H\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b[42;110H\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms"]
[38.963762, "o", ".datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mvalid_from\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b[43;110H\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    lit\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mis_current\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b[44;110H\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    lit\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;20"]
[38.963799, "o", "6;106m\u001b[48;2;26;27;38m.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mis\b\u001b[?25h"]
[39.289578, "o", "\u001b[?25l\u001b[1;108H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m9\u001b[2;108H8\u001b[3;108H7\u001b[4;107H36\u001b[5;107H35\u001b[6;107H34\u001b[7;107H33\u001b[8;107H32\u001b[10;107H31\u001b[11;107H30\u001b[12;108H9\u001b[13;108H8\u001b[14;108H7\u001b[15;107H26\u001b[16;107H25\u001b[17;107H24\u001b[18;107H23\u001b[20;107H22\u001b[21;107H21\u001b[22;107H20\u001b[23;108H9\u001b[25;108H8\u001b[26;108H7\u001b[27;107H16\u001b[28;107H15\u001b[29;107H14\u001b[30;107H13\u001b[31;107H12\u001b[32;107H11\u001b[33;107H10\u001b[34;108H9\u001b[35;108H8\u001b[36;106H  7 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    lit\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mis_active\")\u001b[37;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  6 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[38;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  5 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[39;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;2"]
[39.289962, "o", "7;38m  4 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Insert the new records into dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[40;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  3 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfinal_dim_customer_df = updated_dim_customer_df.unionByName(new_customers_df)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[41;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[42;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# 3. Update inactive records (Not Matched By Source)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[43;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m129 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m#Condition: NOT MATCHED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[44;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~\u001b[K\u001b[45;186H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m9\u001b[1;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 39 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;2"]
[39.290231, "o", "6;27;38m.select\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[2;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 38 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt.\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[3;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 37 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2"]
[39.290522, "o", ";26;27;38ms_datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[4;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 36 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[5;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 35 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[6;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 34 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Update the is_current and valid_to columns in dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[7;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 33 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdef update_dim_customer\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mrow\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[8;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 32 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    if row.customer_i"]
[39.290797, "o", "d in updated_df.select\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.rdd.flatMap\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mlambda x:\u001b[K\u001b[9;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mx\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.collect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m()\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[10;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 31 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m        row.is_current \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m False\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[11;106H\u001b(B\u001b[m\u001b[38;2;59;66;9"]
[39.291059, "o", "7m\u001b[48;2;26;27;38m 30 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m        row.valid_to \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m row.s_datetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[12;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 29 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    return row\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[13;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 28 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[14;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 27 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Convert the DataFrame to an RDD and update the rows\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[15;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 26 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mupdated_rdd \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m dim_customer_df.rdd.map\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mupdate_dim_customer\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b"]
[39.291294, "o", "(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[16;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 25 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[17;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 24 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Convert the RDD back to a DataFrame\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[18;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 23 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mupdated_dim_customer_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m spark.createDataFrame\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mupdated_rdd\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m dim_customer_df.\u001b[K\u001b[19;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mschema\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[20;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 22 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[21;106H\u001b(B\u001b[m\u001b"]
[39.291569, "o", "[38;2;59;66;97m\u001b[48;2;26;27;38m 21 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# 2. Insert new records\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[22;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 20 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Condition: NOT MATCHED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[23;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 19 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Action: INSERT \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38memail\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfirst_name\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mvalid_from\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b[K\u001b[24;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mis_curre"]
[39.291818, "o", "nt\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mis_active\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[25;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 18 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mnew_customers_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m source_df.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.join\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[26;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 17 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    dim_customer_df.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[3"]
[39.292069, "o", "8;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[27;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 16 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.join_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt.customer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[28;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 15 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;"]
[39.292318, "o", "2;158;206;106m\u001b[48;2;26;27;38mleft_anti\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m  # equivalent to NOT MATCHED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[29;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 14 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.select\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[30;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 13 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.customer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[31;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 12 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2"]
[39.292595, "o", ";158;206;106m\u001b[48;2;26;27;38ms.email\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[32;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 11 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.first_name\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[33;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 10 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K"]
[39.292842, "o", "\u001b[34;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  9 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mvalid_from\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[35;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  8 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    lit\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48"]
[39.293135, "o", ";2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mis_current\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[36;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  7 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    lit\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mis_active\")\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[43;132H\u001b[?25h"]
[39.308477, "o", "\u001b[?25l\u001b[36;140H\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b[37;110H)\u001b[40;132H\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m updated_dim_customer_df.unionByName\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mnew_customers_df\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b[42;139H(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mNot Matched By Source\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b[43;132H\u001b[?25h"]
[39.797657, "o", "\u001b[?25l\u001b[1;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m40\u001b[2;108H9\u001b[3;108H8\u001b[5;108H7\u001b[6;108H6\u001b[7;107H35\u001b[8;107H34\u001b[9;107H33\u001b[10;107H32\u001b[11;107H31\u001b[12;107H30\u001b[13;108H9\u001b[15;108H8\u001b[16;108H7\u001b[17;108H6\u001b[18;107H25\u001b[20;107H24\u001b[21;107H23\u001b[22;107H22\u001b[23;107H21\u001b[24;107H20\u001b[25;108H9\u001b[26;108H8\u001b[27;108H7\u001b[28;108H6\u001b[29;107H15\u001b[30;107H14\u001b[31;107H13\u001b[32;107H12\u001b[33;107H11\u001b[34;107H10\u001b[35;108H9\u001b[36;108H8\u001b[37;108H7\u001b[38;106H  6 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m#Condition: NOT MATCHED BY SOURCE\u001b[39;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  5 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m#Action: UPDATE SET is_active = false\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[40;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  4 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[41;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  3 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m#Find which customer_id's are not present in source dataframe.\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[42;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[38;2;158;206;106m"]
[39.797834, "o", "\u001b[48;2;26;27;38mcustomer_ids_in_source = source_df.select(\"customer_id\").distinct()\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[43;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[44;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m135 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38minactive_customers_df = final_dim_customer_df.alias\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[45;185H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m35:51\u001b[1;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 40 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Update the is_current and valid_to columns in dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[2;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 39 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdef update_dim_customer\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mrow\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[3;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b"]
[39.797879, "o", "[48;2;26;27;38m 38 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    if row.customer_id in updated_df.select\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.rdd.flatMap\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mlambda x:\u001b[K\u001b[4;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mx\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.collect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m()\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[5;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 37 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m        row.is_current \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38"]
[39.798004, "o", "m False\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[6;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 36 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m        row.valid_to \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m row.s_datetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[7;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 35 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    return row\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[8;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 34 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[9;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 33 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Convert the DataFrame to an RDD and update the rows\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[10;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 32 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mupdated_rdd \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m dim_customer_df.rdd.map\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b["]
[39.798036, "o", "48;2;26;27;38mupdate_dim_customer\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[11;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 31 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[12;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 30 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Convert the RDD back to a DataFrame\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[13;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 29 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mupdated_dim_customer_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m spark.createDataFrame\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mupdated_rdd\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m dim_customer_df.\u001b[K\u001b[14;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mschema\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[15;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48"]
[39.798053, "o", ";2;26;27;38m 28 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[16;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 27 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# 2. Insert new records\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[17;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 26 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Condition: NOT MATCHED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[18;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 25 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Action: INSERT \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38memail\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfirst_name\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mvalid_from\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b[K\u001b[19;106H\u001b(B\u001b[m\u001b[38;2;59"]
[39.798078, "o", ";66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mis_current\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mis_active\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[20;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 24 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mnew_customers_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m source_df.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.join\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[21;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 23 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    dim_customer_df.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;"]
[39.798223, "o", "206;106m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[22;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 22 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.join_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt.customer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[23;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 21 \u001b(B\u001b[m\u001b[38;2;158;206;1"]
[39.798304, "o", "06m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mleft_anti\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m  # equivalent to NOT MATCHED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[24;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 20 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.select\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[25;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 19 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.customer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[26;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 18 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177"]
[39.79839, "o", ";214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.email\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[27;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 17 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.firs"]
[39.79848, "o", "t_name\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[28;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 16 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[29;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 15 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;"]
[39.798573, "o", "255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mvalid_from\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[30;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 14 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    lit\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mis_current\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[31;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 13 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    lit\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mTrue\u001b(B\u001b[m\u001b[38;2;169"]
[39.798653, "o", ";177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mis_active\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[32;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 12 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[33;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 11 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[34;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 10 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Insert the new records into dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[35;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  9 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfinal_dim_customer_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m updated_dim_customer_df.unionByName\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b"]
[39.798732, "o", "(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mnew_customers_df\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[36;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  8 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[37;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  7 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# 3. Update inactive records \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mNot Matched By Source\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[38;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  6 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m#Condition: NOT MATCHED BY SOURCE\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[39;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  5 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m#Action: UPDATE SET is_active = false\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[44;160H\u001b[?25h"]
[39.802805, "o", "\u001b[?25l\u001b[39;140H\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b[41;133H'\u001b[42;133H=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m source_df.select\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.distinct\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m()\u001b[44;132H\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b[27C\u001b[?25h"]
[40.005686, "o", "\u001b[?25l\u001b[1;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m41\u001b[2;107H40\u001b[3;108H9\u001b[4;108H8\u001b[5;108H7\u001b[6;108H6\u001b[7;107H35\u001b[9;107H34\u001b[10;107H33\u001b[11;107H32\u001b[12;107H31\u001b[14;107H30\u001b[15;108H9\u001b[16;108H8\u001b[17;108H7\u001b[18;108H6\u001b[19;107H25\u001b[20;107H24\u001b[21;107H23\u001b[22;107H22\u001b[23;107H21\u001b[24;107H20\u001b[25;108H9\u001b[26;108H8\u001b[27;108H7\u001b[28;108H6\u001b[29;107H15\u001b[30;107H14\u001b[31;107H13\u001b[32;107H12\u001b[33;107H11\u001b[34;107H10\u001b[35;108H9\u001b[36;108H8\u001b[37;108H7\u001b[38;106H  6 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38minactive_customers_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m final_dim_customer_df.alias(\"t\").join(\u001b[39;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  5 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    customer_ids_in_source.alias(\"s\"),\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[40;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  4 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col(\"t.customer_id\") == col(\"s.customer_id\"),\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[41;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  3 \u001b(B\u001b[m\u001b[38"]
[40.006093, "o", ";2;158;206;106m\u001b[48;2;26;27;38m    \"left_anti\"\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[42;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m).select(\"t.*\")\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[43;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[44;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m141 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m#Update the is_active column in dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[45;185H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m41:47\u001b[1;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 41 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    return row\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[2;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 40 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[3;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 39 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Convert the DataFrame to an RDD and update the rows\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[4;106H\u001b(B\u001b[m\u001b["]
[40.006403, "o", "38;2;59;66;97m\u001b[48;2;26;27;38m 38 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mupdated_rdd \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m dim_customer_df.rdd.map\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mupdate_dim_customer\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[5;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 37 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[6;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 36 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Convert the RDD back to a DataFrame\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[7;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 35 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mupdated_dim_customer_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m spark.createDataFrame\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mupdated_rdd\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206"]
[40.006692, "o", ";106m\u001b[48;2;26;27;38m dim_customer_df.\u001b[K\u001b[8;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mschema\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[9;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 34 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[10;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 33 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# 2. Insert new records\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[11;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 32 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Condition: NOT MATCHED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[12;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 31 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Action: INSERT \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38memail\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfirst_name\u001b(B"]
[40.006972, "o", "\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mvalid_from\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b[K\u001b[13;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mis_current\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mis_active\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[14;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 30 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mnew_customers_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m source_df.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.join\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b"]
[40.007214, "o", "[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[15;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 29 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    dim_customer_df.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[16;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 28 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.join_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;3"]
[40.00749, "o", "8mt.customer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[17;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 27 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mleft_anti\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m  # equivalent to NOT MATCHED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[18;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 26 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.select\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[19;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 25 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.customer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2"]
[40.007746, "o", ";26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[20;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 24 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.email\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[21;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 23 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.first_name\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[22;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 22 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b["]
[40.008029, "o", "48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[23;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 21 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mvalid_from\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[24;106H\u001b(B"]
[40.008279, "o", "\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 20 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    lit\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mis_current\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[25;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 19 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    lit\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mis_active\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b["]
[40.008563, "o", "m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[26;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 18 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[27;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 17 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[28;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 16 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Insert the new records into dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[29;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 15 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfinal_dim_customer_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m updated_dim_customer_df.unionByName\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mnew_customers_df\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[30;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 14 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[31;106H\u001b(B\u001b[m\u001b["]
[40.008813, "o", "38;2;59;66;97m\u001b[48;2;26;27;38m 13 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# 3. Update inactive records \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mNot Matched By Source\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[32;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 12 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m#Condition: NOT MATCHED BY SOURCE\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[33;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 11 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m#Action: UPDATE SET is_active \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m false\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[34;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 10 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[35;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  9 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m#Find which customer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms are not pre"]
[40.009063, "o", "sent in source dataframe.\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[36;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  8 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_ids_in_source \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m source_df.select\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.distinct\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m()\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[37;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  7 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[38;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  6 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38minactive_customers_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m final_dim_customer_df.alias(\"t\").join(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[44;156"]
[40.009307, "o", "H\u001b[?25h"]
[40.028358, "o", "\u001b[?25l\u001b[38;161H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.join\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b[39;142H(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b[40;117H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt.customer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.cus"]
[40.028605, "o", "tomer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b[41;114H\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mleft_anti\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b[42;110H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.select\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt.\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b[44;156H\u001b[?25h"]
[40.31599, "o", "\u001b[?25l\u001b[1;108H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m0 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[14X\u001b[2;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m39 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# 2. Insert new records\u001b[3;108H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m8 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Condition: NOT MATCHED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[29X\u001b[4;108H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m7 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Action: INSERT \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38memail\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfirst_name\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdatetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mvalid_from\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,      \u001b[5;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b"]
[40.316471, "o", "[48;2;26;27;38m   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mis_current\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mis_active\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b[6;110H\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mnew_customers_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m source_df.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.join\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b[7;110H\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    dim_customer_df.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;"]
[40.316811, "o", "26;27;38m\u001b[K\u001b[8;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m34 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.join_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt.customer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b[9;108H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m3 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mleft_anti\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m  # equivalent to NOT MATCHED\u001b[10;"]
[40.317132, "o", "108H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m2 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.select\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[14X\u001b[11;108H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.customer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b[12;108H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m0 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.email\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[13;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;2"]
[40.317414, "o", "7;38m29 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.first_name\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b[14;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m28 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[15X\u001b[15;108H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m7 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.datetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38"]
[40.317676, "o", ";2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mvalid_from\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b[16;108H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m6 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    lit\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mis_current\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[12X\u001b[17;108H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m5 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    lit\u001b(B\u001b[m\u001b"]
[40.317893, "o", "[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mis_active\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[12X\u001b[18;108H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m4 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[8X\u001b[19;108H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m3 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[25X\u001b[20;108H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m2 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Insert the new records into dim_customer_df\u001b[21;108H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfinal_dim_customer_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m updated_dim_customer_df.union"]
[40.318096, "o", "ByName\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mnew_customers_df\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b[22;108H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m0 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[30X\u001b[23;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m19 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# 3. Update inactive records \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mNot Matched By Source\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b[24;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m18 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m#Condition: NOT MATCHED BY SOURCE\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b[25;108H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m7 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m#Action: UPDATE SET is_active \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m false\u001b[26;108H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m6 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b[27;108H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m5 \u001b"]
[40.31827, "o", "(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m#Find which customer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms are not present in source dataframe.\u001b[28;108H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m4 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_ids_in_source \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m source_df.select\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.distinct\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m()\u001b[29;108H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m3 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[77X\u001b[30;108H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m2 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38minactive_customers_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m final_dim_customer_df.a"]
[40.318516, "o", "lias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.join\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b[31;108H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    customer_ids_in_source.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b"]
[40.318709, "o", "[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[14X\u001b[32;108H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m0 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt.customer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.customer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b[33;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 9 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m"]
[40.3189, "o", "\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mleft_anti\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[22X\u001b[34;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 8 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.select\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt.\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b[35;108H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m7 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[62X\u001b[36;108H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m6 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m#Update the is_active column in dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[20X\u001b[37;108H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m5 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdef update_inactive_customer(row):\u001b[38;108H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m4 \u001b(B\u001b[m\u001b"]
[40.319009, "o", "[38;2;158;206;106m\u001b[48;2;26;27;38m    if row.customer_id in inactive_customers_df.select(\"customer_id\").rdd.       \u001b[39;108H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mflatMap(lambda x: x).collect():\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m   \u001b[40;108H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m3 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m        row.is_active = False\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[20X\u001b[41;108H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m2 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    return row\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b[42;108H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[15X\u001b[43;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m147 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Convert the DataFrame to an R\u001b[44;106H\u001b(B\u001b[m\u001b[38;2;26;27;38m\u001b[48;2;26;27;38m~\u001b[K\u001b[45;186H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m7:31\u001b[43;140H\u001b[?25h"]
[40.33965, "o", "\u001b[?25l\u001b[37;138H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mrow\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b[38;164H(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b[39;121H(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mlambda x: x\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.collect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m()\u001b[40;132H\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b[43;140H\u001b[?25h"]
[40.924426, "o", "\u001b[?25l\u001b[1;107H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m41\u001b[2;107H40\u001b[3;107H39\u001b[4;107H38\u001b[5;107H37\u001b[6;107H36\u001b[7;107H35\u001b[8;107H34\u001b[9;107H33\u001b[10;107H32\u001b[11;107H31\u001b[12;107H30\u001b[13;107H29\u001b[14;107H28\u001b[15;107H27\u001b[16;107H26\u001b[17;107H25\u001b[18;107H24\u001b[19;107H23\u001b[20;107H22\u001b[21;107H21\u001b[22;107H20\u001b[23;107H19\u001b[25;107H18\u001b[26;107H17\u001b[27;107H16\u001b[28;106H 15 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Convert the DataFrame to an RDD and update the rows\u001b[29;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 14 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38minactive_rdd = final_dim_customer_df.rdd.map(update_inactive_customer)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[30;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 13 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[31;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 12 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Convert the RDD back to a DataFrame\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[32;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 11 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38minactive_dim_customer_df = spa"]
[40.924594, "o", "rk.createDataFrame(inactive_rdd,                   \u001b[33;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfinal_dim_customer_df.schema)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[34;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 10 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[35;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  9 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# --- Display the result (replace with your actual data writing logic) ---\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[36;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  8 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38minactive_dim_customer_df.show()\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[37;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  7 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[38;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  6 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Stop the SparkSession\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[39;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  5 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2"]
[40.924641, "o", ";26;27;38mspark.stop()\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[40;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  4 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m]]></code>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[41;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  3 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    </action>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[42;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m  </tool>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[43;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m</tools>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[44;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m162 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m```\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[45;185H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m62:3 \u001b[1;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 41 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    lit\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27"]
[40.924762, "o", ";38mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mis_current\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[2;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 40 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    lit\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mis_active\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[3;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 39 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;2"]
[40.924802, "o", "7;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[4;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 38 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[5;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 37 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Insert the new records into dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[6;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 36 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mfinal_dim_customer_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m updated_dim_customer_df.unionByName\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mnew_customers_df\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[7;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 35 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[8;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 34 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# 3. Update inactive records \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b["]
[40.924896, "o", "48;2;26;27;38mNot Matched By Source\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[9;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 33 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m#Condition: NOT MATCHED BY SOURCE\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[10;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 32 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m#Action: UPDATE SET is_active \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m false\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[11;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 31 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[12;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 30 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m#Find which customer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m'\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms are not present in source dataframe.\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[13;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 29 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_ids_"]
[40.924928, "o", "in_source \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m source_df.select\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.distinct\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m()\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[14;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 28 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[15;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 27 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38minactive_customers_df \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m final_dim_customer_df.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b["]
[40.924954, "o", "48;2;26;27;38m.join\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[16;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 26 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    customer_ids_in_source.alias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[17;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 25 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt.customer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m col\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m"]
[40.925061, "o", "\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38ms.customer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[18;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 24 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mleft_anti\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[19;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 23 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.select\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mt.\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[20;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 22 \u001b("]
[40.925092, "o", "B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[21;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 21 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m#Update the is_active column in dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[22;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 20 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mdef update_inactive_customer\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mrow\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[23;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 19 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    if row.customer_id in inactive_customers_df.select\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mcustomer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.rdd.\u001b[K\u001b[24;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   "]
[40.925116, "o", " \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mflatMap\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38mlambda x: x\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m.collect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m()\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[25;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 18 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m        row.is_active \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m False\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[26;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 17 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m    return row\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[27;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 16 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[28;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 15 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m# Convert the DataFrame to an RD"]
[40.925227, "o", "D and update the rows\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[29;106H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 14 \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38minactive_rdd = final_dim_customer_df.rdd.map(update_inactive_customer)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[44;112H\u001b[?25h"]
[40.973224, "o", "\u001b[?25l\u001b[H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 39 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[1;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.datetime_updated\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"valid_from\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                    \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 38 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[2;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mlit\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mTrue\u001b"]
[40.973269, "o", "(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"is_current\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                    \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 37 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[3;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mlit\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"is_active\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m         "]
[40.973426, "o", "                                             \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 36 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                     \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 35 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 34 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Insert the new records into dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                         \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 33 \u001b(B\u001b[m\u001b[38;2;1"]
[40.973458, "o", "92;202;245m\u001b[48;2;32;48;59mfinal_dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdated_dim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59munionByName\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mnew_customers_df\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m         \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 32 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 31 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# 3. Update inactive records (Not Matched By Source)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48"]
[40.973529, "o", ";2;32;48;59m                                  \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 30 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m#Condition: NOT MATCHED BY SOURCE\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                     \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 29 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m#Action: UPDATE SET is_active = false\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                 \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 28 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 27 \u001b(B\u001b[m\u001b[3m\u001b"]
[40.973587, "o", "[38;2;86;95;137m\u001b[48;2;32;48;59m#Find which customer_id's are not present in source dataframe.\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                        \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 26 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_ids_in_source\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msource_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mselect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mdistinct\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m()\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                   \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38"]
[40.973609, "o", "m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 25 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 24 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59minactive_customers_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mfinal_dim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"t\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mjoin\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                        \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b["]
[40.973627, "o", "48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 23 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[17;10H   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_ids_in_source\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 22 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[18;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"t.customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m==\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;122"]
[40.973644, "o", ";162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                     \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 21 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[19;10H   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"left_anti\"\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                       \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 20 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mselect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"t.*\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[3"]
[40.973729, "o", "8;2;192;202;245m\u001b[48;2;32;48;59m                                                                       \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 19 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 18 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;"]
[40.973761, "o", "2;32;48;59m#Update the is_active column in dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                       \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 17 \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mdef\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mupdate_inactive_customer\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                    \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 16 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;31;34;49m▎\u001b[24;10H   \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;57;75;112mif\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mrow\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;"]
[40.973826, "o", "112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mcustomer_id\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112minactive_customers_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112mselect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;57;75;112m\"customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mrdd\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112mflatMap\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;57;75;112mlamb\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;57;75;112m▎\u001b[25;10H   \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;57;75;112mda\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b"]
[40.973869, "o", "[38;2;224;175;104m\u001b[48;2;57;75;112mx\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mx\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112mcollect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m()\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                               \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 15 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[26;10H   ▎\u001b[26;14H   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mis_active\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mFalse\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32"]
[40.973905, "o", ";48;59m                                                         \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 14 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[27;10H   \u001b(B\u001b[m\u001b[3m\u001b[38;2;157;124;216m\u001b[48;2;32;48;59mreturn\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                        \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 13 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 12 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Convert the DataFrame to an RDD and update the rows\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                   "]
[40.973928, "o", "              \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 11 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59minactive_rdd\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mfinal_dim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mrdd\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mmap\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdate_inactive_customer\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 10 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \r\n\u001b(B\u001b[m\u001b[38;2"]
[40.97398, "o", ";86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  9 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Convert the RDD back to a DataFrame\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                 \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  8 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59minactive_dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mspark\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcreateDataFrame\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59minactive_rdd\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mfinal_dim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m."]
[40.974001, "o", "\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59ms\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mchema\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  7 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  6 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# --- Display the result (replace with your actual data writing logic) ---\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m            \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66"]
[40.97402, "o", ";97m\u001b[48;2;26;27;38m  5 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59minactive_dim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mshow\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m()\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                       \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  4 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  3 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Stop the SparkSession\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                               \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48"]
[40.974037, "o", ";59mspark\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mstop\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m()\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                          \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m--------------------------------------------------------------------------------------\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m--------------------------------------------------------------------------------------\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[0;1m\u001b["]
[40.974123, "o", "38;2;255;158;100m\u001b[48;2;26;27;38m131 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;41;46;66m                                                                                      \u001b[43A\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[2;95H│\u001b[3;95H│\u001b[4;95H│\u001b[5;95H│\u001b[6;95H│\u001b[7;95H│\u001b[8;95H│\u001b[9;95H│\u001b[10;95H│\u001b[11;95H│\u001b[12;95H│\u001b[13;95H│\u001b[14;95H│\u001b[15;95H│\u001b[16;95H│\u001b[17;95H│\u001b[18;95H│\u001b[19;95H│\u001b[20;95H│\u001b[21;95H│\u001b[22;95H│\u001b[23;95H│\u001b[24;95H│\u001b[25;95H│\u001b[26;95H│\u001b[27;95H│\u001b[28;95H│\u001b[29;95H│\u001b[30;95H│\u001b[31;95H│\u001b[32;95H│\u001b[33;95H│\u001b[34;95H│\u001b[35;95H│\u001b[36;95H│\u001b[37;95H│\u001b[38;95H│\u001b[39;95H│\u001b[40;95H│\u001b[41;95H│\u001b[42;95H│\u001b[43;95H│\u001b[44;95H│\u001b[45;1H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m N \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;59;66;97m \u001b[45;6H main \u001b[45;13H ~25 -95 \u001b[45;23H E113 󰰎\u001b[45;30H + \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;41;46;66m mergeinto/mergeinto.py[+]                  \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;59;66;97m \u001b[45;79H python \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;"]
[40.974144, "o", "162;247m 131:1  \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;22;22;30m \u001b[44A\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[2;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[3;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[4;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[5;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  "]
[40.974188, "o", "    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[6;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[7;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[8;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[9;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[10;96H\u001b(B\u001b"]
[40.974226, "o", "[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[11;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[12;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[13;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[14;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m------------------"]
[40.974262, "o", "---------------------------------------------------------------------\u001b[15;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[16;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[17;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[18;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[19;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m"]
[40.974296, "o", "\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[20;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[21;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[22;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[23;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m-----------------------------------------------------------------------------"]
[40.97433, "o", "----------\u001b[24;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    4 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m    \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;57;75;112mVALUES\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112ms\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mcustomer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112ms\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112memail\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112ms\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mfirst_name\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112ms\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdatetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192"]
[40.974373, "o", ";202;245m\u001b[48;2;57;75;112ms\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdatetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,  \u001b[25;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    true\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mtrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                                         \u001b[26;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[27;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[28;96H\u001b(B\u001b[m\u001b[38;2"]
[40.974406, "o", ";86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[29;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[30;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[31;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[32;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m--------------------------"]
[40.97444, "o", "-------------------------------------------------------------\u001b[33;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[34;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[35;96H\u001b"]
[40.974498, "o", "(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[36;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[37;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[38;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[39;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------"]
[40.974531, "o", "------------------------------------------------------------------------\u001b[40;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    3 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[41;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    2 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m    \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mWHEN\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mNOT\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mMATCHED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mBY\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mSOURCE\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m condition to \u001b(B\u001b[m\u001b[38;2;39;161;185m\u001b[48;2;32;48;59mset\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m deleted customers \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;5"]
[40.974563, "o", "9min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m dim_customer   \u001b[42;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m    to be \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59min-\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mactive                                                                    \u001b[43;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m    \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mTHEN\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mUPDATE\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mSET\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m is_active \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m false                                                  \u001b[44;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[0;1m\u001b[38;2;255;15"]
[40.974594, "o", "8;100m\u001b[48;2;26;27;38m26  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;41;46;66m                                                                                       \u001b[45;96H\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;22;22;30m[CodeCompanion] 3158846                                                                        \u001b[44;9H\u001b[?25h"]
[41.068414, "o", "\u001b[?25l\u001b[1;3H\u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b[2;3H+ \u001b[3;3H+ \u001b[4;3H+ \u001b[5;3H+ \u001b[6;3H+ \u001b[7;3H+ \u001b[8;3H+ \u001b[9;3H+ \u001b[10;3H+ \u001b[11;3H+ \u001b[12;3H+ \u001b[13;3H+ \u001b[14;3H+ \u001b[15;3H+ \u001b[16;3H+ \u001b[17;3H+ \u001b[18;3H+ \u001b[19;3H+ \u001b[20;3H+ \u001b[21;3H+ \u001b[22;3H+ \u001b[23;3H+ \u001b[24;3H+ \u001b[26;3H+ \u001b[27;3H+ \u001b[28;3H+ \u001b[29;3H+ \u001b[30;3H+ \u001b[31;3H+ \u001b[32;3H+ \u001b[33;3H+ \u001b[35;3H+ \u001b[36;3H+ \u001b[37;3H+ \u001b[38;3H+ \u001b[39;3H+ \u001b[40;3H+ \u001b[44;9H\u001b[?25h"]
[41.116294, "o", "\u001b[?25l\r\u001b[C\u001b[C\u001b(B\u001b[m\u001b[38;2;145;76;84m\u001b[48;2;26;27;38m_ \u001b[4C\u001b[?25h"]
[41.120724, "o", "\u001b[?25l\u001b[45;14H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;59;66;97m+127 -116 \u001b[45;25H E7 W9 󰰎\u001b[45;33H + \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;41;46;66m mergeinto/mergeinto.py[+]\u001b[44;9H\u001b[?25h"]
[41.827165, "o", "\u001b[?25l\u001b[46;180H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38mk\u001b[44;9H\u001b[?25h"]
[41.833911, "o", "\u001b[?25l\u001b[46;180H \u001b[1;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m8\u001b[2;7H7\u001b[3;7H6\u001b[4;7H5\u001b[5;7H4\u001b[6;7H3\u001b[7;7H2\u001b[8;7H1\u001b[9;7H0\u001b[10;6H29\u001b[11;7H8\u001b[12;7H7\u001b[13;7H6\u001b[14;7H5\u001b[15;7H4\u001b[16;7H3\u001b[17;7H2\u001b[18;7H1\u001b[19;7H0\u001b[20;6H19\u001b[21;7H8\u001b[22;7H7\u001b[23;7H6\u001b[24;7H5\u001b[26;7H4\u001b[27;7H3\u001b[28;7H2\u001b[29;7H1\u001b[30;7H0\u001b[31;6H 9\u001b[32;7H8\u001b[33;7H7\u001b[35;7H6\u001b[36;7H5\u001b[37;7H4\u001b[38;7H3\u001b[39;7H2\u001b[40;7H1\u001b[41;5H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m130 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;41;46;66m                                                                                      \u001b[44;5H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[86X\u001b[45;90H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m0\u001b[24;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1\u001b[40;100H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m23  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;41;46;66m                                                                                       \u001b[41;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1\u001b[43;102H2\u001b[44;100H  3 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;"]
[41.833943, "o", "38m\u001b[K\u001b[41;9H\u001b[?25h"]
[42.696041, "o", "\u001b[?25l\u001b[46;180H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m{\u001b[41;9H\u001b[?25h"]
[42.708098, "o", "\u001b[?25l\u001b[46;180H \u001b[1;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m5\u001b[2;7H4\u001b[3;7H3\u001b[4;7H2\u001b[5;7H1\u001b[6;7H0\u001b[7;6H29\u001b[8;6H28\u001b[9;6H27\u001b[10;7H6\u001b[11;7H5\u001b[12;7H4\u001b[13;7H3\u001b[14;7H2\u001b[15;7H1\u001b[16;7H0\u001b[17;6H19\u001b[18;6H18\u001b[19;6H17\u001b[20;7H6\u001b[21;7H5\u001b[22;7H4\u001b[23;7H3\u001b[24;7H2\u001b[26;7H1\u001b[27;7H0\u001b[28;6H 9\u001b[29;6H 8\u001b[30;6H 7\u001b[31;7H6\u001b[32;7H5\u001b[33;7H4\u001b[35;7H3\u001b[36;7H2\u001b[37;7H1\u001b[38;5H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m127 \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b[39;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1\u001b[40;7H2\u001b[41;5H  3 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[86X\u001b[44;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m4\u001b[45;89H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m27\u001b[38;9H\u001b[?25h"]
[42.960409, "o", "\u001b[?25l\u001b[46;180H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m{\u001b[38;9H\u001b[?25h"]
[42.972195, "o", "\u001b[?25l\u001b[46;180H \u001b[1;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m2\u001b[2;7H1\u001b[3;7H0\u001b[4;6H29\u001b[5;6H28\u001b[6;6H27\u001b[7;7H6\u001b[8;7H5\u001b[9;7H4\u001b[10;7H3\u001b[11;7H2\u001b[12;7H1\u001b[13;7H0\u001b[14;6H19\u001b[15;6H18\u001b[16;6H17\u001b[17;7H6\u001b[18;7H5\u001b[19;7H4\u001b[20;7H3\u001b[21;7H2\u001b[22;7H1\u001b[23;7H0\u001b[24;6H 9\u001b[26;6H 8\u001b[27;6H 7\u001b[28;7H6\u001b[29;7H5\u001b[30;7H4\u001b[31;7H3\u001b[32;7H2\u001b[33;7H1\u001b[35;5H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m124 \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b[36;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1\u001b[37;7H2\u001b[38;5H  3 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b[39;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m4\u001b[40;7H5\u001b[41;7H6\u001b[44;7H7\u001b[45;90H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m4\u001b[35;9H\u001b[?25h"]
[43.457382, "o", "\u001b[?25l\u001b[46;180H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m{\u001b[35;9H\u001b[?25h"]
[43.46472, "o", "\u001b[?25l\u001b[46;180H \u001b[1;6H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m29\u001b[2;6H28\u001b[3;6H27\u001b[4;7H6\u001b[5;7H5\u001b[6;7H4\u001b[7;7H3\u001b[8;7H2\u001b[9;7H1\u001b[10;7H0\u001b[11;6H19\u001b[12;6H18\u001b[13;6H17\u001b[14;7H6\u001b[15;7H5\u001b[16;7H4\u001b[17;7H3\u001b[18;7H2\u001b[19;7H1\u001b[20;7H0\u001b[21;6H 9\u001b[22;6H 8\u001b[23;6H 7\u001b[24;7H6\u001b[26;7H5\u001b[27;7H4\u001b[28;7H3\u001b[29;7H2\u001b[30;7H1\u001b[31;5H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m121 \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b[32;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1\u001b[33;7H2\u001b[35;5H  3 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b[36;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m4\u001b[37;7H5\u001b[38;7H6\u001b[39;7H7\u001b[40;7H8\u001b[41;7H9\u001b[44;6H10\u001b[45;90H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m1\u001b[31;9H\u001b[?25h"]
[43.488704, "o", "\u001b[?25l\u001b[46;180H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m{\u001b[31;9H\u001b[?25h"]
[43.491396, "o", "\u001b[?25l\u001b[46;180H \u001b[1;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m6\u001b[2;7H5\u001b[3;7H4\u001b[4;7H3\u001b[5;7H2\u001b[6;7H1\u001b[7;7H0\u001b[8;6H19\u001b[9;6H18\u001b[10;6H17\u001b[11;7H6\u001b[12;7H5\u001b[13;7H4\u001b[14;7H3\u001b[15;7H2\u001b[16;7H1\u001b[17;7H0\u001b[18;6H 9\u001b[19;6H 8\u001b[20;6H 7\u001b[21;7H6\u001b[22;7H5\u001b[23;7H4\u001b[24;7H3\u001b[26;7H2\u001b[27;7H1\u001b[28;5H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m118 \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b[29;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1\u001b[30;7H2\u001b[31;5H  3 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b[32;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m4\u001b[33;7H5\u001b[35;7H6\u001b[36;7H7\u001b[37;7H8\u001b[38;7H9\u001b[39;6H10\u001b[40;6H11\u001b[41;6H12\u001b[44;7H3\u001b[45;89H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m18\u001b[28;9H\u001b[?25h"]
[43.517675, "o", "\u001b[?25l\u001b[46;180H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m{\u001b[28;9H\u001b[?25h"]
[43.520072, "o", "\u001b[?25l\u001b[46;180H \u001b[1;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m0\u001b[2;6H19\u001b[3;6H18\u001b[4;6H17\u001b[5;6H16\u001b[6;6H15\u001b[7;6H14\u001b[8;7H3\u001b[9;7H2\u001b[10;7H1\u001b[11;7H0\u001b[12;6H 9\u001b[13;6H 8\u001b[14;6H 7\u001b[15;6H 6\u001b[16;6H 5\u001b[17;6H 4\u001b[18;7H3\u001b[19;7H2\u001b[20;7H1\u001b[21;5H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m112 \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b[22;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1\u001b[23;7H2\u001b[26;7H4\u001b[27;7H5\u001b[28;5H  6 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b[29;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m7\u001b[30;7H8\u001b[31;7H9\u001b[32;6H10\u001b[33;6H11\u001b[35;6H12\u001b[36;6H13\u001b[37;6H14\u001b[38;6H15\u001b[39;7H6\u001b[40;7H7\u001b[41;7H8\u001b[44;7H9\u001b[45;90H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m2\u001b[24;100H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m22  \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m    \u001b(B\u001b[0;4m\u001b[38;2;187;154;247m\u001b[48;2;57;75;112mVALUES\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[0;4m\u001b["]
[43.520113, "o", "38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112ms\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[0;4m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mcustomer_id\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112ms\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[0;4m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112memail\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112ms\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[0;4m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mfirst_name\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112ms\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[0;4m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdatetime_updated\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112ms\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[0;4m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdatetime_updated\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,  \u001b[25;100H\u001b(B\u001b["]
[43.520133, "o", "0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mtrue\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mtrue\u001b(B\u001b[0;4m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                                         \u001b[40;100H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[41;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m2\u001b[43;102H3\u001b[44;102H4\u001b[21;9H\u001b[?25h"]
[43.546239, "o", "\u001b[?25l\u001b[46;180H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m{\u001b[21;9H\u001b[?25h"]
[43.548858, "o", "\u001b[?25l\u001b[46;180H \u001b[1;6H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m14\u001b[2;7H3\u001b[3;7H2\u001b[4;7H1\u001b[5;7H0\u001b[6;6H 9\u001b[7;6H 8\u001b[8;6H 7\u001b[9;6H 6\u001b[10;6H 5\u001b[11;6H 4\u001b[12;7H3\u001b[13;7H2\u001b[14;7H1\u001b[15;5H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m106 \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b[16;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1\u001b[17;7H2\u001b[19;7H4\u001b[20;7H5\u001b[21;5H  6 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b[22;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m7\u001b[23;7H8\u001b[24;7H9\u001b[26;6H10\u001b[27;6H11\u001b[28;6H12\u001b[29;6H13\u001b[30;6H14\u001b[31;6H15\u001b[32;7H6\u001b[33;7H7\u001b[35;7H8\u001b[36;7H9\u001b[37;6H20\u001b[38;6H21\u001b[39;6H22\u001b[40;6H23\u001b[41;6H24\u001b[44;6H25\u001b[45;89H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m06\u001b[15;9H\u001b[?25h"]
[43.576471, "o", "\u001b[?25l\u001b[46;180H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m{\u001b[15;9H\u001b[?25h"]
[43.578904, "o", "\u001b[?25l\u001b[46;180H \u001b[1;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1\u001b[2;7H0\u001b[3;6H 9\u001b[4;6H 8\u001b[5;6H 7\u001b[6;7H6\u001b[7;7H5\u001b[8;7H4\u001b[9;7H3\u001b[10;7H2\u001b[11;7H1\u001b[12;5H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m103 \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b[13;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1\u001b[14;7H2\u001b[15;5H  3 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b[16;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m4\u001b[17;7H5\u001b[18;7H6\u001b[19;7H7\u001b[20;7H8\u001b[21;7H9\u001b[22;6H10\u001b[23;6H11\u001b[24;6H12\u001b[26;7H3\u001b[27;7H4\u001b[28;7H5\u001b[29;7H6\u001b[30;7H7\u001b[31;7H8\u001b[32;7H9\u001b[33;6H20\u001b[35;6H21\u001b[36;6H22\u001b[37;7H3\u001b[38;7H4\u001b[39;7H5\u001b[40;7H6\u001b[41;7H7\u001b[44;7H8\u001b[45;90H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m3\u001b[12;9H\u001b[?25h"]
[43.606442, "o", "\u001b[?25l\u001b[46;180H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m{\u001b[12;9H\u001b[?25h"]
[43.611244, "o", "\u001b[?25l\u001b[46;180H \u001b[H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 10 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[1;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.email\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                   \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  9 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[2;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.first_name\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                         "]
[43.61129, "o", "     \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  8 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[3;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.datetime_updated\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                        \u001b[4;6H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 7\u001b[5;6H 6\u001b[6;7H5\u001b[7;7H4\u001b[8;7H3\u001b[9;7H2\u001b[10;7H1\u001b[11;5H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m99  \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b[12;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1\u001b[14;7H3\u001b[15;5H  4 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b[16;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m5"]
[43.611463, "o", "\u001b[17;7H6\u001b[18;7H7\u001b[19;7H8\u001b[20;7H9\u001b[21;6H10\u001b[22;6H11\u001b[23;6H12\u001b[24;6H13\u001b[25;7H4\u001b[26;7H5\u001b[27;7H6\u001b[29;7H7\u001b[30;7H8\u001b[31;7H9\u001b[32;6H20\u001b[33;6H21\u001b[34;6H22\u001b[35;6H23\u001b[36;7H4\u001b[38;7H5\u001b[39;7H6\u001b[40;7H7\u001b[41;7H8\u001b[42;7H9\u001b[43;6H30\u001b[44;6H31\u001b[45;77H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;41;46;66m \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;59;66;97m \u001b[45;80H python \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m 99\u001b[24;100H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[25;100H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[27;100H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m22  \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m    \u001b(B\u001b[0;4m\u001b[38;2;187;154;247m\u001b[48;2;57;75;112mVALUES\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[0;4m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;1"]
[43.611605, "o", "12ms\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[0;4m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mcustomer_id\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112ms\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[0;4m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112memail\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112ms\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[0;4m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mfirst_name\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112ms\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[0;4m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdatetime_updated\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112ms\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[0;4m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdatetime_updated\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,  \u001b[28;100H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57"]
[43.611737, "o", ";75;112m    \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mtrue\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mtrue\u001b(B\u001b[0;4m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                                         \u001b[40;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[41;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[42;104H---------------------------------------------------------------------------------------\u001b[43;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[44;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m2 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m    \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mWHEN\u001b(B\u001b[m\u001b[38;2;192;202;24"]
[43.611817, "o", "5m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mNOT\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mMATCHED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mBY\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mSOURCE\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m condition to \u001b(B\u001b[m\u001b[38;2;39;161;185m\u001b[48;2;32;48;59mset\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m deleted customers \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m dim_customer   \u001b[44;188H\u001b(B\u001b[m\u001b[38;2;84;92;126m\u001b[48;2;26;27;38m@@@\r\u001b[40A\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  7 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[4;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;"]
[43.611894, "o", "48;59m\"s.datetime_updated\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"valid_from\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[36X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  6 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[5;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mlit\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"is_current\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m"]
[43.611974, "o", "\u001b[48;2;32;48;59m\u001b[52X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  5 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[6;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mlit\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"is_active\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[54X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  4 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[85X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  3 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59"]
[43.61201, "o", "m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Insert the new records into dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[41X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mfinal_dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdated_dim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59munionByName\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mnew_customers_df\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[9X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[0;1m\u001b[38"]
[43.612042, "o", ";2;255;158;100m\u001b[48;2;26;27;38m99  \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# 3. Update inactive records (Not Matched By Source)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[34X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m#Condition: NOT MATCHED BY SOURCE\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[53X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  3 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m#Action: UPDATE SET is_active = false\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[49X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b"]
[43.612147, "o", "[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  4 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  5 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m#Find which customer_id's are not present in source dataframe.\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[24X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  6 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_ids_in_source\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msource_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mselect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b["]
[43.612211, "o", "48;2;32;48;59mdistinct\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m()\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[19X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  7 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  8 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59minactive_customers_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;5"]
[43.612278, "o", "9m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mfinal_dim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"t\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mjoin\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[24X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  9 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[20;10H   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_ids_in_source\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b"]
[43.612336, "o", "[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[48X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 10 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[21;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"t.customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m==\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[37X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 11 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[22;10H   \u001b(B\u001b[m\u001b[38;2;158;206;"]
[43.612411, "o", "106m\u001b[48;2;32;48;59m\"left_anti\"\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[71X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 12 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mselect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"t.*\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[71X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 13 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 14 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m#Update the is_active column in dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[39X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;"]
[43.612478, "o", "27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 15 \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mdef\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mupdate_inactive_customer\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[52X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 16 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;31;34;49m▎\u001b[27;10H   \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;57;75;112mif\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mrow\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mcustomer_id\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112minactive_customers_df\u001b(B\u001b[m\u001b"]
[43.612544, "o", "[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112mselect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;57;75;112m\"customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mrdd\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112mflatMap\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;57;75;112mlamb\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;57;75;112m▎\u001b[28;10H   \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;57;75;112mda\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;57;75;112mx\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mx\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b"]
[43.612636, "o", "[38;2;122;162;247m\u001b[48;2;57;75;112mcollect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m()\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[63X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 17 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[29;10H   ▎\u001b[29;14H   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mis_active\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mFalse\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[57X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 18 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[30;10H   \u001b(B\u001b[m\u001b[3m\u001b[38;2;157;124;216m\u001b[48;2;32;48;59mreturn\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;"]
[43.612708, "o", "2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[72X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 19 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 20 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Convert the DataFrame to an RDD and update the rows\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[33X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 21 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59minactive_rdd\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mfinal_dim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mrdd\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b"]
[43.612778, "o", "[48;2;32;48;59mmap\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdate_inactive_customer\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[16X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 22 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 23 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Convert the RDD back to a DataFrame\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[49X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 24 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59minactive_dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mspark\u001b(B\u001b[m\u001b[38;2;137;221;"]
[43.612865, "o", "255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcreateDataFrame\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59minactive_rdd\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mfinal_dim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59ms\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mchema\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[80X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 25 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 26 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# --- Display the re"]
[43.612939, "o", "sult (replace with your actual data writing logic) ---\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[12X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 27 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59minactive_dim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mshow\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m()\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[55X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 28 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 29 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Stop the SparkSession\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[63X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 30 \u001b(B\u001b[m\u001b[38;2;192;"]
[43.612976, "o", "202;245m\u001b[48;2;32;48;59mspark\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mstop\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m()\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[74X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 31 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[86X\u001b[33A\u001b[?25h"]
[43.637792, "o", "\u001b[?25l\u001b[46;180H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m{\u001b[11;9H\u001b[?25h"]
[43.649207, "o", "\u001b[?25l\u001b[46;180H \u001b[H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 10 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[1;10H   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"left_anti\"\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m  \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# equivalent to NOT MATCHED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                          \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  9 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mselect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                             \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  8 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;5"]
[43.649284, "o", "9m▎\u001b[3;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                             \u001b[4;6H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 7\u001b[5;7H6\u001b[6;7H5\u001b[7;7H4\u001b[8;7H3\u001b[9;7H2\u001b[10;7H1\u001b[11;5H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m96  \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b[12;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1\u001b[13;7H2\u001b[14;5H  3 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b[15;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m4\u001b[16;7H5\u001b[17;7H6\u001b[18;7H7\u001b[19;7H8\u001b[20;7H9\u001b[21;6H10\u001b[22;6H11\u001b[23;6H12\u001b[24;7H3\u001b[25;7H4\u001b[26;7H5\u001b[27;7H6\u001b[28;7H7\u001b[29;7H8\u001b[30;7H9\u001b[32;6H20\u001b[33;6H21\u001b[34;6H22\u001b[35;7H3\u001b[36;7H4\u001b[3"]
[43.64947, "o", "7;7H5\u001b[38;7H6\u001b[39;7H7\u001b[41;7H8\u001b[42;7H9\u001b[43;6H30\u001b[44;6H31\u001b[45;90H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m6\u001b[27;100H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[28;100H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[30;100H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m22  \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m    \u001b(B\u001b[0;4m\u001b[38;2;187;154;247m\u001b[48;2;57;75;112mVALUES\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[0;4m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112ms\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[0;4m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mcustomer_id\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112ms\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[0;4m\u001b[38;2;115;218;"]
[43.649529, "o", "202m\u001b[48;2;57;75;112memail\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112ms\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[0;4m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mfirst_name\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112ms\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[0;4m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdatetime_updated\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112ms\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[0;4m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdatetime_updated\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,  \u001b[31;100H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mtrue\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mtrue\u001b(B\u001b[0;4m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                      "]
[43.649671, "o", "                                                   \u001b[43;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[44;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\r\u001b[40A\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  7 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[4;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.email\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[67X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  6 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[5"]
[43.649717, "o", ";10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.first_name\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[62X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  5 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[6;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.datetime_updated\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[56X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  4 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[7;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b["]
[43.649842, "o", "48;2;32;48;59m\"s.datetime_updated\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"valid_from\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[36X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  3 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[8;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mlit\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"is_current\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;"]
[43.649887, "o", "202;245m\u001b[48;2;32;48;59m\u001b[52X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[9;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mlit\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"is_active\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[54X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[85X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m96  \u001b(B\u001b[0;4m\u001b[38;2;192;202;24"]
[43.650014, "o", "5m\u001b[48;2;32;48;59m                                                                                      \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Insert the new records into dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[41X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mfinal_dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdated_dim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59munionByName\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mnew_customers_df\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[9X"]
[43.650059, "o", "\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  3 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  4 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# 3. Update inactive records (Not Matched By Source)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[34X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48"]
[43.650217, "o", ";2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  5 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m#Condition: NOT MATCHED BY SOURCE\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[53X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  6 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m#Action: UPDATE SET is_active = false\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[49X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  7 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  8 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m#Find which customer_id's are not present in source dataframe.\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[24X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  9 \u001b(B\u001b[m\u001b[38;2;19"]
[43.650305, "o", "2;202;245m\u001b[48;2;32;48;59mcustomer_ids_in_source\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msource_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mselect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mdistinct\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m()\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[19X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 10 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 11 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59minactive_customers_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2"]
[43.650388, "o", ";32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mfinal_dim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"t\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mjoin\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[24X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 12 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[23;10H   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_ids_in_source\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;2"]
[43.650461, "o", "21;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[48X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 13 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[24;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"t.customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m==\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[37X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 14 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[25;10H   \u001b(B\u001b[m\u001b[38;2;"]
[43.650523, "o", "158;206;106m\u001b[48;2;32;48;59m\"left_anti\"\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[71X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 15 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mselect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"t.*\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[71X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 16 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 17 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m#Update the is_active column in dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[39X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b["]
[43.650592, "o", "48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 18 \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mdef\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mupdate_inactive_customer\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[52X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 19 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;31;34;49m▎\u001b[30;10H   \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;57;75;112mif\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mrow\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mcustomer_id\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112minactive_customers_d"]
[43.65066, "o", "f\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112mselect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;57;75;112m\"customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mrdd\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112mflatMap\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;57;75;112mlamb\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;57;75;112m▎\u001b[31;10H   \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;57;75;112mda\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;57;75;112mx\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mx\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m"]
[43.650719, "o", ".\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112mcollect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m()\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[63X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 20 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[32;10H   ▎\u001b[32;14H   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mis_active\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mFalse\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[57X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 21 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[33;10H   \u001b(B\u001b[m\u001b[3m\u001b[38;2;157;124;216m\u001b[48;2;32;48;59mreturn\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;2"]
[43.650775, "o", "45m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[72X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 22 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 23 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Convert the DataFrame to an RDD and update the rows\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[33X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 24 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59minactive_rdd\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mfinal_dim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mrdd\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;1"]
[43.650833, "o", "62;247m\u001b[48;2;32;48;59mmap\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdate_inactive_customer\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[16X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 25 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 26 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Convert the RDD back to a DataFrame\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[49X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 27 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59minactive_dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mspark\u001b(B\u001b[m\u001b[38;2;"]
[43.650892, "o", "137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcreateDataFrame\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59minactive_rdd\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mfinal_dim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59ms\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mchema\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[80X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 28 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 29 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# --- Displa"]
[43.65095, "o", "y the result (replace with your actual data writing logic) ---\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[12X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 30 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59minactive_dim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mshow\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m()\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[55X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 31 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\u001b[33A\u001b[?25h"]
[43.668408, "o", "\u001b[?25l\u001b[46;180H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m{\u001b[11;9H\u001b[?25h"]
[43.677289, "o", "\u001b[?25l\u001b[46;180H \u001b[H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 10 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[1;10H   \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mif\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mcustomer_id\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdated_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mselect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mrdd\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mflatMap\u001b(B\u001b[m\u001b[38;2;169;177;214m"]
[43.677443, "o", "\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mlambda\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;32;48;59mx\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mx\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mco\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[2;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mllect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m()\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                          \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  9 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[3;10H   ▎\u001b[3;14H   \u001b(B\u001b[m\u001b[38"]
[43.677562, "o", ";2;192;202;245m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mis_current\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mFalse\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                        \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  8 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[4;10H   ▎\u001b[4;14H   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mvalid_to\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59ms_datetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2"]
[43.677693, "o", ";32;48;59m                                         \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  7 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[5;10H   \u001b(B\u001b[m\u001b[3m\u001b[38;2;157;124;216m\u001b[48;2;32;48;59mreturn\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                        \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  6 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  5 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Convert the DataFrame to an RDD and update the rows\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                           "]
[43.677739, "o", "      \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  4 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdated_rdd\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mdim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mrdd\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mmap\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdate_dim_customer\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                            \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  3 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                 "]
[43.677852, "o", "     \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Convert the RDD back to a DataFrame\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                 \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdated_dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mspark\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcreateDataFrame\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdated_rdd\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mdim_customer_df\u001b(B\u001b"]
[43.677888, "o", "[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mschema\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m  \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m79  \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# 2. Insert new records\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                               \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# Condition: NOT MATCHED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                         "]
[43.677908, "o", "     \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  3 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# Action: INSERT (customer_id,email,first_name,datetime_updated,valid_from,is_current,\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112mis_active)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                                            \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  4 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mnew_customers_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msource_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;1"]
[43.678046, "o", "77;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mjoin\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                         \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  5 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[18;10H   \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mdim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"t\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                       \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m"]
[43.678111, "o", "\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  6 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[19;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.join_key\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m==\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"t.customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                        \u001b[20;6H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 7\u001b[21;7H8\u001b[22;7H9\u001b[23;6H10\u001b[24;6H11\u001b[25;6H12\u001b[26;6H13\u001b[27;6H14\u001b[28;6H15\u001b[29;6H16\u001b[30;5H 17 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b[31;6H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m18\u001b[32;6H19\u001b"]
[43.678182, "o", "[33;6H20\u001b[34;6H21\u001b[35;6H22\u001b[36;6H23\u001b[37;6H24\u001b[38;6H25\u001b[39;6H26\u001b[40;6H27\u001b[41;6H28\u001b[42;6H29\u001b[43;6H30\u001b[44;6H31\u001b[45;89H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m79\u001b[1;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[2;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[3;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[4;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m----------------------------------------------------------------------"]
[43.678246, "o", "-----------------\u001b[5;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[6;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[7;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b"]
[43.67834, "o", "[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[8;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[9;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[10;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[11;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m----------------------------------------------------------------"]
[43.678443, "o", "-----------------------\u001b[12;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m19  \u001b(B\u001b[0;4m\u001b[38;2;59;66;97m\u001b[48;2;57;75;112m·\u001b[12;105H·\u001b[12;106H·\u001b[12;107H·\u001b[12;108H\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                                                   \u001b[13;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mWHEN\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mNOT\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mMATCHED\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;57;75;112m·\u001b[13;125H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                                  \u001b[14;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    2 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;7"]
[43.678516, "o", "5;112m    \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mTHEN\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;57;75;112mINSERT\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mcustomer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112memail\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mfirst_name\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mdatetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mvalid_from\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mis_current\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,  \u001b[15;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    is_active\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b"]
[43.678583, "o", "[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m condition to \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mINSERT\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m new customers \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112mand\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m customers with updates\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m         \u001b[16;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[17;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[18;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m------------------------------------------------------------------"]
[43.678652, "o", "---------------------\u001b[19;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[20;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[21;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[22;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[23;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b"]
[43.678732, "o", "[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[24;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[25;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[26;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[27;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[28;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;"]
[43.678805, "o", "26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[29;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[30;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[31;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[32;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m--------------------------------------------"]
[43.678874, "o", "-------------------------------------------\u001b[33;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[34;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[35;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[36;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[37;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b"]
[43.678943, "o", "[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[38;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[39;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[40;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[41;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[42;96H\u001b(B\u001b[m\u001b["]
[43.679022, "o", "38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[43;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[44;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\r\u001b[24A\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  7 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[20;10H   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"left_anti\"\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m  \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# equivalent to NOT MATCHED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48"]
[43.679089, "o", ";2;32;48;59m\u001b[42X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  8 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mselect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[77X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  9 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[22;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[61X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 10 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[23;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2"]
[43.679154, "o", ";32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.email\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[67X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 11 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[24;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.first_name\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[62X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 12 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[25;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.datetime_updated\"\u001b(B\u001b[m\u001b[38;2;"]
[43.67922, "o", "169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[56X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 13 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[26;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.datetime_updated\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"valid_from\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[36X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 14 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[27;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mlit\u001b(B"]
[43.679295, "o", "\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"is_current\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[52X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2"]
[43.679394, "o", ";26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 15 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[28;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mlit\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"is_active\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[54X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 16 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[85X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 17 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b("]
[43.679464, "o", "B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 18 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Insert the new records into dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[41X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 19 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mfinal_dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdated_dim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59munionByName\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mnew_customers_df\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[9X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 20 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;"]
[43.679527, "o", "95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 21 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# 3. Update inactive records (Not Matched By Source)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[34X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 22 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m#Condition: NOT MATCHED BY SOURCE\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[53X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 23 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m#Action: UPDATE SET is_active = false\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[49X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 24 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;5"]
[43.679611, "o", "9;66;97m\u001b[48;2;26;27;38m 25 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m#Find which customer_id's are not present in source dataframe.\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[24X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 26 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_ids_in_source\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msource_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mselect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mdistinct\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m()\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[19X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;"]
[43.679672, "o", "2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 27 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 28 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59minactive_customers_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mfinal_dim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"t\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mjoin\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[24X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 29 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2"]
[43.679732, "o", ";32;48;59m▎\u001b[42;10H   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_ids_in_source\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[48X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 30 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[43;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"t.customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m==\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.customer_id\"\u001b"]
[43.679788, "o", "(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[37X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 31 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[44;10H   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"left_anti\"\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[71X\u001b[12;9H\u001b[?25h"]
[43.701086, "o", "\u001b[?25l\u001b[46;180H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m{\u001b[12;9H\u001b[?25h"]
[43.708285, "o", "\u001b[?25l\u001b[46;180H \u001b[H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  9 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Update the is_current and valid_to columns in dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                       \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  8 \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mdef\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mupdate_dim_customer\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                         \u001b[3;6H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 7\u001b[5;7H6\u001b[6;7H5\u001b[7;7H4\u001b[8;7H3\u001b[9;7H2\u001b[10;7H1\u001b[11;5H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m76  \u001b(B\u001b[0;4m\u001b[38;2;192;202;2"]
[43.708488, "o", "45m\u001b[48;2;32;48;59m                                                                                      \u001b[12;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1\u001b[13;7H2\u001b[14;5H  3 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b[15;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m4\u001b[16;7H5\u001b[17;7H6\u001b[19;7H7\u001b[20;7H8\u001b[21;7H9\u001b[22;6H10\u001b[23;6H11\u001b[24;6H12\u001b[25;7H3\u001b[26;7H4\u001b[27;7H5\u001b[28;7H6\u001b[29;7H7\u001b[30;7H8\u001b[31;7H9\u001b[32;6H20\u001b[33;6H21\u001b[34;6H22\u001b[35;7H3\u001b[36;7H4\u001b[37;7H5\u001b[38;7H6\u001b[39;7H7\u001b[40;7H8\u001b[41;7H9\u001b[42;6H30\u001b[43;6H31\u001b[44;6H32\u001b[45;90H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m6\u001b[12;100H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[13;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[14;100H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b["]
[43.708541, "o", "48;2;26;27;38m19  \u001b(B\u001b[0;4m\u001b[38;2;59;66;97m\u001b[48;2;57;75;112m·\u001b[14;105H·\u001b[14;106H·\u001b[14;107H·\u001b[14;108H\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                                                   \u001b[15;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mWHEN\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mNOT\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mMATCHED\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;57;75;112m·\u001b[15;125H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                         \u001b[16;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m2 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mTHEN\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;57;75;112mINSERT\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m"]
[43.708675, "o", "\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mcustomer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112memail\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mfirst_name\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mdatetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mvalid_from\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mis_current\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,  \u001b[17;104H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    is_active\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m condition to \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mINSERT\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m new customers \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112mand\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m customers wit"]
[43.708718, "o", "h updates\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m         \r\u001b[14A\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  7 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[3;10H   \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mif\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mcustomer_id\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdated_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mselect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mrdd\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b["]
[43.708842, "o", "48;2;32;48;59mflatMap\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mlambda\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;32;48;59mx\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mx\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mco\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[4;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mllect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m()\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[74X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  6 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[5;10H   ▎\u001b[5;14H   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;3"]
[43.708897, "o", "2;48;59mrow\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mis_current\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mFalse\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[56X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  5 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[6;10H   ▎\u001b[6;14H   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mvalid_to\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59ms_datetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[41X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;"]
[43.709048, "o", "157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  4 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[7;10H   \u001b(B\u001b[m\u001b[3m\u001b[38;2;157;124;216m\u001b[48;2;32;48;59mreturn\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[72X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  3 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Convert the DataFrame to an RDD and update the rows\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[33X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdated_rdd\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;2"]
[43.709164, "o", "02;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mdim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mrdd\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mmap\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdate_dim_customer\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[28X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m76  \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Convert the RDD back to a DataFrame\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[49X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m "]
[43.709286, "o", " \u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdated_dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mspark\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcreateDataFrame\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdated_rdd"]
[43.709452, "o", "\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mdim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mschema\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m  \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  3 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  4 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# 2. Insert new records\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[63X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  5 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# Condition: NOT MATCHED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[62X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;"]
[43.709563, "o", "26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  6 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# Action: INSERT (customer_id,email,first_name,datetime_updated,valid_from,is_current,\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112mis_active)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[76X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  7 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mnew_customers_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msource_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59"]
[43.709677, "o", "m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mjoin\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[41X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  8 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[20;10H   \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mdim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"t\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[55X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  9 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[21;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206"]
[43.709785, "o", ";106m\u001b[48;2;32;48;59m\"s.join_key\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m==\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"t.customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[40X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 10 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[22;10H   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"left_anti\"\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m  \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# equivalent to NOT MATCHED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[42X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 11 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;3"]
[43.70989, "o", "2;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mselect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[77X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 12 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[24;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[61X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 13 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[25;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.email\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;"]
[43.709995, "o", "2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[67X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 14 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[26;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.first_name\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[62X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 15 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[27;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.datetime_updated\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[56X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;1"]
[43.710104, "o", "57;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 16 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[28;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.datetime_updated\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"valid_from\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[36X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 17 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[29;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mlit\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[3"]
[43.710214, "o", "8;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"is_current\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[52X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 18 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[30;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mlit\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"is_active\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[54X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 19 \u001b(B\u001b[m\u001b[38;2;"]
[43.710323, "o", "169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[85X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 20 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 21 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Insert the new records into dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[41X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 22 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mfinal_dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdated_dim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59munionByName\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m("]
[43.710453, "o", "\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mnew_customers_df\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[9X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 23 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 24 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# 3. Update inactive records (Not Matched By Source)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[34X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 25 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m#Condition: NOT MATCHED BY SOURCE\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[53X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 26 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m#Action: UPDATE SET "]
[43.710562, "o", "is_active = false\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[49X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 27 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 28 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m#Find which customer_id's are not present in source dataframe.\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[24X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 29 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_ids_in_source\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msource_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mselect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;"]
[43.710674, "o", "158;206;106m\u001b[48;2;32;48;59m\"customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mdistinct\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m()\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[19X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 30 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 31 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59minactive_customers_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mfinal_dim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"t\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48"]
[43.710789, "o", ";59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mjoin\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[24X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 32 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[44;10H   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_ids_in_source\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[48X\u001b[11;9H\u001b[?25h"]
[43.734965, "o", "\u001b[?25l\u001b[46;180H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m{\u001b[11;9H\u001b[?25h"]
[43.74181, "o", "\u001b[?25l\u001b[46;180H \u001b[H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  9 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[1;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.datetime_updated\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s_datetime_updated\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                             \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  8 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                     \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m "]
[43.741879, "o", " \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  7 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b[4;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m6\u001b[5;7H5\u001b[6;7H4\u001b[8;7H3\u001b[9;7H2\u001b[10;7H1\u001b[11;5H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m73  \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b[12;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1\u001b[13;7H2\u001b[14;5H  3 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b[15;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m4\u001b[16;7H5\u001b[17;7H6\u001b[18;7H7\u001b[19;7H8\u001b[20;7H9\u001b[22;6H10\u001b[23;6H11\u001b[24;6H12\u001b[25;7H3\u001b[26;7H4\u001b[27;7H5\u001b[28;7H6\u001b[29;7H7\u001b[30;7H8\u001b[31;7H9\u001b[32;6H20\u001b[33;6H21\u001b[34;6H22\u001b[35;7H3\u001b[36;7H4\u001b[37;7H5\u001b[38;7H6\u001b[39;7H7\u001b[40;7H8\u001b[41;7H9\u001b[42;6H30\u001b[43;6H31\u001b[44;6H32\u001b[45;90H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m3\u001b[14;100H\u001b(B\u001b[m\u001b[38;2;"]
[43.742065, "o", "59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[15;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[16;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[17;100H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m19  \u001b(B\u001b[0;4m\u001b[38;2;59;66;97m\u001b[48;2;57;75;112m·\u001b[17;105H·\u001b[17;106H·\u001b[17;107H·\u001b[17;108H\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                                                   \u001b[18;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mWHEN\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mNOT\u001b(B\u001b[m\u001b[38;2;1"]
[43.742123, "o", "92;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mMATCHED\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;57;75;112m·\u001b[18;125H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                                  \u001b[19;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m2 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mTHEN\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;57;75;112mINSERT\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mcustomer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112memail\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mfirst_name\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mdatetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mvalid_from\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75"]
[43.74229, "o", ";112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mis_current\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,  \u001b[20;104H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    is_active\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m condition to \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mINSERT\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m new customers \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112mand\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m customers with updates\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m         \r\u001b[16A\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  6 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Update the is_current and valid_to columns in dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[23X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m"]
[43.742421, "o", "  5 \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mdef\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mupdate_dim_customer\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[57X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  4 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[6;10H   \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mif\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mcustomer_id\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdated_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48"]
[43.742543, "o", ";59mselect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mrdd\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mflatMap\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mlambda\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;32;48;59mx\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mx\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mco\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[7;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mllect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m()\u001b(B\u001b[m\u001b[3"]
[43.742589, "o", "8;2;137;221;255m\u001b[48;2;32;48;59m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[74X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  3 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[8;10H   ▎\u001b[8;14H   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mis_current\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mFalse\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[56X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[9;10H   ▎\u001b[9;14H   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mvalid_to\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2"]
[43.742749, "o", ";32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59ms_datetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[41X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[10;10H   \u001b(B\u001b[m\u001b[3m\u001b[38;2;157;124;216m\u001b[48;2;32;48;59mreturn\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[72X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m73  \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b"]
[43.742808, "o", "[48;2;32;48;59m# Convert the DataFrame to an RDD and update the rows\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[33X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdated_rdd\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mdim_customer_df\u001b(B\u001b[m\u001b[38;2;1"]
[43.743096, "o", "37;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mrdd\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mmap\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdate_dim_customer\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[28X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  3 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  4 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Convert the RDD back to a DataFrame\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[49X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  5 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdated_dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;2"]
[43.743144, "o", "21;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mspark\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcreateDataFrame\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdated_rdd\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mdim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mschema\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m  \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  6 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  7 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# 2. Insert new records\u001b(B\u001b[m\u001b[38;2;19"]
[43.743282, "o", "2;202;245m\u001b[48;2;31;34;49m\u001b[63X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  8 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# Condition: NOT MATCHED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[62X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  9 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# Action: INSERT (customer_id,email,first_name,datetime_updated,valid_from,is_current,\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112mis_active)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[76X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 10 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mnew_customers_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b("]
[43.74339, "o", "B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msource_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mjoin\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[41X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 11 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[23;10H   \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mdim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"t\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b["]
[43.743474, "o", "48;2;32;48;59m\u001b[55X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 12 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[24;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.join_key\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m==\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"t.customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[40X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 13 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[25;10H   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"left_anti\"\u001b(B\u001b[m\u001b[38;2;19"]
[43.743546, "o", "2;202;245m\u001b[48;2;32;48;59m  \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# equivalent to NOT MATCHED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[42X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 14 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mselect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[77X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 15 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[27;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[61X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m"]
[43.743616, "o", "+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 16 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[28;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.email\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[67X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 17 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[29;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.first_name\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[62X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 18 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[30;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;3"]
[43.743684, "o", "2;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.datetime_updated\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[56X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 19 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[31;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.datetime_updated\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"valid_from\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[36X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;5"]
[43.743752, "o", "9;66;97m\u001b[48;2;26;27;38m 20 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[32;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mlit\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"is_current\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[52X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 21 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[33;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mlit\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;1"]
[43.743824, "o", "77;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"is_active\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[54X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 22 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[85X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 23 \u001b(B\u001b[m"]
[43.743908, "o", "\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 24 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Insert the new records into dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[41X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 25 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mfinal_dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdated_dim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59munionByName\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mnew_customers_df\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[9X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;1"]
[43.744005, "o", "71m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 26 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 27 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# 3. Update inactive records (Not Matched By Source)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[34X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 28 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m#Condition: NOT MATCHED BY SOURCE\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[53X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 29 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m#Action: UPDATE SET is_active = false\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[49X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 30 \u001b(B\u001b[m\u001b[38;2;192;2"]
[43.744088, "o", "02;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 31 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m#Find which customer_id's are not present in source dataframe.\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[24X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 32 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_ids_in_source\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msource_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mselect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mdistinct\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32"]
[43.744168, "o", ";48;59m()\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[19X\u001b[11;9H\u001b[?25h"]
[43.767379, "o", "\u001b[?25l\u001b[46;180H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m{\u001b[11;9H\u001b[?25h"]
[43.774283, "o", "\u001b[?25l\u001b[46;180H \u001b[H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  9 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[1;10H   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msource_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                             \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  8 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[2;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"t.customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;13"]
[43.774368, "o", "7;221;255m\u001b[48;2;32;48;59m==\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.join_key\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                        \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  7 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[3;10H   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"inner\"\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                           \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  6 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mwhere\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[3"]
[43.774582, "o", "8;2;192;202;245m\u001b[48;2;32;48;59m                                                                              \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;26;27;38mW \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  5 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[5;10H   \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"t.is_current\"\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m==\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m&\u001b(B\u001b"]
[43.774736, "o", "[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.datetime_updated\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"t.datetime_updat\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[6;10H   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59med\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                             \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;"]
[43.774777, "o", "97m\u001b[48;2;26;27;38m  4 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mselect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                             \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  3 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[8;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"t.*\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                       \u001b[9;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m2\u001b[10;7H1\u001b[11;5H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m66  \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                    "]
[43.77493, "o", "                                  \u001b[12;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1\u001b[13;7H2\u001b[14;7H3\u001b[16;7H4\u001b[17;7H5\u001b[18;7H6\u001b[19;5H  7 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b[20;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m8\u001b[21;7H9\u001b[22;6H10\u001b[23;6H11\u001b[24;6H12\u001b[25;6H13\u001b[26;6H14\u001b[27;6H15\u001b[28;6H16\u001b[30;7H7\u001b[31;7H8\u001b[32;7H9\u001b[33;6H20\u001b[34;6H21\u001b[35;6H22\u001b[36;6H23\u001b[37;6H24\u001b[38;6H25\u001b[39;6H26\u001b[40;7H7\u001b[41;7H8\u001b[42;7H9\u001b[43;6H30\u001b[44;6H31\u001b[45;89H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m66\u001b[17;100H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[18;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[19;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m--------------------"]
[43.774987, "o", "-------------------------------------------------------------------\u001b[20;104H---------------------------------------------------------------------------------------\u001b[24;100H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m19  \u001b(B\u001b[0;4m\u001b[38;2;59;66;97m\u001b[48;2;57;75;112m·\u001b[24;105H·\u001b[24;106H·\u001b[24;107H·\u001b[24;108H\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                                                   \u001b[25;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mWHEN\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mNOT\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mMATCHED\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;57;75;112m·\u001b[25;125H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                                  \u001b[26;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m2 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    \u001b(B\u001b[m\u001b[38;2;255;1"]
[43.77514, "o", "58;100m\u001b[48;2;57;75;112mTHEN\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;57;75;112mINSERT\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mcustomer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112memail\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mfirst_name\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mdatetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mvalid_from\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mis_current\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,  \u001b[27;104H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    is_active\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m conditio"]
[43.775196, "o", "n to \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mINSERT\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m new customers \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112mand\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m customers with updates\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m         \r\u001b[18A\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[9;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.datetime_updated\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s_datetime_updated\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[29X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;"]
[43.775255, "o", "97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[85X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m66  \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Update the is_current and valid_to columns in dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[23X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mdef\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mupdate_dim_customer\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2"]
[43.775431, "o", ";169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[57X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  3 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[14;10H   \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mif\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mcustomer_id\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdated_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mselect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mrdd\u001b(B\u001b[m\u001b[38;2;"]
[43.775517, "o", "137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mflatMap\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mlambda\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;32;48;59mx\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mx\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mco\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[15;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mllect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m()\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[74X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  4 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m"]
[43.775586, "o", "▎\u001b[16;10H   ▎\u001b[16;14H   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mis_current\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mFalse\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[56X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  5 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[17;10H   ▎\u001b[17;14H   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mvalid_to\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59ms_datetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[4"]
[43.775648, "o", "1X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  6 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[18;10H   \u001b(B\u001b[m\u001b[3m\u001b[38;2;157;124;216m\u001b[48;2;32;48;59mreturn\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[72X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  7 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  8 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Convert the DataFrame to an RDD and update the rows\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[33X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  9 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdated_rdd\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59"]
[43.775716, "o", "m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mdim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mrdd\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mmap\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdate_dim_customer\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[28X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 10 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 11 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Convert the RDD back to a DataFrame\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[49X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48"]
[43.775818, "o", ";2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 12 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdated_dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mspark\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcreateDataFrame\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdated_rdd\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mdim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mschema\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m  \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 13 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48"]
[43.775884, "o", ";2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 14 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# 2. Insert new records\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[63X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 15 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# Condition: NOT MATCHED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[62X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 16 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# Action: INSERT (customer_id,email,first_name,datetime_updated,valid_from,is_current,\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112mis_active)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[76X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b["]
[43.775959, "o", "m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 17 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mnew_customers_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msource_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mjoin\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[41X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 18 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[31;10H   \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mdim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;"]
[43.77604, "o", "177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"t\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[55X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 19 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[32;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.join_key\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m==\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"t.customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[40X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171"]
[43.776142, "o", "m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 20 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[33;10H   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"left_anti\"\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m  \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# equivalent to NOT MATCHED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[42X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 21 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mselect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[77X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 22 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[35;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;3"]
[43.77623, "o", "2;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[61X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 23 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[36;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.email\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[67X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 24 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[37;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.first_name\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[62X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;"]
[43.776373, "o", "26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 25 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[38;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.datetime_updated\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[56X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 26 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[39;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.datetime_updated\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"valid_from\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b"]
[43.776499, "o", "[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[36X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 27 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[40;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mlit\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"is_current\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[52X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 28 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[41;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mlit\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;"]
[43.776601, "o", "255;158;100m\u001b[48;2;32;48;59mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"is_active\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[54X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 29 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[85X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 30 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 31 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Insert the new records into dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[41X\u001b[11;9H\u001b[?25h"]
[43.79375, "o", "\u001b[?25l\u001b[46;180H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m{\u001b[11;9H\u001b[?25h"]
[43.819664, "o", "\u001b[?25l\u001b[46;180H \u001b[H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  9 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# Union all the dataframes together\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                   \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  8 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112munion\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mempty_rows\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                     \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;"]
[43.81989, "o", "27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  7 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  6 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Create a null join_key column\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                       \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;26;27;38mW \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  5 \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mfrom\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mpyspark\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msql\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192"]
[43.820069, "o", ";202;245m\u001b[48;2;32;48;59mfunctions\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mimport\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mlit\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                 \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  4 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mwithColumn\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"join_key\"\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;1"]
[43.820249, "o", "92;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mlit\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;32;48;59mNone\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcast\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"string\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                            \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  3 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m"]
[43.820387, "o", "\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Union the two dataframes\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                            \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msource_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59munionByName\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;32;48;59mallowMissingColumns\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b"]
[43.820535, "o", "[38;2;192;202;245m\u001b[48;2;32;48;59m \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m51  \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# --- Perform the merge logic ---\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                     \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# 1. Update existing records\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                          \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  3 \u001b(B\u001b["]
[43.820653, "o", "m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# Condition: MATCHED AND is_current = true AND s.datetime_updated > t.datetime_updated\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  4 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# Action:\u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;31;34;49m UPDATE SET is_current = false, valid_to = s.datetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  5 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdated_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mdim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"t\"\u001b"]
[43.82075, "o", "(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mjoin\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                         \u001b[17;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m6\u001b[18;7H7\u001b[19;7H8\u001b[20;7H9\u001b[21;6H10\u001b[23;6H11\u001b[24;6H12\u001b[25;6H13\u001b[26;6H14\u001b[27;5H 15 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b[28;6H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m16\u001b[29;6H17\u001b[30;6H18\u001b[32;6H19\u001b[33;6H20\u001b[34;6H21\u001b[35;6H22\u001b[36;6H23\u001b[37;6H24\u001b[38;6H25\u001b[39;6H26\u001b[40;6H27\u001b[41;6H28\u001b[42;6H29\u001b[43;6H30\u001b[44;6H31\u001b[84C\u001b(B\u001b[m\u001b[38;2;84;92;126m\u001b[48;2;26;27;38m@@@\u001b[45;89H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m51\u001b[1;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    3 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m s\u001b(B\u001b[m\u001b[38;"]
[43.820839, "o", "2;192;202;245m\u001b[48;2;31;34;49m                                                                                \u001b[2;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    2 \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mON\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m t\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mcustomer_id\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m s\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mjoin_key\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m natural key \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;57;75;112mfor\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m customer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                              \u001b[3;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    1 \u001b(B\u001b[m\u001b[38;2;1"]
[43.820927, "o", "92;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[4;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[5;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[6;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27"]
[43.821045, "o", ";38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[7;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[8;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[9;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[10;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m----------------------------------------------------"]
[43.821166, "o", "-----------------------------------\u001b[11;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[12;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[13;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m17  \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    \u001b(B\u001b[0;4m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mWHEN\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[0;4m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mMATCHED\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[0;4m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mAND\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m is_current \u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m=\u001b(B\u001b[0;4m\u001b[38;2;1"]
[43.821291, "o", "92;202;245m\u001b[48;2;57;75;112m true \u001b(B\u001b[0;4m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mAND\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m s\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[0;4m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdatetime_updated\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m>\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m t\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[0;4m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdatetime_updated\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m  \u001b[14;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mcondition to \u001b(B\u001b[0;4m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mUPDATE\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m most recent customers \u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;1"]
[43.821422, "o", "12min\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m dim_customer that have had updates\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m    \u001b[15;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mTHEN\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;31;34;49mUPDATE\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;31;34;49mSET\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m is_current \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;31;34;49m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m false\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;31;34;49m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m valid_to \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;31;34;49m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m s\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;31;34;49m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;31;34;49mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                  \u001b[16;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b"]
[43.821538, "o", "[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[40;100H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;57;75;112m·\u001b[40;105H·\u001b[40;106H·\u001b[40;107H·\u001b[40;108H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                                                   \u001b[41;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m3\u001b[42;102H4\u001b[17;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[18;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[19;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b["]
[43.821593, "o", "m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[20;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[21;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[22;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[23;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[24;96H\u001b(B\u001b[m\u001b[3"]
[43.821629, "o", "8;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[25;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[26;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[27;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[28;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m-----------------------"]
[43.821698, "o", "----------------------------------------------------------------\u001b[29;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[30;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[31;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[32;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[33;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;"]
[43.821741, "o", "2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[34;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[35;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[36;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[37;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------"]
[43.822079, "o", "------\u001b[38;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[39;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[40;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    2 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;57;75;112m·\u001b[40;105H·\u001b[40;106H·\u001b[40;107H·\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[40;108H\u001b[K\u001b[41;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    3 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mWHEN\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mNOT\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;11"]
[43.822233, "o", "2mMATCHED\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;57;75;112m·\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[41;125H\u001b[K\u001b[42;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    4 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mTHEN\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;57;75;112mINSERT\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mcustomer_id\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112memail\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mfirst_name\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mdatetime_updated\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mvalid_from\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mis_current\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;"]
[43.822379, "o", "2;57;75;112m,\u001b[K\u001b[43;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    is_active\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m condition to \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mINSERT\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m new customers \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112mand\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m customers with updates\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[K\u001b[44;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\r\u001b[27A\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  6 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[17;10H   \u001b(B\u001b[m\u001b[38;"]
[43.822502, "o", "2;192;202;245m\u001b[48;2;32;48;59msource_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[61X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  7 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[18;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"t.customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m==\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.join_key\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38"]
[43.822621, "o", ";2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[40X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  8 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[19;10H   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"inner\"\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[75X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  9 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mwhere\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[78X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;26;27;38mW \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 10 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[21;10H   \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38"]
[43.822725, "o", ";2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"t.is_current\"\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m==\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m&\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.datetime_updated\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mc"]
[43.82282, "o", "ol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"t.datetime_updat\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[22;10H   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59med\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[77X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 11 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mselect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[77X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 12 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[24;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b"]
[43.822908, "o", "(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"t.*\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[71X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 13 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[25;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.datetime_updated\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s_datetime_updated\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[29X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 14 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;3"]
[43.822982, "o", "2;48;59m\u001b[85X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 15 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 16 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Update the is_current and valid_to columns in dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[23X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 17 \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mdef\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mupdate_dim_customer\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[57X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[4"]
[43.823062, "o", "8;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 18 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[30;10H   \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mif\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mcustomer_id\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdated_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mselect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mrdd\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mflatMap\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mlambda\u001b(B\u001b[m\u001b[38;2;192;202;2"]
[43.823144, "o", "45m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;32;48;59mx\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mx\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mco\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[31;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mllect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m()\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[74X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 19 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[32;10H   ▎\u001b[32;14H   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mis_current\u001b(B\u001b[m\u001b[38;2;192;202;245m"]
[43.82322, "o", "\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mFalse\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[56X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 20 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[33;10H   ▎\u001b[33;14H   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59m"]
[43.823294, "o", "valid_to\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59ms_datetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[41X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 21 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[34;10H   \u001b(B\u001b[m\u001b[3m\u001b[38;2;157;124;216m\u001b[48;2;32;48;59mreturn\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[72X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 22 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 23 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;"]
[43.82337, "o", "48;59m# Convert the DataFrame to an RDD and update the rows\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[33X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 24 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdated_rdd\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mdim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mrdd\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mmap\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdate_dim_customer\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[28X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 25 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X"]
[43.823441, "o", "\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 26 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Convert the RDD back to a DataFrame\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[49X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 27 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdated_dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mspark\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcreateDataFrame\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdated_rdd\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mdim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;"]
[43.823534, "o", "2;115;218;202m\u001b[48;2;32;48;59mschema\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m  \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 28 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 29 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# 2. Insert new records\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[63X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 30 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# Condition: NOT MATCHED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[62X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 31 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# Action: INSERT (customer_id,email,first_name,datetime_updated,valid_from,is_"]
[43.823598, "o", "curre\u001b(B\u001b[m\u001b[38;2;84;92;126m\u001b[48;2;26;27;38m@@@\u001b[11;9H\u001b[?25h"]
[43.823702, "o", "\u001b[?25l\u001b[46;180H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m{\u001b[11;9H\u001b[?25h"]
[43.834266, "o", "\u001b[?25l\u001b[46;180H \u001b[H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  9 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Drop join_key and then reorder\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                      \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  8 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mempty_rows\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mempty_rows\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mdrop\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"join_key\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                              \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B"]
[43.834419, "o", "\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  7 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mempty_rows\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mempty_rows\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mselect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mcolumns\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                   \u001b[4;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m6\u001b[5;7H5\u001b[6;7H4\u001b[7;7H3\u001b[8;7H2\u001b[9;7H1\u001b[11;5H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m48  \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b[12;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1\u001b[13;7H2\u001b[14;"]
[43.834454, "o", "5H  3 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b[15;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m4\u001b[16;7H5\u001b[17;7H6\u001b[18;7H7\u001b[19;7H8\u001b[20;7H9\u001b[21;6H10\u001b[22;6H11\u001b[23;6H12\u001b[24;7H3\u001b[26;7H4\u001b[27;7H5\u001b[28;7H6\u001b[29;7H7\u001b[30;7H8\u001b[31;7H9\u001b[32;6H20\u001b[33;6H21\u001b[35;6H22\u001b[36;7H3\u001b[37;7H4\u001b[38;7H5\u001b[39;7H6\u001b[40;7H7\u001b[41;7H8\u001b[42;7H9\u001b[43;6H30\u001b[44;6H31\u001b[45;89H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m48\u001b[1;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[2;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[3;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[4;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26"]
[43.834553, "o", ";27;38m3 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m s\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                                                \u001b[5;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m2 \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mON\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m t\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mcustomer_id\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m s\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mjoin_key\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m natural key \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;57;75;112mfor\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m customer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                           "]
[43.834587, "o", "   \u001b[6;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[13;100H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[14;100H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[15;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[16;100H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m17  \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    \u001b(B\u001b[0;4m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mWHEN\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[0;4m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mMATCHED\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[0;4m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mAND\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m i"]
[43.834609, "o", "s_current \u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m=\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m true \u001b(B\u001b[0;4m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mAND\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m s\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[0;4m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdatetime_updated\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m>\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m t\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[0;4m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdatetime_updated\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m  \u001b[17;100H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mcondition to \u001b(B\u001b[0;4m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mUPDATE\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m most recent customers \u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112min\u001b("]
[43.83471, "o", "B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m dim_customer that have had updates\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m    \u001b[18;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mTHEN\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;31;34;49mUPDATE\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;31;34;49mSET\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m is_current \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;31;34;49m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m false\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;31;34;49m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m valid_to \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;31;34;49m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m s\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;31;34;49m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;31;34;49mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                  \u001b[40;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m--------------"]
[43.834736, "o", "-------------------------------------------------------------------------\u001b[41;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[42;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[43;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m2 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;57;75;112m·\u001b[43;105H·\u001b[43;106H·\u001b[43;107H·\u001b[43;108H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                                          \u001b[44;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m3 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mWHEN\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mNOT\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mMATCHED\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;"]
[43.834755, "o", "57;75;112m·\u001b[44;125H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                                  \r\u001b[40A\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  6 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# Union all the dataframes together\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[51X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  5 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112munion\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mempty_rows\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[4"]
[43.834866, "o", "8;2;31;34;49m\u001b[21X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  4 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  3 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Create a null join_key column\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[55X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2"]
[43.834945, "o", ";26;27;38mW \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mfrom\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mpyspark\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msql\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mfunctions\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mimport\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mlit\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[49X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[38;2;192;202;24"]
[43.834971, "o", "5m\u001b[48;2;32;48;59mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mwithColumn\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"join_key\"\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mlit\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;32;48;59mNone\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcast\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"string\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m))\u001b(B\u001b[m\u001b"]
[43.834991, "o", "[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[76X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m48  \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Union the two dataframes\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[60X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msource_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59munionByName\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2"]
[43.835117, "o", ";32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;32;48;59mallowMissingColumns\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  3 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  4 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# --- Perform the merge logic ---\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[53X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  5 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# 1. Update existing records\u001b(B\u001b[m\u001b[38;2;19"]
[43.835171, "o", "2;202;245m\u001b[48;2;32;48;59m\u001b[58X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  6 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# Condition: MATCHED AND is_current = true AND s.datetime_updated > t.datetime_updated\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  7 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# Action:\u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;31;34;49m UPDATE SET is_current = false, valid_to = s.datetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[16X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  8 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdated_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mdim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;25"]
[43.83522, "o", "5m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"t\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mjoin\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[41X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  9 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[20;10H   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msource_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[61X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m"]
[43.835269, "o", " 10 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[21;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"t.customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m==\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.join_key\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[40X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 11 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[22;10H   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"inner\"\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[75X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;2"]
[43.835319, "o", "6;27;38m 12 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mwhere\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[78X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;26;27;38mW \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 13 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[24;10H   \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"t.is_current\"\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m==\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mTrue\u001b(B\u001b[m\u001b[3"]
[43.83539, "o", "8;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m&\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.datetime_updated\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"t.datetime_updat\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[25;10H   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59med\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[77X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;"]
[43.835444, "o", "2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 14 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mselect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[77X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 15 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[27;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"t.*\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[71X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 16 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[28;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b"]
[43.835495, "o", "[48;2;32;48;59m\"s.datetime_updated\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s_datetime_updated\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[29X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 17 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[85X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 18 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 19 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Update the is_current and valid_to columns in dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[23X\r"]
[43.838163, "o", "\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 20 \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mdef\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mupdate_dim_customer\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[57X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 21 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[33;10H   \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mif\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mcustomer_id\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b"]
[43.838227, "o", "[38;2;192;202;245m\u001b[48;2;32;48;59mupdated_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mselect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mrdd\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mflatMap\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mlambda\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;32;48;59mx\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mx\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mco\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48"]
[43.838284, "o", ";2;32;48;59m▎\u001b[34;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mllect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m()\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[74X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 22 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[35;10H   ▎\u001b[35;14H   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;"]
[43.838376, "o", "2;32;48;59mis_current\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mFalse\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[56X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 23 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[36;10H   ▎\u001b[36;14H   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mvalid_to\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59ms_datetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[41X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 24 \u001b(B\u001b[m\u001b[38;2;"]
[43.8384, "o", "59;66;97m\u001b[48;2;32;48;59m▎\u001b[37;10H   \u001b(B\u001b[m\u001b[3m\u001b[38;2;157;124;216m\u001b[48;2;32;48;59mreturn\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[72X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 25 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 26 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Convert the DataFrame to an RDD and update the rows\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[33X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 27 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdated_rdd\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;"]
[43.838425, "o", "32;48;59mdim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mrdd\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mmap\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdate_dim_customer\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[28X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 28 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 29 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Convert the RDD back to a DataFrame\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[49X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 30 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdated_dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;2"]
[43.838453, "o", "45m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mspark\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcreateDataFrame\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdated_rdd\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mdim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mschema\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m  \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 31 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\u001b[33A\u001b[?25h"]
[43.852997, "o", "\u001b[?25l\u001b[46;180H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m{\u001b[11;9H\u001b[?25h"]
[43.871073, "o", "\u001b[?25l\u001b[46;180H \u001b[H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  9 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[85X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  8 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# Create empty rows of data based on this schema, one row for each element in the DF\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m  \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m--------------------------------------------------------------------------------------\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  7 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mempty_row\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;"]
[43.871133, "o", "255m\u001b[48;2;57;75;112m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;57;75;112mRow\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m*\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m([\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;57;75;112mNone\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m*\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;57;75;112mlen\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mcustomers_with_updates_schema\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                       \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m--------------------------------------------------------------------------------------\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b["]
[43.87127, "o", "m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  6 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mempty_rows\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mspark\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112mcreateDataFrame\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m([\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mempty_row\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m*\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112mcount\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m()\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mcusto\r\n\u001b(B\u001b[m\u001b[38;2;86;9"]
[43.871366, "o", "5;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mmers_with_updates_schema\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                             \u001b[8;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m5\u001b[9;7H4\u001b[10;7H3\u001b[11;7H2\u001b[12;7H1\u001b[13;5H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m44  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;41;46;66m                                                                                      \u001b[14;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1\u001b[16;7H3\u001b[18;5H  4 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b[19;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m5\u001b[20;7H6\u001b[21;7H7\u001b[22;7H8\u001b[23;7H9\u001b[24;6H10\u001b[25;6H11\u001b[26;6H12\u001b[27;6H13\u001b[28;7H4\u001b[29;7H5\u001b[30;7H6\u001b[31;7H7\u001b[33;7H8\u001b[34;7H9\u001b[35;6H20\u001b[36;6H21\u001b[37;6H22\u001b[38;6H23\u001b[39;7H4\u001b[40;7H5\u001b[42;7H6\u001b[43;7H7\u001b[44;7H8\u001b[45;90H\u001b(B\u001b[0;1m\u001b["]
[43.871392, "o", "38;2;21;22;30m\u001b[48;2;122;162;247m4\u001b[1;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    8 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[2;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    7 \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mMERGE\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mINTO\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m prod\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdb\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdim_customer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m t \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m target dim_customer to update\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                     \u001b[3;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    6 \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;"]
[43.871412, "o", "59mUSING\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                \u001b[4;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    5 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    select customer_id \u001b(B\u001b[m\u001b[3m\u001b[38;2;157;124;216m\u001b[48;2;57;75;112mas\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m join_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m*\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m from prod\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdb\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mcustomer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;57;75;112mNew\u001b(B\u001b[m\u001b[38;2;192;202"]
[43.871522, "o", ";245m\u001b[48;2;57;75;112m customers to be     \u001b[5;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mINSERTED\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m existing customers to be \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mUPDATED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                         \u001b[6;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    4 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m    union all                                                                          \u001b[7;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    3 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    select \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mNULL\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[3m\u001b[38;2;157;124;216m\u001b[48;2;57;75;112mas\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m join_k"]
[43.871549, "o", "ey\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m*\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m from customers_with_updates \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;57;75;112mExisting\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m customers\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m but  \u001b[8;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    updated values to be \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mINSERTED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                      \u001b[12;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m2\u001b[13;102H1\u001b[14;100H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m16  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;41;46;66m                                                                                   "]
[43.871567, "o", "    \u001b[24;100H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mWHEN\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mMATCHED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mAND\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m is_current \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m true \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mAND\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m s\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m t\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m  "]
[43.871694, "o", "\u001b[25;100H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    condition to \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mUPDATE\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m most recent customers \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m dim_customer that have had updates\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m    \u001b[26;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m2\u001b[9;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;"]
[43.871759, "o", "2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[10;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[11;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[12;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    2 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m s\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[K\u001b[13;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    1 \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mON\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;"]
[43.871818, "o", "2;57;75;112m t\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mcustomer_id\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m s\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mjoin_key\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m natural key \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;57;75;112mfor\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m customer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[K\u001b[14;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m16  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;41;46;66m\u001b[K\u001b[15;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[16;96"]
[43.871882, "o", "H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[17;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[18;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[19;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[20;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m-------------"]
[43.871946, "o", "--------------------------------------------------------------------------\u001b[21;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[22;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[23;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[24;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mWHEN\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mMATCHED\u001b(B\u001b[m\u001b[38"]
[43.872006, "o", ";2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mAND\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m is_current \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m true \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mAND\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m s\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m t\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m\u001b[K\u001b[25;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    condition to \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mUPDATE\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m most "]
[43.872066, "o", "recent customers \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m dim_customer that have had updates\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[K\u001b[26;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    2 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mTHEN\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;31;34;49mUPDATE\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;31;34;49mSET\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m is_current \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;31;34;49m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m false\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;31;34;49m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m valid_to \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;31;34;49m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m s\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;31;34;49m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;31;34;49mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[K\u001b[27;96H\u001b(B\u001b[m\u001b[38;"]
[43.872119, "o", "2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[28;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[29;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[30;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[31;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m-------------------------"]
[43.87218, "o", "--------------------------------------------------------------\u001b[32;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[33;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[34;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[35;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[36;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;"]
[43.872234, "o", "26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[37;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[38;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[39;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[40;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m------------------------------------------------------------------------------------"]
[43.872288, "o", "---\u001b[41;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[42;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[43;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[44;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\r\u001b[36A\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  5 \u001b(B\u001b[m"]
[43.872341, "o", "\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Drop join_key and then reorder\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[54X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  4 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mempty_rows\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mempty_rows\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mdrop\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"join_key\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[46X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  3 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mempty_rows\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245"]
[43.87241, "o", "m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mempty_rows\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mselect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mcolumns\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[35X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# Union all the dataframes together\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[51X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;192;202;2"]
[43.872461, "o", "45m\u001b[48;2;57;75;112mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112munion\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mempty_rows\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[21X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m44  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;41;46;66m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Create a null join_key column\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[55X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;26;27;38mW \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mfrom\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[5"]
[43.872515, "o", "8:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mpyspark\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msql\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mfunctions\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mimport\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:10"]
[43.872574, "o", "4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mlit\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[49X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  3 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mwithColumn\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"join_key\"\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mlit\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;32;48;59mNone\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b"]
[43.872648, "o", "[38;2;122;162;247m\u001b[48;2;32;48;59mcast\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"string\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[76X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  4 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  5 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Union the two dataframes\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[60X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  6 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msource_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b["]
[43.872699, "o", "m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59munionByName\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;32;48;59mallowMissingColumns\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  7 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  8 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# --- Perform the merge logic ---\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[53"]
[43.872755, "o", "X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  9 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# 1. Update existing records\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[58X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 10 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# Condition: MATCHED AND is_current = true AND s.datetime_updated > t.datetime_updated\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 11 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# Action:\u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;31;34;49m UPDATE SET is_current = false, valid_to = s.datetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[16X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 12 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdated_df\u001b(B\u001b[m\u001b[38;2;19"]
[43.872808, "o", "2;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mdim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"t\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mjoin\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[41X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 13 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[27;10H   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msource_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;5"]
[43.872862, "o", "9m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[61X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 14 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[28;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"t.customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m==\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.join_key\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[40X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 15 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[29;1"]
[43.872926, "o", "0H   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"inner\"\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[75X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 16 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mwhere\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[78X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;26;27;38mW \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 17 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[31;10H   \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"t.is_current\"\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B"]
[43.872977, "o", "\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m==\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m&\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.datetime_updated\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"t.datetime_updat\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[4"]
[43.873029, "o", "8;2;32;48;59m▎\u001b[32;10H   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59med\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[77X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 18 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mselect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[77X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 19 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[34;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"t.*\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[71X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;"]
[43.873083, "o", "27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 20 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[35;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.datetime_updated\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s_datetime_updated\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[29X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 21 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[85X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 22 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171"]
[43.873133, "o", "m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 23 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Update the is_current and valid_to columns in dim_customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[23X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 24 \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mdef\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mupdate_dim_customer\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[57X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 25 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[40;10H   \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mif\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;1"]
[43.873188, "o", "37;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mcustomer_id\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdated_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mselect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mrdd\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mflatMap\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mlambda\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;32;48;59mx\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mx\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;2"]
[43.873242, "o", "55m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mco\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[41;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mllect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m()\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m:\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[74X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 26 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[42;10H   ▎\u001b[42;14H   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mis_current\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mFalse\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[56X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;"]
[43.873296, "o", "157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 27 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[43;10H   ▎\u001b[43;14H   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mvalid_to\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2"]
[43.873364, "o", ";32;48;59ms_datetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[41X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 28 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[44;10H   \u001b(B\u001b[m\u001b[3m\u001b[38;2;157;124;216m\u001b[48;2;32;48;59mreturn\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mrow\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[72X\u001b[13;9H\u001b[?25h"]
[43.882367, "o", "\u001b[?25l\u001b[46;180H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m{\u001b[13;9H\u001b[?25h"]
[43.900169, "o", "\u001b[?25l\u001b[46;180H \u001b[H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  9 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mselect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"c.*\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                       \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  8 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  7 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# --- Union the dataframes for insertion/update ---\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;"]
[43.900218, "o", "32;48;59m                                   \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  6 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Add a 'join_key' column to customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                              \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  5 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mwithColumn\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"join_key\"\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;3"]
[43.900288, "o", "2;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                  \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  4 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  3 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Create a DataFrame from customers_with_updates and add a NULL join_key\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m              \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;26;27;38mW \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mfrom\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;5"]
[43.900378, "o", "9m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mpyspark\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msql\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mimport\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;42;195;222m\u001b[48;2;32;48;59mRow\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                           \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;26;27;38mW \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mfrom\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mpyspark\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::22"]
[43.900445, "o", "4:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msql\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mtypes\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mimport\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;42;195;222m\u001b[48;2;32;48;59mStructType\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;42;195;222m\u001b[48;2;32;48;59mStructField\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;42;195;222m\u001b[48;2;32;48;59mStringType\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;"]
[43.900509, "o", "32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;65;72;104m\u001b[48;2;32;48;59mBooleanType\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;65;72;104m\u001b[48;2;32;48;59mTimest\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;65;72;104m\u001b[48;2;32;48;59mampType\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;65;72;104m\u001b[48;2;32;48;59mIntegerType\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                  \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m30  \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                      "]
[43.900565, "o", "                                                \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Dynamically create schema for null values, handling all customer_df columns\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m         \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_schema\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mschema\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                  \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  3 \u001b(B\u001b[m\u001b[38;"]
[43.900622, "o", "2;192;202;245m\u001b[48;2;32;48;59mcustomers_with_updates_schema\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mStructType\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m([\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                          \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  4 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[15;10H   \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mStructField\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"join_key\"\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mStringType\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m()\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2"]
[43.900677, "o", ";32;48;59m)]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m+\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_schema\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mfields\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m             \u001b[16;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m5\u001b[17;7H6\u001b[21;7H8\u001b[23;7H9\u001b[24;6H10\u001b[25;6H11\u001b[26;6H1\u001b[27;6H13\u001b[28;5H 14 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[86X\u001b[29;6H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m15\u001b[30;6H16\u001b[31;6H17\u001b[33;6H18\u001b[34;6H19\u001b[35;6H20\u001b[36;6H21\u001b[37;6H22\u001b[38;6H23\u001b[39;6H24\u001b[40;6H25\u001b[41;6H26\u001b[42;6H27\u001b[43;6H28\u001b[44;6H29\u001b[45;89H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m30\u001b[1;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[2;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------"]
[43.900732, "o", "------------------------------------------------------\u001b[3;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[4;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[5;104H---------------------------------------------------------------------------------------\u001b[6;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[7;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[8;104H---------------------------------------------------------------------------------------\u001b[12;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b["]
[43.900786, "o", "48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[13;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[14;100H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[15;100H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m8   \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;41;46;66m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;41;46;66m                                                                                      \u001b[16;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1 \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mMERGE\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mINTO\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m prod\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdb\u001b(B\u001b[m\u001b[38;2;137;221;2"]
[43.900841, "o", "55m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdim_customer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m t \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m target dim_customer to update\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                     \u001b[17;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m2 \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mUSING\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;"]
[43.900902, "o", "48;59m                                                                                \u001b[18;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m3 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    select customer_id \u001b(B\u001b[m\u001b[3m\u001b[38;2;157;124;216m\u001b[48;2;57;75;112mas\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m join_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m*\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m from prod\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdb\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mcustomer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;57;75;112mNew\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m customers to be     \u001b[19;104H    \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mINSERTED\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;"]
[43.900959, "o", "245m\u001b[48;2;57;75;112m existing customers to be \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mUPDATED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                         \u001b[20;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m4 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m    union all                                                                          \u001b[21;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m5 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    select \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mNULL\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[3m\u001b[38;2;157;124;216m\u001b[48;2;57;75;112mas\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m join_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m*\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m from customers_with_updates \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;57;75;112mExisting\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m "]
[43.901011, "o", "customers\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m but  \u001b[22;104H    updated values to be \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mINSERTED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                      \u001b[24;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[25;104H---------------------------------------------------------------------------------------\u001b[26;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m6 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m s\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                              \u001b[27;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m7 \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mON\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m t\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b"]
[43.901077, "o", "[38;2;115;218;202m\u001b[48;2;57;75;112mcustomer_id\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m s\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mjoin_key\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m natural key \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;57;75;112mfor\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m customer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                              \u001b[28;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m8 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[38;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m9 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mWHEN\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mMATCHED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mAND\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;"]
[43.901108, "o", "57;75;112m is_current \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m true \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mAND\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m s\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m t\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m  \u001b[39;104H    condition to \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mUPDATE\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m most recent customers \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m dim_customer that have had updates\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m    \u001b[40;101H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m10 \u001b(B\u001b"]
[43.901182, "o", "[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mTHEN\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;31;34;49mUPDATE\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;31;34;49mSET\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m is_current \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;31;34;49m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m false\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;31;34;49m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m valid_to \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;31;34;49m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m s\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;31;34;49m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;31;34;49mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                  \r\u001b[24A\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  5 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[85X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;1"]
[43.901239, "o", "71m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  6 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# Create empty rows of data based on this schema, one row for each element in the DF\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m  \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m--------------------------------------------------------------------------------------\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  7 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mempty_row\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;57;75;112mRow\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m*\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m([\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;57;75;112mNone\u001b(B\u001b[m\u001b[38;"]
[43.901298, "o", "2;169;177;214m\u001b[48;2;57;75;112m]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m*\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;57;75;112mlen\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mcustomers_with_updates_schema\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[23X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m--------------------------------------------------------------------------------------\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  8 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mempty_rows\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mspark\u001b(B\u001b[m\u001b"]
[43.901359, "o", "[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112mcreateDataFrame\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m([\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mempty_row\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m*\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112mcount\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m()\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mcusto\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mmers_with_updates_schema\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[61X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38"]
[43.904185, "o", ";2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  9 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Drop join_key and then reorder\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[54X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 10 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mempty_rows\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mempty_rows\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mdrop\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"join_key\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[46X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 11 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mempty_rows\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[4"]
[43.904212, "o", "8;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mempty_rows\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mselect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mcolumns\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[35X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 12 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# Union all the dataframes together\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[51X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 13 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[4"]
[43.90423, "o", "8;2;57;75;112m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112munion\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mempty_rows\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[21X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 14 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 15 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Create a null join_key column\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[55X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;26;27;38mW \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 16 \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mfrom\u001b(B\u001b[m\u001b[4"]
[43.904286, "o", ":3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mpyspark\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msql\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mfunctions\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mimport\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mlit\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[49X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 17 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38"]
[43.904392, "o", ";2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mwithColumn\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"join_key\"\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mlit\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;32;48;59mNone\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcast\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"string\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[76X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38"]
[43.904416, "o", ";2;59;66;97m\u001b[48;2;26;27;38m 18 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 19 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Union the two dataframes\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[60X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 20 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msource_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59munionByName\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;32;48;59mallowMissingColumns\u001b(B\u001b[m"]
[43.904432, "o", "\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 21 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 22 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# --- Perform the merge logic ---\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[53X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 23 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# 1. Update existing records\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[58X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 24 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# Condition: MATCHED A"]
[43.904526, "o", "ND is_current = true AND s.datetime_updated > t.datetime_updated\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 25 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# Action:\u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;31;34;49m UPDATE SET is_current = false, valid_to = s.datetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[16X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 26 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mupdated_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mdim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"t\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2"]
[43.904579, "o", ";32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mjoin\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[41X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 27 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[42;10H   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msource_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[61X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 28 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[43;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"t.customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b"]
[43.904641, "o", "[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m==\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"s.join_key\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[40X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 29 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[44;10H   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"inner\"\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[75X\u001b[11;9H\u001b[?25h"]
[43.912466, "o", "\u001b[?25l\u001b[46;180H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m{\u001b[11;9H\u001b[?25h"]
[43.916171, "o", "\u001b[?25l\u001b[46;180H \u001b[H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  9 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[1;10H   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"inner\"\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                           \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  8 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mwhere\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                              \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  7 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;31;34;49m▎\u001b[3;10H   \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b"]
[43.916198, "o", "[48;2;57;75;112mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;57;75;112m\"c.datetime_updated\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;57;75;112m\"dc.datetime_updated\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m&\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m  \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# WHERE c.datetime_upd\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;57;75;112m▎\u001b[4;10H   \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112mated > dc.datetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                 "]
[43.91621, "o", "       \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;26;27;38mW \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  6 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;31;34;49m▎\u001b[5;10H   \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112mcol\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;158;206;106m\u001b[48;2;57;75;112m\"dc.is_current\"\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m==\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m  \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# AND dc.is_current = true\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                        \u001b"]
[43.916224, "o", "[6;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m5\u001b[7;7H4\u001b[8;7H3\u001b[9;7H2\u001b[10;7H1\u001b[11;5H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m26  \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b[12;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1\u001b[14;7H3\u001b[16;5H  4 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b[17;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m5\u001b[18;7H6\u001b[19;7H7\u001b[20;7H8\u001b[21;7H9\u001b[22;6H10\u001b[24;6H11\u001b[26;6H12\u001b[28;6H13\u001b[29;7H4\u001b[30;7H5\u001b[31;7H6\u001b[32;7H7\u001b[33;7H8\u001b[34;7H9\u001b[35;6H20\u001b[36;6H21\u001b[38;6H22\u001b[39;6H23\u001b[40;7H4\u001b[41;7H5\u001b[42;7H6\u001b[43;7H7\u001b[44;7H8\u001b[45;89H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m26\u001b[1;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[2;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;5"]
[43.916361, "o", "9;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[3;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    2 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mwhere c\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m dc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m ensure that the update \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m        \u001b[4;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b["]
[43.916381, "o", "38;2;192;202;245m\u001b[48;2;57;75;112m    upstream customer \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112mis\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m newer than the latest data \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m dim_customer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                    \u001b[5;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m    \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112mand\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m dc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mis_current\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m true \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m only look at the most current state of customer \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m     \u001b[6;96H\u001b(B\u001b["]
[43.916392, "o", "m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    dim_customer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                                       \u001b[44;188H\u001b(B\u001b[m\u001b[38;2;84;92;126m\u001b[48;2;26;27;38m@@@\u001b[7;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[8;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[9;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[10;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;5"]
[43.916401, "o", "9;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[11;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[12;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[13;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[14;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------"]
[43.916412, "o", "------------------\u001b[15;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[16;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[17;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[18;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[19;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[4"]
[43.916444, "o", "8;2;55;34;44m---------------------------------------------------------------------------------------\u001b[20;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[21;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m8   \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;41;46;66m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;41;46;66m\u001b[K\u001b[22;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    1 \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mMERGE\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mINTO\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m prod\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdb\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdim_customer\u001b(B\u001b[m\u001b[38;2;192;202"]
[43.91656, "o", ";245m\u001b[48;2;57;75;112m t \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m target dim_customer to update\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[K\u001b[23;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    2 \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mUSING\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[K\u001b[24;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    3 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    select customer_id \u001b(B\u001b[m\u001b[3m\u001b[38;2;157;124;216m\u001b[48;2;57;75;112mas\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m join_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m*\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m from prod\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdb\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b"]
[43.916578, "o", "[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mcustomer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;57;75;112mNew\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m customers to be\u001b[K\u001b[25;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mINSERTED\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m existing customers to be \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mUPDATED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[K\u001b[26;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    4 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m    union all\u001b[K\u001b[27;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    5 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    select \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mNULL\u001b(B\u001b[m\u001b["]
[43.916587, "o", "38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[3m\u001b[38;2;157;124;216m\u001b[48;2;57;75;112mas\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m join_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m*\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m from customers_with_updates \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;57;75;112mExisting\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m customers\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m but\u001b[K\u001b[28;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    updated values to be \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mINSERTED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[K\u001b[29;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m----------------------"]
[43.916598, "o", "-----------------------------------------------------------------\u001b[30;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[31;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[32;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    6 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m s\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[K\u001b[33;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    7 \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mON\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m t\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;2"]
[43.916616, "o", "02m\u001b[48;2;57;75;112mcustomer_id\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m s\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mjoin_key\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m natural key \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;57;75;112mfor\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m customer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[K\u001b[34;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    8 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[35;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[36;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34"]
[43.916704, "o", ";44m---------------------------------------------------------------------------------------\u001b[37;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[38;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[39;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[40;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[41;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  "]
[43.916754, "o", "\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[42;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[43;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[44;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    9 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mWHEN\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mMATCHED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mAND\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m is"]
[43.91678, "o", "_current \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m true \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mAND\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m s\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m t\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m-\u001b(B\u001b[m\u001b[38;2;84;92;126m\u001b[48;2;26;27;38m@@@\r\u001b[38A\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  5 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mselect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"c.*\"\u001b(B\u001b[m\u001b[38;2;169;177;214m"]
[43.916801, "o", "\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[71X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  4 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  3 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# --- Union the dataframes for insertion/update ---\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[35X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Add a 'join_key' column to customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[46X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B"]
[43.916883, "o", "\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mwithColumn\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"join_key\"\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[18X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m26  \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;"]
[43.9169, "o", "95;137m\u001b[48;2;32;48;59m# Create a DataFrame from customers_with_updates and add a NULL join_key\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[14X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;26;27;38mW \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mfrom\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mpyspark\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msql\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mimport\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;42;195;222m\u001b[48;2;32;48;59mRow\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[59X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;26;27"]
[43.916922, "o", ";38mW \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  3 \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mfrom\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mpyspark\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msql\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mtypes\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mimport\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;42;195;222m\u001b[48;2;32;48;59mStructType\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;42;195;222m\u001b[48;2;32;48;5"]
[43.917004, "o", "9mStructField\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;42;195;222m\u001b[48;2;32;48;59mStringType\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;65;72;104m\u001b[48;2;32;48;59mBooleanType\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;65;72;104m\u001b[48;2;32;48;59mTimest\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;65;72;104m\u001b[48;2;32;48;59mampType\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;65;72;10"]
[43.917024, "o", "4m\u001b[48;2;32;48;59mIntegerType\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[66X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  4 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  5 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Dynamically create schema for null values, handling all customer_df columns\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[9X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  6 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_schema\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mschema\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32"]
[43.917044, "o", ";48;59m\u001b[50X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  7 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomers_with_updates_schema\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mStructType\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m([\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[42X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  8 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[20;10H   \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mStructField\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"join_key\"\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mStringType\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m()\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b["]
[43.917125, "o", "m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m+\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_schema\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mfields\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[13X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  9 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[85X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 10 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# Create empty rows of data based on this schema, one row for each element in the DF\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m  \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48"]
[43.917172, "o", ";2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m--------------------------------------------------------------------------------------\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 11 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mempty_row\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;57;75;112mRow\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m*\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m([\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;57;75;112mNone\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m*\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;57;75;112mlen\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mcustomers_wit"]
[43.917218, "o", "h_updates_schema\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[23X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m--------------------------------------------------------------------------------------\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 12 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mempty_rows\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mspark\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112mcreateDataFrame\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m([\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mempty_row\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48"]
[43.917264, "o", ";2;57;75;112m*\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112mcount\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m()\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mcusto\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mmers_with_updates_schema\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[61X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 13 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Drop join_key and then reorder\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[54X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b"]
[43.917308, "o", "[48;2;26;27;38m 14 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mempty_rows\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mempty_rows\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mdrop\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"join_key\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[46X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 15 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mempty_rows\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mempty_rows\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mselect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;24"]
[43.917358, "o", "5m\u001b[48;2;32;48;59mcustomer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mcolumns\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[35X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 16 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# Union all the dataframes together\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[51X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 17 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112munion\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mempty_"]
[43.917407, "o", "rows\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[21X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 18 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 19 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Create a null join_key column\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[55X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;26;27;38mW \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 20 \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mfrom\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mpyspark\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msql\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m"]
[43.917452, "o", "\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mfunctions\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mimport\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mlit\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[49X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;"]
[43.917505, "o", "27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 21 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mwithColumn\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"join_key\"\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mlit\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;32;48;59mNone\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcast\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b"]
[43.917551, "o", "[48;2;32;48;59m\"string\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[76X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 22 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 23 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Union the two dataframes\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[60X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 24 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msource_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59munionByName\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m"]
[43.917595, "o", "\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;32;48;59mallowMissingColumns\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 25 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 26 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# --- Perform the merge logic ---\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[53X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 27 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# 1. Update existing records\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;"]
[43.917639, "o", "32;48;59m\u001b[58X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 28 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# Condition: MATCHED AND is_current = true AND s.datetime_updated > t.datetime_updated\u001b[11;9H\u001b[?25h"]
[43.943997, "o", "\u001b[?25l\u001b[46;180H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m{\u001b[11;9H\u001b[?25h"]
[43.950522, "o", "\u001b[?25l\u001b[46;180H \u001b[H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  8 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"c\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mjoin\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                 \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  7 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[2;10H   \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::"]
[43.95057, "o", "219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mdim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"dc\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                      \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  6 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;31;34;49m▎\u001b[3;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;57;75;112m\"c.customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m==\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b"]
[43.950677, "o", "[48;2;57;75;112m\"dc.customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m  \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# ON c.customer_id = dc.customer_i\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;57;75;112m▎\u001b[4;10H   \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112md\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                                                 \u001b[5;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m5\u001b[6;7H4\u001b[7;7H3\u001b[9;7H2\u001b[10;7H1\u001b[11;5H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m22  \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b[12;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1\u001b[14;7H3\u001b[15;5H  4 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                           "]
[43.950703, "o", "           \u001b[16;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m5\u001b[17;7H6\u001b[18;7H7\u001b[20;7H8\u001b[21;7H9\u001b[22;6H10\u001b[23;6H11\u001b[24;6H12\u001b[25;6H13\u001b[26;7H4\u001b[28;7H5\u001b[30;7H6\u001b[32;7H7\u001b[33;7H8\u001b[34;7H9\u001b[35;6H20\u001b[36;6H21\u001b[37;6H22\u001b[38;6H23\u001b[39;7H4\u001b[40;7H5\u001b[42;7H6\u001b[43;7H7\u001b[44;7H8\u001b[45;90H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m2\u001b[1;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[2;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[3;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    3 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mon c\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mcustomer_id\u001b(B"]
[43.950727, "o", "\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m dc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mcustomer_id\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;57;75;112mCustomer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m exists \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m dim_customer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m               \u001b[4;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[5;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------"]
[43.950826, "o", "------------------------\u001b[6;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    2 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mwhere c\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m dc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m ensure that the update \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m\u001b[K\u001b[7;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    upstream customer \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112mis\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;1"]
[43.950846, "o", "12m newer than the latest data \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m dim_customer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[K\u001b[8;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m    \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112mand\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m dc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mis_current\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m true \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m only look at the most current state of customer \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m\u001b[K\u001b[9;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    dim_customer\u001b(B\u001b[m\u001b[38;2;192;202"]
[43.95087, "o", ";245m\u001b[48;2;31;34;49m\u001b[K\u001b[10;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[11;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[12;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[13;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[14;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;24"]
[43.950963, "o", "5m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[15;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[16;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[17;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[18;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[19;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48"]
[43.950985, "o", ";2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[20;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[21;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2"]
[43.951104, "o", ";192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[22;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[23;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[24;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m8   \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;41;46;66m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;41;46;66m\u001b[K\u001b[25;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    1 \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mMERGE\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mINTO\u001b(B\u001b[m\u001b[38;2;1"]
[43.951159, "o", "92;202;245m\u001b[48;2;57;75;112m prod\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdb\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdim_customer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m t \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m target dim_customer to update\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[K\u001b[26;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    2 \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mUSING\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[K\u001b[27;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    3 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    select customer_id \u001b(B\u001b[m\u001b[3m\u001b[38;2;157;124;216m\u001b[48;2;57;75;112mas\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m join_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;"]
[43.951185, "o", "75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m*\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m from prod\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdb\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mcustomer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;57;75;112mNew\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m customers to be\u001b[K\u001b[28;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mINSERTED\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m existing customers to be \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mUPDATED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[K\u001b[29;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    4 \u001b(B\u001b[m\u001b[38;2;192;202"]
[43.951202, "o", ";245m\u001b[48;2;32;48;59m    union all\u001b[K\u001b[30;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    5 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    select \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mNULL\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[3m\u001b[38;2;157;124;216m\u001b[48;2;57;75;112mas\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m join_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m*\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m from customers_with_updates \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;57;75;112mExisting\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m customers\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m but\u001b[K\u001b[31;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    updated values to be \u001b(B\u001b[m\u001b[38;2;"]
[43.951292, "o", "255;158;100m\u001b[48;2;57;75;112mINSERTED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[K\u001b[32;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[33;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[34;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[35;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    6 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m s\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[K\u001b[36;96H\u001b("]
[43.951365, "o", "B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    7 \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mON\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m t\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mcustomer_id\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m s\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mjoin_key\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m natural key \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;57;75;112mfor\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m customer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[K\u001b[37;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    8 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[38;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;2"]
[43.951421, "o", "45m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[39;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[40;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[41;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[42;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[43;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[4"]
[43.951469, "o", "8;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[44;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\r\u001b[39A\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  5 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[5;10H   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"inner\"\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[75X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  4 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mwhere\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m"]
[43.951521, "o", "\u001b[78X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  3 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;31;34;49m▎\u001b[7;10H   \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;57;75;112m\"c.datetime_updated\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;57;75;112m\"dc.datetime_updated\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m&\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m  \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# WHERE c.datetime_upd\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b("]
[43.951572, "o", "B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;57;75;112m▎\u001b[8;10H   \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112mated > dc.datetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[56X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;26;27;38mW \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;31;34;49m▎\u001b[9;10H   \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112mcol\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;158;206;106m\u001b[48;2;57;75;112m\"dc.is_current\"\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m==\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mTrue\u001b(B\u001b[m\u001b[38;2;169;177;2"]
[43.951624, "o", "14m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m  \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# AND dc.is_current = true\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[24X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mselect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"c.*\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[71X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m22  \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86"]
[43.951669, "o", ";95;137m\u001b[48;2;32;48;59m# --- Union the dataframes for insertion/update ---\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[35X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Add a 'join_key' column to customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[46X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  3 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mwithColumn\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"join_key\"\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;5"]
[43.951715, "o", "9m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[18X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  4 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  5 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Create a DataFrame from customers_with_updates and add a NULL join_key\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[14X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;26;27;38mW \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  6 \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mfrom\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;"]
[43.951762, "o", "59mpyspark\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msql\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mimport\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;42;195;222m\u001b[48;2;32;48;59mRow\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[59X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38"]
[43.951833, "o", "m  \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;26;27;38mW \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  7 \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mfrom\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mpyspark\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msql\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mtypes\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mimport\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;42;195;222m\u001b[48;2;32;48;59mStructType\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:"]
[43.951881, "o", "175:104m\u001b[38;2;42;195;222m\u001b[48;2;32;48;59mStructField\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;42;195;222m\u001b[48;2;32;48;59mStringType\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;65;72;104m\u001b[48;2;32;48;59mBooleanType\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;65;72;104m\u001b[48;2;32;48;59mTimest\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;65;72;104m\u001b[48;2;32;48;59mampType\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b"]
[43.951931, "o", "[4:3m\u001b[58:2::224:175:104m\u001b[38;2;65;72;104m\u001b[48;2;32;48;59mIntegerType\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[66X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  8 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  9 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Dynamically create schema for null values, handling all customer_df columns\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[9X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 10 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_schema\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59m"]
[43.95198, "o", "schema\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[50X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 11 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomers_with_updates_schema\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mStructType\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m([\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[42X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 12 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[24;10H   \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mStructField\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"join_key\"\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mStringType\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m()\u001b(B\u001b[m\u001b"]
[43.952032, "o", "[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m+\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_schema\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mfields\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[13X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 13 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[85X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 14 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# Create empty rows of data based on this schema, one row for each element in the DF\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m  \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48"]
[43.952083, "o", ";2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m--------------------------------------------------------------------------------------\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 15 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mempty_row\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;57;75;112mRow\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m*\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m([\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;57;75;112mNone\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m*\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;57;75;112mlen\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;19"]
[43.952135, "o", "2;202;245m\u001b[48;2;57;75;112mcustomers_with_updates_schema\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[23X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m--------------------------------------------------------------------------------------\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 16 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mempty_rows\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mspark\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112mcreateDataFrame\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m([\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mempty_row\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;"]
[43.952186, "o", "57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m*\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112mcount\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m()\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mcusto\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mmers_with_updates_schema\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[61X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 17 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Drop join_key and then reorder\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[54X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b"]
[43.952237, "o", "[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 18 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mempty_rows\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mempty_rows\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mdrop\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"join_key\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[46X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 19 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mempty_rows\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mempty_rows\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mselect\u001b(B\u001b[m\u001b[38;2;169;177;214m"]
[43.952288, "o", "\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mcolumns\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[35X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 20 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# Union all the dataframes together\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[51X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 21 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112munion\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b["]
[43.952337, "o", "38;2;192;202;245m\u001b[48;2;57;75;112mempty_rows\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[21X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 22 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 23 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Create a null join_key column\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[55X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;26;27;38mW \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 24 \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mfrom\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mpyspark\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;4"]
[43.952397, "o", "8;59msql\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mfunctions\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mimport\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mlit\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[49X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 25 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mwithColumn\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;3"]
[43.952451, "o", "2;48;59m\"join_key\"\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mlit\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;32;48;59mNone\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcast\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"string\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[76X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 26 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 27 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Union the two"]
[43.952501, "o", " dataframes\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[60X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 28 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msource_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59munionByName\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;32;48;59mallowMissingColumns\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b[11;9H\u001b[?25h"]
[43.977211, "o", "\u001b[?25l\u001b[46;180H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m{\u001b[11;9H\u001b[?25h"]
[43.985095, "o", "\u001b[?25l\u001b[46;180H \u001b[H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  8 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Initialize SparkSession\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                             \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  7 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mspark\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;32;48;59mSparkSession\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mbuilder\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mappName\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"MergeInto\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b"]
[43.985183, "o", "(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mgetOrCreate\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m()\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                       \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  6 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  5 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# Define the source and target tables (replace with your actual table names and data l\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112moading)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                                               \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;"]
[43.985459, "o", "157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  4 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Assuming you have DataFrames named 'customer_df' (source) and 'dim_customer_df' (tar\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59mget)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                  \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  3 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# Example data loading (replace with your actual data loading logic):\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                 \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# customer_df = spark.read.table(\"prod.db.customer\")\u001b(B\u001b[m\u001b[38;"]
[43.985511, "o", "2;192;202;245m\u001b[48;2;31;34;49m                                  \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# dim_customer_df = spark.read.table(\"prod.db.dim_customer\")\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                          \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m12  \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# ---  customers_with_updates CTE equivalent ---\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                      \u001b[13;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m2\u001b[14;7H3\u001b[15;7H4\u001b[18;7H6\u001b[19;7H7\u001b[21;7H8\u001b[22;7H9\u001b[23;5H "]
[43.985688, "o", "10 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b[24;6H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1\u001b[25;6H1\u001b[26;6H1\u001b[27;6H1\u001b[28;6H1\u001b[29;6H1\u001b[30;6H1\u001b[32;6H1\u001b[33;6H1\u001b[34;6H2\u001b[35;6H2\u001b[36;6H2\u001b[37;6H2\u001b[38;6H2\u001b[40;6H2\u001b[42;6H2\u001b[44;6H2\u001b[45;89H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m1\u001b[1;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[2;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[3;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[4;96H"]
[43.985801, "o", "\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    4 \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;57;75;112mWith\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m customers_with_updates \u001b(B\u001b[m\u001b[3m\u001b[38;2;157;124;216m\u001b[48;2;57;75;112mas\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                       \u001b[5;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[6;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    3 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mselect c\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.*\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                                             \u001b[7;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48"]
[43.985941, "o", ";2;26;27;38m    2 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    from prod\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdb\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mcustomer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m c\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                            \u001b[8;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    join prod\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdb\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdim_customer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m dc\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                       \u001b[9;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------"]
[43.98606, "o", "------------------------------------------------------------------\u001b[10;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[13;100H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m5   \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m    \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mon c\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[0;4m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mcustomer_id\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m=\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m dc\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[0;4m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mcustomer_id\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[0;4m\u001b[38;2;42;195;222m\u001b[48;2;57;75;112mCustomer\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m ex"]
[43.986195, "o", "ists \u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112min\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m dim_customer\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m               \u001b[16;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1\u001b[18;102H2\u001b[34;100H  3 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[35;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m4\u001b[36;102H5\u001b[37;102H6\u001b[39;102H7\u001b[40;102H8\u001b[11;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[12;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[13;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m5   \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[4"]
[43.986337, "o", "8;2;31;34;49m    \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mon c\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[0;4m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mcustomer_id\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m=\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m dc\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[0;4m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mcustomer_id\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[0;4m"]
[43.986486, "o", "\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[0;4m\u001b[38;2;42;195;222m\u001b[48;2;57;75;112mCustomer\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m exists \u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112min\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m dim_customer\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m               \u001b[14;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[15;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[16;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mwhere c\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdate"]
[43.986569, "o", "time_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m dc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m ensure that the update \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m\u001b[K\u001b[17;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    upstream customer \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112mis\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m newer than the latest data \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m dim_customer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[K\u001b[18;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    2 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2"]
[43.986654, "o", ";31;34;49m    \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112mand\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m dc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mis_current\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m true \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m only look at the most current state of customer \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m\u001b[K\u001b[19;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    dim_customer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[K\u001b[20;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[21;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b("]
[43.986739, "o", "B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[22;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[23;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[24;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[25;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------"]
[43.986838, "o", "------------------------------\u001b[26;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[27;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[28;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[29;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[30;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;"]
[43.986945, "o", "202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[31;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[32;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[33;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[34;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    3 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[35;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m"]
[43.987036, "o", "\u001b[48;2;26;27;38m    4 \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mMERGE\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mINTO\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m prod\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdb\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdim_customer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m t \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m target dim_customer to update\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[K\u001b[36;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    5 \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mUSING\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[K\u001b[37;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    6 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    select customer_id \u001b(B\u001b["]
[43.987128, "o", "m\u001b[3m\u001b[38;2;157;124;216m\u001b[48;2;57;75;112mas\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m join_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m*\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m from prod\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdb\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mcustomer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;57;75;112mNew\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m customers to be\u001b[K\u001b[38;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mINSERTED\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m existing customers to be \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57"]
[43.987217, "o", ";75;112mUPDATED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[K\u001b[39;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    7 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m    union all\u001b[K\u001b[40;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    8 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    select \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mNULL\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[3m\u001b[38;2;157;124;216m\u001b[48;2;57;75;112mas\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m join_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m*\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m from customers_with_updates \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;57;75;112mExisting\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m customers\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m but\u001b[K\u001b"]
[43.987307, "o", "[41;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    updated values to be \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mINSERTED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[K\u001b[42;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[43;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[44;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\r\u001b[31A\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;9"]
[43.987419, "o", "7m\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"c\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mjoin\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[33X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  3 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[14;10H   \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mdim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias"]
[43.987522, "o", "\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"dc\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[54X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  4 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;31;34;49m▎\u001b[15;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;57;75;112m\"c.customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m==\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;57;75;112m\"dc.customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m  \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;"]
[43.987599, "o", "57;75;112m# ON c.customer_id = dc.customer_i\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;57;75;112m▎\u001b[16;10H   \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112md\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[81X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  5 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[17;10H   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"inner\"\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[75X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  6 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mwhere\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[78X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b["]
[43.987681, "o", "38;2;59;66;97m\u001b[48;2;26;27;38m  7 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;31;34;49m▎\u001b[19;10H   \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;57;75;112m\"c.datetime_updated\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112mcol\u001b(B\u001b[m\u001b[38;2;169"]
[43.987819, "o", ";177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;57;75;112m\"dc.datetime_updated\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m&\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m  \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# WHERE c.datetime_upd\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;57;75;112m▎\u001b[20;10H   \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112mated > dc.datetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[56X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;26;27;38mW \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  8 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;31;34;49m▎\u001b[21;10H   \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112mcol\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;"]
[43.98791, "o", "2;158;206;106m\u001b[48;2;57;75;112m\"dc.is_current\"\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m==\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m  \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# AND dc.is_current = true\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[24X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  9 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mselect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"c.*\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;"]
[43.987995, "o", "59m\u001b[71X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 10 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 11 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# --- Union the dataframes for insertion/update ---\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[35X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 12 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Add a 'join_key' column to customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[46X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 13 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58"]
[43.988081, "o", ":2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mwithColumn\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"join_key\"\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[18X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 14 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 15 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Create a DataFrame from customers_with_updates and add a NULL join_key\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[14X\r\n\u001b("]
[43.98816, "o", "B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;26;27;38mW \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 16 \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mfrom\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mpyspark\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msql\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mimport\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;42;195;222m\u001b[48;2;32;48;59mRow\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[59X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;26;27;38mW \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 17 \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mfrom\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:17"]
[43.988248, "o", "5:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mpyspark\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msql\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mtypes\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mimport\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;42;195;222m\u001b[48;2;32;48;59mStructType\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;42;195;222m\u001b[48;2;32;48;59mStructField\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;"]
[43.988332, "o", "59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;42;195;222m\u001b[48;2;32;48;59mStringType\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;65;72;104m\u001b[48;2;32;48;59mBooleanType\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;65;72;104m\u001b[48;2;32;48;59mTimest\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;65;72;104m\u001b[48;2;32;48;59mampType\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;65;72;104m\u001b[48;2;32;48;59mIntegerType\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[66X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[4"]
[43.988445, "o", "8;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 18 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 19 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Dynamically create schema for null values, handling all customer_df columns\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[9X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 20 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_schema\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mschema\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[50X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 21 \u001b(B\u001b[m"]
[43.988532, "o", "\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomers_with_updates_schema\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mStructType\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m([\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[42X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 22 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[36;10H   \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mStructField\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"join_key\"\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mStringType\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m()\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)]\u001b(B\u001b[m\u001b[38;2;192;202"]
[43.98861, "o", ";245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m+\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_schema\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mfields\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[13X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 23 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[85X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 24 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# Create empty rows of data based on this schema, one row for each element in the DF\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m  \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m------------------------------------------------"]
[43.988692, "o", "--------------------------------------\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 25 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mempty_row\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;57;75;112mRow\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m*\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m([\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;57;75;112mNone\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m*\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;57;75;112mlen\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mcustomers_with_updates_schema\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[23X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;"]
[43.98877, "o", "38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m--------------------------------------------------------------------------------------\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 26 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mempty_rows\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mspark\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112mcreateDataFrame\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m([\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mempty_row\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m*\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;137;221;255"]
[43.988853, "o", "m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112mcount\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m()\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mcusto\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mmers_with_updates_schema\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[61X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 27 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Drop join_key and then reorder\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[54X\u001b[11;9H\u001b[?25h"]
[44.009928, "o", "\u001b[?25l\u001b[46;180H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m{\u001b[11;9H\u001b[?25h"]
[44.02253, "o", "\u001b[?25l\u001b[46;180H \u001b[H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;145;76;84m\u001b[48;2;26;27;38m‾\u001b[1;4H \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  5 \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mfrom\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mpyspark\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msql\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mimport\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;32;48;59mSparkSession\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                  \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  4 \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mfrom\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mpyspark\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msql\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;"]
[44.022605, "o", "2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mfunctions\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mimport\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mlit\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                            \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  3 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b[4;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m2\u001b[5;7H1\u001b[6;5H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m6   \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b[7;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1\u001b[9;7H2\u001b[12;7H4\u001b[13;7H5\u001b[14;5H  6 \u001b(B\u001b["]
[44.0228, "o", "m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b[15;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m7\u001b[16;7H8\u001b[17;7H9\u001b[18;6H10\u001b[20;6H11\u001b[21;6H12\u001b[22;6H13\u001b[24;6H14\u001b[25;6H15\u001b[26;7H6\u001b[27;7H7\u001b[28;7H8\u001b[29;7H9\u001b[30;6H20\u001b[31;6H21\u001b[32;6H22\u001b[33;6H23\u001b[35;6H24\u001b[36;6H25\u001b[37;7H6\u001b[38;7H7\u001b[39;7H8\u001b[40;7H9\u001b[41;6H30\u001b[43;6H31\u001b[45;89H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m 6\u001b[4;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[6;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[7;100H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m1   \u001b(B\u001b[0;4m\u001b[38;2;42;195;222m\u001b[48;2;57;75;112mWith\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m customers_with_updates \u001b(B\u001b[0;4m\u001b[3m\u001b[38;2;157;124;216m\u001b[48;2;57;75;112mas\u001b(B\u001b[0;4m\u001b[38;2;192;"]
[44.022867, "o", "202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[0;4m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                       \u001b[8;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[9;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mselect c\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.*\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                                             \u001b[10;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m2 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    from prod\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdb\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mcustomer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m c\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                "]
[44.023052, "o", "            \u001b[11;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m3 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    join prod\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdb\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdim_customer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m dc\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                       \u001b[13;100H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[16;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m4 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mon c\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mcustomer_id\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m dc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75"]
[44.023106, "o", ";112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mcustomer_id\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;57;75;112mCustomer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m exists \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m dim_customer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m               \u001b[17;104H\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[18;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[19;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m5 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mwhere c\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;24"]
[44.023284, "o", "5m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m dc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m ensure that the update \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m        \u001b[20;104H    upstream customer \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112mis\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m newer than the latest data \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m dim_customer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                    \u001b[21;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m6 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m    \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112mand\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m dc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;7"]
[44.023409, "o", "5;112mis_current\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m true \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m only look at the most current state of customer \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m     \u001b[22;104H    dim_customer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                                       \u001b[34;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[35;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\u001b[36;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m-------------------------------------------------------------------"]
[44.023457, "o", "--------------------\u001b[37;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m7 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[38;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m8 \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mMERGE\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mINTO\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m prod\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdb\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdim_customer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m t \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m target dim_customer to update\u001b[39;102H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m9 \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mUSING\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m      \u001b[40;101H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m10 \u001b(B\u001b[m\u001b[38;2;192"]
[44.023622, "o", ";202;245m\u001b[48;2;57;75;112m    select customer_id \u001b(B\u001b[m\u001b[3m\u001b[38;2;157;124;216m\u001b[48;2;57;75;112mas\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m join_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m*\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m from prod\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdb\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mcustomer\u001b(B"]
[44.023822, "o", "\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;57;75;112mNew\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m customers to be   \u001b[41;108H\u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mINSERTED\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m existing customers to be \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mUPDATED\u001b[42;101H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m11 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m    union all                                                                          \u001b[43;101H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m12 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    select \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mNULL\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[3m\u001b[38;2;157;124;216m\u001b[48;2;57;75;112mas\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m join_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;2"]
[44.02388, "o", "21;255m\u001b[48;2;57;75;112m*\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m from customers_with_updates \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;57;75;112mExisting\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m customers\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m but  \u001b[44;104H    updated values to be \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mINSERTED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                      \r\u001b[40A\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Initialize SparkSession\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[61X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mspark\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38"]
[44.024045, "o", ";2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;32;48;59mSparkSession\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mbuilder\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mappName\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"MergeInto\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mgetOrCreate\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m()\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[23X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m6   \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[3"]
[44.024138, "o", "m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# Define the source and target tables (replace with your actual table names and data l\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112moading)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[79X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Assuming you have DataFrames named 'customer_df' (source) and 'dim_customer_df' (tar\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59mget)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[82X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  3 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# Example data loading (replace with"]
[44.024234, "o", " your actual data loading logic):\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[17X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  4 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# customer_df = spark.read.table(\"prod.db.customer\")\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[34X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  5 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# dim_customer_df = spark.read.table(\"prod.db.dim_customer\")\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[26X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  6 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  7 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# ---  customers_with_updates CTE equivalent ---\u001b(B\u001b[m\u001b["]
[44.024326, "o", "38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[38X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  8 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"c\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mjoin\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[33X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  9 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[17;10H   \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75"]
[44.024473, "o", ":75m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mdim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"dc\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[54X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 10 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;31;34;49m▎\u001b[18;10H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;57;75;112m\"c.customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m==\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;57;75;112m\"dc.customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;2"]
[44.024611, "o", "14m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m  \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# ON c.customer_id = dc.customer_i\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;57;75;112m▎\u001b[19;10H   \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112md\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[81X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 11 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[20;10H   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"inner\"\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[75X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 12 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mwhere\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;5"]
[44.024745, "o", "9m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[78X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 13 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;31;34;49m▎\u001b[22;10H   \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;57;75;112m\"c.datetime_updated\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;57;75;112m\"dc.datetime_updated\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m&\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m  \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# WHERE c.datetime_upd\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38"]
[44.024858, "o", "m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;57;75;112m▎\u001b[23;10H   \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112mated > dc.datetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[56X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;26;27;38mW \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 14 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;31;34;49m▎\u001b[24;10H   \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112mcol\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;158;206;106m\u001b[48;2;57;75;112m\"dc.is_current\"\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m==\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;255;158;"]
[44.024968, "o", "100m\u001b[48;2;57;75;112mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m  \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# AND dc.is_current = true\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[24X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 15 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mselect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"c.*\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[71X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 16 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 17 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# --- Union the dat"]
[44.025075, "o", "aframes for insertion/update ---\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[35X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 18 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Add a 'join_key' column to customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[46X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 19 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mwithColumn\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"join_key\"\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59"]
[44.025198, "o", "mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[18X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 20 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 21 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Create a DataFrame from customers_with_updates and add a NULL join_key\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[14X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;26;27;38mW \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 22 \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mfrom\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mpyspark\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b"]
[44.025337, "o", "[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msql\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mimport\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;42;195;222m\u001b[48;2;32;48;59mRow\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[59X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;26;27;38"]
[44.02549, "o", "mW \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 23 \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mfrom\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mpyspark\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msql\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mtypes\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mimport\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;42;195;222m\u001b[48;2;32;48;59mStructType\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;42;195;222m\u001b[48;2;32;48;59mS"]
[44.02563, "o", "tructField\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;42;195;222m\u001b[48;2;32;48;59mStringType\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;65;72;104m\u001b[48;2;32;48;59mBooleanType\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;65;72;104m\u001b[48;2;32;48;59mTimest\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;65;72;104m\u001b[48;2;32;48;59mampType\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;65;72;104m\u001b"]
[44.025786, "o", "[48;2;32;48;59mIntegerType\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[66X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 24 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[86X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 25 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Dynamically create schema for null values, handling all customer_df columns\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[9X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 26 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_schema\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mschema\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48"]
[44.025923, "o", ";59m\u001b[50X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 27 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomers_with_updates_schema\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mStructType\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m([\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[42X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 28 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[39;10H   \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mStructField\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"join_key\"\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mStringType\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m()\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b["]
[44.026062, "o", "38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m+\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_schema\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mfields\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m\u001b[13X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 29 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[85X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 30 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# Create empty rows of data based on this schema, one row for each element in the DF\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m  \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;"]
[44.026194, "o", "26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m--------------------------------------------------------------------------------------\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 31 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mempty_row\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;57;75;112mRow\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m*\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m([\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;57;75;112mNone\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m*\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;57;75;112mlen\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mcustomers_with_u"]
[44.026332, "o", "pdates_schema\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m\u001b[23X\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m--------------------------------------------------------------------------------------\u001b[6;9H\u001b[?25h"]
[44.035986, "o", "\u001b[?25l\u001b[46;180H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m{\u001b[6;9H\u001b[?25h"]
[44.037676, "o", "\u001b[?25l\u001b[46;180H \u001b[1;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m2\u001b[2;7H1\u001b[3;5H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m3   \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b[4;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1\u001b[5;7H2\u001b[6;5H  3 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b[7;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m4\u001b[9;7H5\u001b[11;7H6\u001b[12;7H7\u001b[13;7H8\u001b[14;7H9\u001b[15;6H10\u001b[16;6H11\u001b[17;6H12\u001b[18;7H3\u001b[20;7H4\u001b[21;7H5\u001b[22;7H6\u001b[24;7H7\u001b[25;7H8\u001b[26;7H9\u001b[27;6H20\u001b[28;6H21\u001b[29;6H22\u001b[30;7H3\u001b[31;7H4\u001b[32;7H5\u001b[33;7H6\u001b[35;7H7\u001b[36;7H8\u001b[37;7H9\u001b[38;6H30\u001b[39;6H31\u001b[40;6H32\u001b[41;7H3\u001b[43;7H4\u001b[45;90H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m3\u001b[3;9H\u001b[?25h"]
[44.083341, "o", "\u001b[?25l\u001b[46;180H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m{\u001b[3;9H\u001b[?25h"]
[44.084696, "o", "\u001b[?25l\u001b[46;180H \u001b[1;5H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m1   \u001b(B\u001b[0;4m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mfrom\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mpyspark\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msql\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[0;4m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mimport\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[0;4m\u001b[38;2;42;195;222m\u001b[48;2;32;48;59mSparkSession\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                  \u001b[3;5H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b[4;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m3\u001b[5;7H4\u001b[6;7H5\u001b[7;7H6\u001b[9;7H7\u001b[11;7H8\u001b[12;7H9\u001b[13;6H10\u001b[14;6H11\u001b[15;7H2\u001b[16;7H3\u001b[17;7H4\u001b[18;7H5\u001b[20;7H6\u001b[21;7H7\u001b[22;7H8\u001b[24;7H9\u001b[25;6H20\u001b[26;6H21\u001b[27;7H2\u001b[28;7H3\u001b[29;7H4\u001b[30;7H5\u001b[31;7H6\u001b[32;7H7\u001b[33;7H8\u001b[35;7H9\u001b"]
[44.084747, "o", "[36;6H30\u001b[37;6H31\u001b[38;7H2\u001b[39;7H3\u001b[40;7H4\u001b[41;7H5\u001b[43;7H6\u001b[45;90H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m1\u001b[1;9H\u001b[?25h"]
[44.096684, "o", "\u001b[?25l\u001b[46;180H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m{\u001b[1;9H\u001b[?25h\u001b[?25l\u001b[46;180H \u001b[1;9H\u001b[?25h"]
[44.125725, "o", "\u001b[?25l\u001b[46;180H{\u001b[1;9H\u001b[?25h\u001b[?25l\u001b[46;180H \u001b[1;9H\u001b[?25h"]
[44.156181, "o", "\u001b[?25l\u001b[46;180H{\u001b[1;9H\u001b[?25h\u001b[?25l\u001b[46;180H \u001b[1;9H\u001b[?25h"]
[44.191849, "o", "\u001b[?25l\u001b[46;180H{\u001b[1;9H\u001b[?25h\u001b[?25l\u001b[46;180H \u001b[1;9H\u001b[?25h"]
[44.227828, "o", "\u001b[?25l\u001b[46;180H{\u001b[1;9H\u001b[?25h\u001b[?25l\u001b[46;180H \u001b[1;9H\u001b[?25h"]
[44.265138, "o", "\u001b[?25l\u001b[46;180H{\u001b[1;9H\u001b[?25h\u001b[?25l\u001b[46;180H \u001b[1;9H\u001b[?25h"]
[45.833456, "o", "\u001b[?25l\u001b[46;180Hj\u001b[1;9H\u001b[?25h"]
[45.840342, "o", "\u001b[?25l\u001b[46;180H \u001b[1;5H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mfrom\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mpyspark\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msql\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mimport\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;32;48;59mSparkSession\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                  \u001b[2;5H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m2   \u001b(B\u001b[0;4m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mfrom\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mpyspark\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msql\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mfunctions\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[0;4m\u001b[38;2;125;207;255m\u001b[48"]
[45.840603, "o", ";2;32;48;59mimport\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mlit\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcol\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                            \u001b[3;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1\u001b[4;7H2\u001b[5;7H3\u001b[6;7H4\u001b[7;7H5\u001b[9;7H6\u001b[11;7H7\u001b[12;7H8\u001b[13;6H 9\u001b[14;7H0\u001b[15;7H1\u001b[16;7H2\u001b[17;7H3\u001b[18;7H4\u001b[20;7H5\u001b[21;7H6\u001b[22;7H7\u001b[24;7H8\u001b[25;6H19\u001b[26;7H0\u001b[27;7H1\u001b[28;7H2\u001b[29;7H3\u001b[30;7H4\u001b[31;7H5\u001b[32;7H6\u001b[33;7H7\u001b[35;7H8\u001b[36;6H29\u001b[37;7H0\u001b[38;7H1\u001b[39;7H2\u001b[40;7H3\u001b[41;7H4\u001b[43;7H5\u001b[45;90H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m2\u001b[2;9H\u001b[?25h"]
[46.031269, "o", "\u001b[?25l\u001b[46;180H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38mj\u001b[2;9H\u001b[?25h"]
[46.041778, "o", "\u001b[?25l\u001b[46;180H \u001b[1;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m2\u001b[2;5H  1 \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mfrom\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mpyspark\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msql\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mfunctions\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mimport\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mlit\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                            \u001b[3;5H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m3   \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b[4;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1\u001b[5;7H2\u001b[6;7H3\u001b[7;7H4\u001b["]
[46.04209, "o", "9;7H5\u001b[11;7H6\u001b[12;7H7\u001b[13;7H8\u001b[14;6H 9\u001b[15;7H0\u001b[16;7H1\u001b[17;7H2\u001b[18;7H3\u001b[20;7H4\u001b[21;7H5\u001b[22;7H6\u001b[24;7H7\u001b[25;7H8\u001b[26;6H19\u001b[27;7H0\u001b[28;7H1\u001b[29;7H2\u001b[30;7H3\u001b[31;7H4\u001b[32;7H5\u001b[33;7H6\u001b[35;7H7\u001b[36;7H8\u001b[37;6H29\u001b[38;7H0\u001b[39;7H1\u001b[40;7H2\u001b[41;7H3\u001b[43;7H4\u001b[45;90H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m3\u001b[3;9H\u001b[?25h"]
[46.192195, "o", "\u001b[?25l\u001b[46;180H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38mj\u001b[3;9H\u001b[?25h"]
[46.203278, "o", "\u001b[?25l\u001b[46;180H \u001b[1;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m3\u001b[2;7H2\u001b[3;5H  1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b[4;5H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m4   \u001b(B\u001b[0;4m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Initialize SparkSession\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                             \u001b[5;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1\u001b[6;7H2\u001b[7;7H3\u001b[9;7H4\u001b[11;7H5\u001b[12;7H6\u001b[13;7H7\u001b[14;7H8\u001b[15;6H 9\u001b[16;7H0\u001b[17;7H1\u001b[18;7H2\u001b[20;7H3\u001b[21;7H4\u001b[22;7H5\u001b[24;7H6\u001b[25;7H7\u001b[26;7H8\u001b[27;6H19\u001b[28;7H0\u001b[29;7H1\u001b[30;7H2\u001b[31;7H3\u001b[32;7H4\u001b[33;7H5\u001b[35;7H6\u001b[36;7H7\u001b[37;7H8\u001b[38;6H29\u001b[39;7H0\u001b[40;7H1\u001b[41;7H2\u001b[43;7H3\u001b[45;90H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m4\u001b[4;9H\u001b[?25h"]
[46.355414, "o", "\u001b[?25l\u001b[46;180H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38mj\u001b[4;9H\u001b[?25h"]
[46.369322, "o", "\u001b[?25l\u001b[46;180H \u001b[1;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m4\u001b[2;7H3\u001b[3;7H2\u001b[4;5H  1 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Initialize SparkSession\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                             \u001b[5;5H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m5   \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mspark\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[0;4m\u001b[38;2;42;195;222m\u001b[48;2;32;48;59mSparkSession\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[0;4m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mbuilder\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[0;4m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mappName\u001b(B\u001b[0;4m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[0;4m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"MergeInto\"\u001b(B\u001b[0;4m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[0;4m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[0;4m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mgetOrCreate\u001b(B\u001b[0;4m\u001b[38;2;169;177;214m\u001b[48;2;32;4"]
[46.369685, "o", "8;59m()\u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                       \u001b[6;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1\u001b[7;7H2\u001b[9;7H3\u001b[11;7H4\u001b[12;7H5\u001b[13;7H6\u001b[14;7H7\u001b[15;7H8\u001b[16;6H 9\u001b[17;7H0\u001b[18;7H1\u001b[20;7H2\u001b[21;7H3\u001b[22;7H4\u001b[24;7H5\u001b[25;7H6\u001b[26;7H7\u001b[27;7H8\u001b[28;6H19\u001b[29;7H0\u001b[30;7H1\u001b[31;7H2\u001b[32;7H3\u001b[33;7H4\u001b[35;7H5\u001b[36;7H6\u001b[37;7H7\u001b[38;7H8\u001b[39;6H29\u001b[40;7H0\u001b[41;7H1\u001b[43;7H2\u001b[45;90H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m5\u001b[5;9H\u001b[?25h"]
[46.5544, "o", "\u001b[?25l\u001b[46;180H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38mj\u001b[5;9H\u001b[?25h"]
[46.566319, "o", "\u001b[?25l\u001b[46;180H \u001b[1;7H\u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m5\u001b[2;7H4\u001b[3;7H3\u001b[4;7H2\u001b[5;5H  1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mspark\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;32;48;59mSparkSession\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mbuilder\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mappName\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"MergeInto\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mgetOrCreate\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m()\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                       \u001b[6;5H\u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m6   \u001b(B\u001b[0;4m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b[7;7H\u001b"]
[46.566701, "o", "(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m1\u001b[9;7H2\u001b[11;7H3\u001b[12;7H4\u001b[13;7H5\u001b[14;7H6\u001b[15;7H7\u001b[16;7H8\u001b[17;6H 9\u001b[18;7H0\u001b[20;7H1\u001b[21;7H2\u001b[22;7H3\u001b[24;7H4\u001b[25;7H5\u001b[26;7H6\u001b[27;7H7\u001b[28;7H8\u001b[29;6H19\u001b[30;7H0\u001b[31;7H1\u001b[32;7H2\u001b[33;7H3\u001b[35;7H4\u001b[36;7H5\u001b[37;7H6\u001b[38;7H7\u001b[39;7H8\u001b[40;6H29\u001b[41;7H0\u001b[43;7H1\u001b[45;90H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m6\u001b[6;9H\u001b[?25h"]
[47.159414, "o", "\u001b[?25l\u001b[46;180H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38mg\u001b[6;9H\u001b[?25h"]
[47.473275, "o", "\u001b[?25l\u001b[46;180H \u001b[6;9H\u001b[?25h"]
[47.50239, "o", "\u001b[?25l\r\u001b[13B\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                                                                                                                                                                              \r\n  \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;22;22;30ma \u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;22;22;30m➜ \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;22;22;30m󰌠\u001b[20;8H \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;22;22;30mAccept change                                                                             \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                                                                            \r\n  \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;22;22;30md \u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;22;22;30m➜ \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;22;22;30m󰌠\u001b[21;8H \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;22;22;30mLSP: [G]oto [D]efinition                                                                  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                                           "]
[47.502568, "o", "                                 \r\n  \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;22;22;30mD \u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;22;22;30m➜ \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;22;22;30m󰌠\u001b[22;8H \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;22;22;30mLSP: [G]oto [D]eclaration                                                                 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                                                                            \r\n  \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;22;22;30mI \u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;22;22;30m➜ \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;22;22;30m󰌠\u001b[23;8H \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;22;22;30mLSP: [G]oto [I]mplementation                                                              \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                                                                            \r\n  \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;22;22;30mr \u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;22;22;30m➜ \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;22;22;30m󰌠\u001b[24;8H \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;22"]
[47.502712, "o", ";22;30m+Reject change                                                                            \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                                                                            \r\n  \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;22;22;30me \u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;22;22;30m➜ \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m  \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;22;22;30mPrev end of word                                                                          \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                                                                            \r\n  \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;22;22;30mf \u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;22;22;30m➜ \u001b(B\u001b[m\u001b[38;2;26;188;156m\u001b[48;2;22;22;30m󰈔\u001b[26;8H \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;22;22;30mGo to file under cursor                                                                   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                                                                   "]
[47.502807, "o", "         \r\n  \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;22;22;30mg \u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;22;22;30m➜ \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m  \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;22;22;30mFirst line                                                                                \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                                                                            \r\n  \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;22;22;30mi \u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;22;22;30m➜ \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m  \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;22;22;30mGo to last insert                                                                         \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                                                                            \r\n  \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;22;22;30mn \u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;22;22;30m➜ \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;22;22;30m\u001b[29;8H \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;22;22;30mSearch forwards and select            "]
[47.502907, "o", "                                                    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                                                                            \r\n  \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;22;22;30mN \u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;22;22;30m➜ \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;22;22;30m\u001b[30;8H \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;22;22;30mSearch backwards and select                                                               \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                                                                            \r\n  \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;22;22;30mO \u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;22;22;30m➜ \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m  \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;22;22;30mvim.lsp.buf.document_symbol()                                                             \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                                                                            \r\n  \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;"]
[47.503018, "o", "22;22;30mt \u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;22;22;30m➜ \u001b(B\u001b[m\u001b[38;2;157;124;216m\u001b[48;2;22;22;30m󰓩\u001b[32;8H \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;22;22;30mGo to next tab page                                                                       \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                                                                            \r\n  \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;22;22;30mT \u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;22;22;30m➜ \u001b(B\u001b[m\u001b[38;2;157;124;216m\u001b[48;2;22;22;30m󰓩\u001b[33;8H \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;22;22;30mGo to previous tab page                                                                   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                                                                            \r\n  \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;22;22;30mu \u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;22;22;30m➜ \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m  \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;22;22;30mLowercase                                                               "]
[47.503106, "o", "                  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                                                                            \r\n  \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;22;22;30mU \u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;22;22;30m➜ \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m  \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;22;22;30mUppercase                                                                                 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                                                                            \r\n  \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;22;22;30mv \u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;22;22;30m➜ \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m  \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;22;22;30mLast visual selection                                                                     \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                                                                            \r\n  \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;22;22;30mw \u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;22"]
[47.503198, "o", ";22;30m➜ \u001b(B\u001b[m\u001b[38;2;26;188;156m\u001b[48;2;22;22;30m\u001b[37;8H \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;22;22;30mFormat                                                                                    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                                                                            \r\n  \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;22;22;30mx \u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;22;22;30m➜ \u001b(B\u001b[m\u001b[38;2;26;188;156m\u001b[48;2;22;22;30m󰈔\u001b[38;8H \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;22;22;30mOpens filepath or URI under cursor with the system handler (file explorer, web browser, …\u001b[38;98H)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                                                                            \r\n  \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;22;22;30m% \u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;22;22;30m➜ \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m  \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;22;22;30mCycle backwards through results                                                           \u001b(B\u001b[m\u001b[38;2;192;2"]
[47.503291, "o", "02;245m\u001b[48;2;22;22;30m                                                                                            \r\n  \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;22;22;30m[ \u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;22;22;30m➜ \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m  \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;22;22;30mMove to left \"around\"                                                                     \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                                                                            \r\n  \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;22;22;30m] \u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;22;22;30m➜ \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m  \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;22;22;30mMove to right \"around\"                                                                    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                                                                            \r\n  \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;22;22;30m~ \u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;22;22;30m➜ \u001b(B\u001b[m\u001b[38;2;224;175;104m"]
[47.503394, "o", "\u001b[48;2;22;22;30m\u001b[42;8H \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;22;22;30mToggle case                                                                               \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                                                                            \r\n  \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;22;22;30mb \u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;22;22;30m➜ \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;22;22;30m\u001b[43;8H \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;22;22;30m+Comment toggle blockwise             "]
[47.503527, "o", "                                                    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                                                                            \r\n  \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;22;22;30mc \u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;22;22;30m➜ \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;22;22;30m\u001b[44;8H \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;22;22;30m+Comment toggle linewise                                                                  \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                                                                            \r\u001b[44;1H \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;22;22;30m g \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                                                           \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;22;22;30m󱊷\u001b[44;81H \u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;22;22;30m close\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m  \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;22;22;30m󰁮\u001b[44;91H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;22;22;30m back\u001b(B\u001b[m\u001b[38;2;192;202;245m"]
[47.50363, "o", "\u001b[48;2;22;22;30m  \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;22;22;30m󰘴\u001b[44;99H D/󰘴\u001b[44;103H U\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;22;22;30m scroll\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                                                               \u001b[6;9H\u001b[?25h"]
[47.880251, "o", "\u001b[?25l\r\u001b[13B\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;57;75;112m▎\u001b[19;10H   \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112md\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                                                 \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[19;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    5 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mwhere c\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m dc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdatetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;2"]
[47.880443, "o", "02;245m\u001b[48;2;57;75;112m ensure that the update \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m        \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 11 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[20;10H   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"inner\"\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                           \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[20;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    upstream customer \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112mis\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m newer than the latest data \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m dim_customer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                    \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;1"]
[47.880784, "o", "71m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 12 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mwhere\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                              \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[21;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    6 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m    \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112mand\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m dc\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mis_current\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m true \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m only look at the most current state of customer \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57"]
[47.880879, "o", ";75;112min\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m     \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 13 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;31;34;49m▎\u001b[22;10H   \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;57;75;112m\"c.datetime_updated\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;57;75;112m\"dc.datetime_updated\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m&\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m  \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# WHERE c.datetime_upd\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;"]
[47.881171, "o", "26;27;38m│\u001b[22;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    dim_customer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                                       \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;57;75;112m▎\u001b[23;10H   \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112mated > dc.datetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                        \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[23;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;26;27;38mW \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 14 \u001b(B\u001b[m\u001b[38;"]
[47.881416, "o", "2;59;66;97m\u001b[48;2;31;34;49m▎\u001b[24;10H   \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;122;162;247m\u001b[48;2;57;75;112mcol\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;158;206;106m\u001b[48;2;57;75;112m\"dc.is_current\"\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m==\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m  \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# AND dc.is_current = true\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                        \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[24;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[3"]
[47.881606, "o", "8;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 15 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mselect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"c.*\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                       \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[25;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 16 \u001b(B\u001b[m\u001b[38;2;"]
[47.881819, "o", "192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[26;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 17 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# --- Union the dataframes for insertion/update ---\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                   \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[27;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m"]
[47.882023, "o", "+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 18 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Add a 'join_key' column to customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                              \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[28;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 19 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mwithColumn\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;"]
[47.882244, "o", "2;32;48;59m\"join_key\"\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;32;48;59mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                  \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[29;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[4"]
[47.882541, "o", "8;2;55;34;44m---------------------------------------------------------------------------------------\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 20 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[30;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 21 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Create a DataFrame from customers_with_updates and add a NULL join_key\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m              \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[31;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59"]
[47.883054, "o", ";66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;26;27;38mW \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 22 \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mfrom\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mpyspark\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msql\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mimport\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;42;195;222m\u001b[48;2;32;48;59mRow\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                           \u001b(B\u001b[0;1m\u001b"]
[47.883385, "o", "[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[32;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;26;27;38mW \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 23 \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mfrom\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mpyspark\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59msql\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mtypes\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;125;207;255m\u001b[48;2;32;48;59mimport\u001b(B\u001b[m\u001b[4"]
[47.883741, "o", ":3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;42;195;222m\u001b[48;2;32;48;59mStructType\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;42;195;222m\u001b[48;2;32;48;59mStructField\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;42;195;222m\u001b[48;2;32;48;59mStringType\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;65;72;104m\u001b[48;2;32;48;59mBooleanType\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;65;72;104m\u001b[48;2;32;48;59mTimest\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b"]
[47.88406, "o", "[33;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;65;72;104m\u001b[48;2;32;48;59mampType\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;65;72;104m\u001b[48;2;32;48;59mIntegerType\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                  \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[34;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\r\n\u001b(B\u001b[m\u001b[38;2;86;95;13"]
[47.884443, "o", "7m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 24 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                      \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[35;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m---------------------------------------------------------------------------------------\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 25 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;32;48;59m# Dynamically create schema for null values, handling all customer_df columns\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m         \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[36;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m-----------------------------------------------------"]
[47.884772, "o", "----------------------------------\r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 26 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_schema\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mschema\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                  \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[37;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    7 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m                                                                                      \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 27 \u001b(B\u001b[m\u001b[38;2;192"]
[47.885047, "o", ";202;245m\u001b[48;2;32;48;59mcustomers_with_updates_schema\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mStructType\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m([\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                          \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[38;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    8 \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mMERGE\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mINTO\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m prod\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdb\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdim_customer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m t \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m target dim_customer to update\u001b("]
[47.885318, "o", "B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                     \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 28 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;32;48;59m▎\u001b[39;10H   \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mStructField\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;32;48;59m\"join_key\"\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mStringType\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m()\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;32;48;59mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m)]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m+\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59mcustomer_schema\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;32;48;59m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;32;48;59mfields\u001b(B\u001b[m\u001b[38;2;192;20"]
[47.885602, "o", "2;245m\u001b[48;2;32;48;59m             \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[39;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    9 \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;32;48;59mUSING\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;32;48;59m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m                                                                                \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 29 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m                                                                                     \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[40;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   10 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    select customer_id \u001b(B\u001b[m\u001b[3m\u001b[38;2;157;124;216m\u001b[48;2;57;75;112mas\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m join_key\u001b(B\u001b["]
[47.885864, "o", "m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m*\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m from prod\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mdb\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;57;75;112mcustomer\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;57;75;112mNew\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m customers to be     \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 30 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;57;75;112m# Create empty rows of data based on this schema, one row for each element in the DF\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m  \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[41;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  "]
[47.886126, "o", "    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mINSERTED\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m existing customers to be \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mUPDATED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                         \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m--------------------------------------------------------------------------------------\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[42;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   11 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;32;48;59m    union all                                                                          \r\n\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 31 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;"]
[47.8864, "o", "112mempty_row\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;57;75;112mRow\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m*\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m([\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;57;75;112mNone\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m*\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;57;75;112mlen\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112mcustomers_with_updates_schema\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;57;75;112m)))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                       \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[43;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m   12 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    select \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;5"]
[47.886651, "o", "7;75;112mNULL\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[3m\u001b[38;2;157;124;216m\u001b[48;2;57;75;112mas\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m join_key\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m*\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m from customers_with_updates \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m--\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;57;75;112mExisting\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m customers\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;57;75;112m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m but  \r\n\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;22;22;30m g \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                                                           \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;22;22;30m󱊷\u001b[44;81H \u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;22;22;30m close\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m  \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;22;22;30m"]
[47.886933, "o", "󰁮\u001b[44;91H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;22;22;30m back\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m  \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;22;22;30m󰘴\u001b[44;99H D/󰘴\u001b[44;103H U\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;22;22;30m scroll\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;22;22;30m                                                                               \r\u001b[44;1H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m    \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;55;34;44m--------------------------------------------------------------------------------------\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;26;27;38m│\u001b[44;96H\u001b(B\u001b[m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m      \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;57;75;112m    updated values to be \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;57;75;112mINSERTED\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;31;34;49m                                                      \u001b[H\u001b(B\u001b[m\u001b[38;2;145;76;84m\u001b[48;2;26;27;38m‾\u001b[1;2H \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;"]
[47.887292, "o", "27;38m  5 \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;26;27;38mfrom\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mpyspark\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38msql\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;26;27;38mimport\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38mSparkSession\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  4 \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;26;27;38mfrom\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mpyspark\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38msql\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mfunctions\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;125;207;255m\u001b[48;2;26;27;38mimport\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;2"]
[47.887583, "o", "7;38mlit\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mcol\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  3 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m# Initialize SparkSession\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mspark\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38mSparkSession\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mbuilder\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38mappName\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b"]
[47.887853, "o", "[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m\"MergeInto\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38mgetOrCreate\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m()\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[0;1m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38m6   \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;41;46;66m                                                                                                                                                                                        \r\n\u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  1 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m# Define the source and target tables (replace with your actual table names and data loading)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  2 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m# Assuming you have D"]
[47.888024, "o", "ataFrames named 'customer_df' (source) and 'dim_customer_df' (target)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  3 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m# Example data loading (replace with your actual data loading logic):\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  4 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m# customer_df = spark.read.table(\"prod.db.customer\")\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  5 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m# dim_customer_df = spark.read.table(\"prod.db.dim_customer\")\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  6 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38"]
[47.888201, "o", "m  7 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m# ---  customers_with_updates CTE equivalent ---\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  8 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mcustomer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m\"c\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38mjoin\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;219;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m  9 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[15;8H   \u001b(B\u001b[m\u001b[4"]
[47.888391, "o", ":3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mdim_customer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38malias\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m\"dc\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 10 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[16;8H   \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m\"c.customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m\"dc.customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;"]
[47.888629, "o", "221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m# ON c.customer_id = dc.customer_id\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 11 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[17;8H   \u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m\"inner\"\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 12 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38mwhere\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 13 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[19;8H   \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;"]
[47.888828, "o", "38m\"c.datetime_updated\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m>\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m\"dc.datetime_updated\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m&\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m# WHERE c.datetime_updated > dc.datetime_updated\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;26;27;38mW \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 14 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[20;8H   \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38mcol\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;158;206;106m\u001b[48;2;26;2"]
[47.88911, "o", "7;38m\"dc.is_current\"\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m==\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m  \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m# AND dc.is_current = true\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 15 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38mselect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m\"c.*\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;"]
[47.889307, "o", "2;26;27;38m 16 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 17 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m# --- Union the dataframes for insertion/update ---\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 18 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m# Add a 'join_key' column to customer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;2"]
[47.889503, "o", "19;75;75m\u001b[48;2;26;27;38mE \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 19 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mcustomer_df\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::219:75:75m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mcustomer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38mwithColumn\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m\"join_key\"\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38mcol\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m\"customer_id\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 20 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;2"]
[47.88968, "o", "6;27;38m 21 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m# Create a DataFrame from customers_with_updates and add a NULL join_key\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;26;27;38mW \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 22 \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;125;207;255m\u001b[48;2;26;27;38mfrom\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mpyspark\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38msql\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;125;207;255m\u001b[48;2;26;27;38mimport\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38mRow\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;224;175;104m\u001b[48;2;26;27;38mW \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 23 \u001b(B\u001b[m"]
[47.889852, "o", "\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;125;207;255m\u001b[48;2;26;27;38mfrom\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mpyspark\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38msql\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mtypes\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;125;207;255m\u001b[48;2;26;27;38mimport\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38mStructType\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38mStructField\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;13"]
[47.889989, "o", "7;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38mStringType\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;65;72;104m\u001b[48;2;26;27;38mBooleanType\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;65;72;104m\u001b[48;2;26;27;38mTimestampType\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[4:3m\u001b[58:2::224:175:104m\u001b[38;2;65;72;104m\u001b[48;2;26;27;38mIntegerType\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 24 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38"]
[47.890134, "o", "m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 25 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m# Dynamically create schema for null values, handling all customer_df columns\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 26 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mcustomer_schema\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mcustomer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mschema\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 27 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mcustomers_with_updates_schema\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mStructType\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48"]
[47.890294, "o", ";2;26;27;38m([\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 28 \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m▎\u001b[34;8H   \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mStructField\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106m\u001b[48;2;26;27;38m\"join_key\"\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mStringType\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m()\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;255;158;100m\u001b[48;2;26;27;38mTrue\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m+\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mcustomer_schema\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mfields\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;68;1"]
[47.890458, "o", "57;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 29 \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 30 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m# Create empty rows of data based on this schema, one row for each element in the DF\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 31 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mempty_row\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;187;154;247m\u001b[48;2;26;27;38mRow\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m([\u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38mNone\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;"]
[47.890597, "o", "2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;42;195;222m\u001b[48;2;26;27;38mlen\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mcustomers_with_updates_schema\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)))\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 32 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mempty_rows\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mspark\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38mcreateDataFrame\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m([\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mempty_row\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m]\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m*\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;137;22"]
[47.890741, "o", "1;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38mcount\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m()\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m,\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mcustomers_with_updates_schema\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 33 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m# Drop join_key and then reorder\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 34 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mempty_rows\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mempty_rows\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38mdrop\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;158;206;106"]
[47.890898, "o", "m\u001b[48;2;26;27;38m\"join_key\"\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 35 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mempty_rows\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mempty_rows\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38mse"]
[47.891097, "o", "lect\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mcustomer_df\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;115;218;202m\u001b[48;2;26;27;38mcolumns\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 36 \u001b(B\u001b[m\u001b[3m\u001b[38;2;86;95;137m\u001b[48;2;26;27;38m# Union all the dataframes together\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 37 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m=\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mcustomers_with_updates\u001b(B\u001b[m\u001b[38;2;137;221;255m\u001b[48;2;26;27;38m.\u001b(B\u001b[m\u001b[38;2;122;162;247m\u001b[48;2;26;27;38munion\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m(\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38mempty_rows\u001b(B\u001b[m\u001b[38;2;169;177;21"]
[47.891247, "o", "4m\u001b[48;2;26;27;38m)\u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\r\n\u001b(B\u001b[m\u001b[38;2;68;157;171m\u001b[48;2;26;27;38m+ \u001b(B\u001b[m\u001b[38;2;59;66;97m\u001b[48;2;26;27;38m 38 \u001b(B\u001b[m\u001b[38;2;192;202;245m\u001b[48;2;26;27;38m\u001b[K\u001b[45;3H\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247mormal \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;59;66;97m \u001b[45;11H main \u001b[45;18H +127 -116 \u001b[45;30H E7 W9 󰰎\u001b[45;38H + \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;41;46;66m ~/code/data_engineering_systems/mergeinto/mergeinto.py[+]                                                       \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;59;66;97m \u001b[45;156H python utf-8[unix] 1.44KiB \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;122;162;247m  6:1  \u001b[6;7H\u001b[?25h"]
[49.428414, "o", "\u001b[?25l\u001b[46;180H\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38m:\u001b[6;7H\u001b[?25h"]
[49.429462, "o", "\u001b[?25l\r\u001b[40B\u001b[180X:\r\u001b[A\u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;224;175;104m Command \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;59;66;97m \u001b[45;12H main \u001b[45;19H +127 -116 \u001b[45;31H E7 W9 󰰎\u001b[45;39H + \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;41;46;66m ~/code/data_engineering_systems/mergeinto/mergeinto.py[+]                                                      \u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;59;66;97m \u001b[45;156H python utf-8[unix] 1.44KiB \u001b(B\u001b[0;1m\u001b[38;2;21;22;30m\u001b[48;2;224;175;104m  6:1  \u001b[2 q\u001b[46;2H\u001b[?25h"]
[49.754165, "o", "\u001b[?25l\u001b(B\u001b[m\u001b[38;2;169;177;214m\u001b[48;2;26;27;38mw\u001b[?25h"]
[49.81841, "o", "\u001b[?25lq\u001b[?25h"]
[50.335414, "o", "\u001b[?25l\r\u001b[46;1H\u001b[?25h"]
[50.344434, "o", "\u001b[?25l\u001b[2 q\u001b[?25h"]
[50.357708, "o", "\u001b[?25l\"mergeinto/mergeinto.py\"\u001b[C\u001b[?25h"]
[50.376338, "o", "\u001b[?25l170L, 5498B written\u001b[?25h"]
[50.404605, "o", "\u001b[?25l\r\u001b[46;1H\u001b[?2031l\u001b[2 q\u001b[?1002l\u001b[?1006l\u001b(B\u001b[m\u001b[?25h\u001b[?1l\u001b>\u001b[>4;0m\u001b[?2048l\u001b[?1049l\u001b[23;0;0t\u001b[?2004l\u001b[?1004l\u001b[?25h"]
[50.405607, "o", "\u001b[1m\u001b[7m%\u001b[27m\u001b[1m\u001b[0m                                                                                                                                                                                             \r \r"]
[50.406563, "o", "\u001b]2;josephkevinmachado@pop-os:~/code/data_engineering_systems\u0007\u001b]1;..ering_systems\u0007"]
[50.410755, "o", "\u001b]7;file://pop-os/home/josephkevinmachado/code/data_engineering_systems\u001b\\"]
[50.411716, "o", "\r\u001b[0m\u001b[27m\u001b[24m\u001b[J\u001b[01;32m➜  \u001b[36mdata_engineering_systems\u001b[00m \u001b[01;34mgit:(\u001b[31mmain\u001b[34m) \u001b[33m✗\u001b[00m \u001b[K"]
[50.411793, "o", "\u001b[?1h\u001b=\u001b[?2004h"]
[52.588389, "o", "e"]
[52.800311, "o", "\bex"]
[52.954566, "o", "i"]
[53.023025, "o", "t"]
[53.156873, "o", "\u001b[?1l\u001b>\u001b[?2004l"]
[53.157034, "o", "\r\r\n"]
[53.157824, "o", "\u001b]2;exit\u0007\u001b]1;exit\u0007"]
